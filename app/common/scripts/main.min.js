app = {
	dom: {
		$window: $(window)
	},
	animationBetweenDelay: 0.25,
	swiperDefaultSettings: {
		slidesPerView: 1,
		followFinger: false,
		init: false,
		speed: 1000
	}
};

app.swiperInitSplittyInside = function (swiper, callback) {
	var $el = $(swiper.$el);
	var $slides = $el.find('[data-home-banner-slide]');
	$slides.each(function() {
		$(this).removeClass('_parsed').addClass('_parsing');
	});

	// Разбиваем строки на элементы в слайдах свайпера, создавая им дополнительную вложенность
	// (необходимо для анимации выезжания 'из под шторки')
	$el.find('[data-splitty-swiper-title]').splitty({
		additionalNesting: true
	});

	// Разбиваем строки на элементы внутри слайдов свайпера
	$el.find('[data-splitty-swiper]').splitty({
		onInit: function () {
			app.parseAnimateDelayed();

			setTimeout(function() {
				$slides.each(function() {
					$(this).removeClass('_parsing').addClass('_parsed');
				});
			}, 300);
		}
	});

	typeof callback === 'function' && callback();
};

app.checkScrollTopForFirstScreen = function () {
	// Проверяем, находится ли первый экран главной страницы в зоне видимости экрана
	// пользователя при загрузке страницы
	var currentWindowScroll = app.dom.$window.scrollTop();
	var firstScreenHeight = $('[data-waypoint="mp_first"]').height();

	return currentWindowScroll <= firstScreenHeight;
};

app.addSplittyDelay = function ($item, delay, callback) {
	// Устанавливаем задержку в data-атрибут переданного элемента
	$item.attr('data-animate-delayed', delay);

	typeof callback === 'function' && callback({
		delay: delay,
		element: $item
	});
};

app.firstSplittyInit = function () {
	// Устанавливаем задержку на появление элементов,
	// если первый экран главной страницы находится в зоне видимости пользователя
	if ( app.checkScrollTopForFirstScreen() ) {
		var elements = [
			{
				$element: $('[data-animate-delayed-target="firstTitle"]'),
				delay: 0
			},
			{
				$element: $('[data-animate-delayed-target="firstText"]'),
				delay: 0.6
			},
			{
				$element: $('[data-animate-delayed-target="header"]'),
				delay: 0
			},
			{
				$element: $('[data-animate-delayed-target="firstCounter"]'),
				delay: 1
			},
			{
				$element: $('[data-animate-delayed-target="firstIconSearch"]'),
				delay: 1.25
			},
			{
				$element: $('[data-animate-delayed-target="firstIconArrow"]'),
				delay: 1.25
			},
			{
				$element: $('[data-animate-delayed-target="firstIconArrowWrapper"]'),
				delay: 0.65
			}
		];

		// Устанвливаем всем элементам в массиве задержку (animate-delay),
		// которая указана в атрибуте 'data-animate-delayed'
		for (var i=0; i < elements.length; i++) {
			app.addSplittyDelay(elements[i].$element, elements[i].delay, function() {
				elements[i].$element.removeAttr('data-wow-delay');
				app.parseAnimateDelayed(elements[i].$element);
			});
		}

		// Обнуляем animation-delay у элементов
		function resetElementsDelays () {
			for (var i=0; i < elements.length; i++) {
				app.parseAnimateDelayed(elements[i].$element);
			}
		}

		// После отработки всех анимаций, удаляем у элементов задержки
		setTimeout(function() {
			for (var i=0; i < elements.length; i++) {
				var $current = elements[i].$element;
				var delayedTarget = $current.attr('data-animate-delayed-target');

				if (delayedTarget === 'firstTitle') {
					$current.find('p, span').css({
						'animation-delay': ''
					});
				}

				$current.attr('data-animate-delayed', '').css({
					'animation-delay': ''
				});
				$current.find('.animated').css({
					'animation-delay': ''
				});
			}

			resetElementsDelays();
		}, 6000);
	}

	app.parseAnimateDelayed();
};

app.parseAnimateDelayed = function ($elem, reverse) {
	// Добавляем ступенчатую задержку элементам
	// (увеличиваем задеркжу появления следующего элемента в цикле
	// на значение в app.animationBetweenDelay, либо 0
	var $this = $elem || $('[data-animate-delayed]');

	if ($this) {
		$this.each(function(i, element){
			var dataAnimateDelayed = parseFloat($(element).attr('data-animate-delayed'));

			var $animateChildren = $(element).find('p, span');

			var $parseTarget = $animateChildren.length > 0 ? $animateChildren : $(element);

			var defaultAnimationDelay = reverse ? ($parseTarget.length - 1) * app.animationBetweenDelay : 0;
			var animationDelay = typeof dataAnimateDelayed === 'number' && (dataAnimateDelayed + defaultAnimationDelay) || defaultAnimationDelay;

			$parseTarget.each(function() {
				// Add transition-delay
				$(this).css({
					'animation-delay': animationDelay + 's'
				});

				// Reduce current transition step
				animationDelay += (reverse ? -1 : 1) * app.animationBetweenDelay;
			});
		});
	}
};

app.animateCSS = function (element, animationName, callback, offTimeout, removeAnimationClass) {
	// Функция воспроизведения анимации 'animationName' для элемента 'element'
	var $node = $(element);

	// Хак для IE, для корректной отработки анимаций
	if (app.isIE()) {
		$node.addClass('hidden').removeClass('animated').removeClass(animationName);
		setTimeout(function() {
			$node.removeClass('hidden').addClass('animated').addClass(animationName);
		}, 0);
	} else {
		$node.addClass('animated').addClass(animationName);
	}

	// Удаляем присвоенные элементу свойства после окончания анимации
	function handleAnimationEnd() {
		setTimeout(function () {
			if (removeAnimationClass) {
				$node.removeClass('animated').removeClass(animationName);
			}
			$node.off('animationend', handleAnimationEnd);
		}, offTimeout || 0);

		if (typeof callback === 'function') callback();
	}

	$node.on('animationend', handleAnimationEnd);
};

app.isIE = function () {
	// Проверка браузера пользователя на IE
	var userAgent = window.navigator.userAgent.toLowerCase();

	if ((/trident/gi).test(userAgent) || (/msie/gi).test(userAgent)) {
		return true;
	}

	return false;
};

app.stickyScroller = function () {
	// обертка, внутри которой будет работать блок sticky
	var $stickyScrollerParent = $('[data-sticky-scroller]');
	if ($stickyScrollerParent.length) {
		// блок, который ведет себя как sticky
		var $stickyScrollerBlock = $stickyScrollerParent.find('[data-sticky-scroller-block]');
		// внутрення галарея, которая прокручивается при скроле
		var $stickyScrollerGallery = $stickyScrollerBlock.find('[data-sticky-scroller-gallery]');
		var stickyScrollerGalleryWidth = $stickyScrollerGallery[0].scrollWidth; // ширина галереи
		var headerHeight = $('[data-header]').height(); // высота шапки сайта

		// выставляем высоту для нашего блока со стики исходя из ширины галереи
		function updateScrollerHeight () {
			$stickyScrollerParent.height(stickyScrollerGalleryWidth + $stickyScrollerBlock.outerHeight()).css({
				position: 'relative'
			});
		}

		app.dom.$window.on('resize', function() {
			updateScrollerHeight();
		});
		updateScrollerHeight();

		// вводим состояние sticky блока
		var state = 'top'; // [top, bottom, fixed]

		// функция для вычисления положения sticky блока, смешения галереи и установки нужных css
		// вызовается при скроле и ресайзе
		function update () {
			// верхний отступ, чтобы блок был по середине экрана с учетом шапки
			var offsetTop = (app.dom.$window.height() - headerHeight - $stickyScrollerBlock.height()) / 2 + headerHeight;
			// положение обуртки сники во viewport
			var parentRect = $stickyScrollerParent[0].getBoundingClientRect();

			// если обертка ниже верхнего отступа, то фиксируем sticky вверху блока
			if (parentRect.top > offsetTop) {
				// не выполняем ничего, если состояние sticky не изменялось
				if(state !== 'top') {
					state = 'top';
					$stickyScrollerBlock.css({
						position: 'absolute',
						top: 0,
						width: '100%',
						bottom: 'auto'
					});
				}
			// если расстояние до нижней границы больше больше, чем высота sticky блока + смещение, то закрепляем по середине экрана
			} else if (parentRect.bottom > $stickyScrollerBlock.outerHeight() + offsetTop) {
				if(state !== 'fixed') {
					state = 'fixed';
					$stickyScrollerBlock.css({
						position: 'fixed',
						width: $stickyScrollerParent.width() + 'px',
						top: offsetTop + 'px',
						bottom: 'auto'
					});
				}
			// в остальных случаях закрепляем sticky в нижней границы обертки
			} else {
				if(state !== 'bottom') {
					state = 'bottom';
					$stickyScrollerBlock.css({
						position: 'absolute',
						top: 'auto',
						bottom: 0,
						width: '100%'
					});
				}
			}

			// вычисляем смещение галереи во время скрола
			var RATIO = (-parentRect.top + offsetTop) / ($stickyScrollerParent.height() - $stickyScrollerBlock.outerHeight());

			RATIO = Math.max(0, Math.min(RATIO, 1));

			var scrollLeft = -RATIO * (stickyScrollerGalleryWidth - $stickyScrollerGallery.width());
			$stickyScrollerGallery.css({
				transform: 'translateX('+scrollLeft+'px)'
			});
		}

		app.dom.$window.on('scroll resize', update);
		update();
	}
};

app.splitty = function () {
	// Разбиваем все строки с атрибутом 'data-splitty' на несколько элементов
	// в случае, если элемент не умещается в ширину родителя и текст переносится на новую строку
	$('[data-splitty]').splitty({
		parseTimeout: 0,
		resizeDelay: 300,
		onReinit: function() {
			app.parseAnimateDelayed();
		},
		onInit: function() {
			app.firstSplittyInit();
			setTimeout(function() {
				app.wow();
			}, 1500);
		},
		reinitOnResize: true
	});
	$('[data-splitty-title]').splitty({
		parseTimeout: 0,
		resizeDelay: 300,
		additionalNesting: true,
		onReinit: function() {
			app.parseAnimateDelayed();
		},
		onInit: function() {
			app.parseAnimateDelayed();
		},
		reinitOnResize: true
	});
};

app.smoothScroll = function () {
	// Плавный скролл к блоку с якорем
	var $smoothScroll = $('[data-smooth-scroll]');
	var scrollSpeed = 700;

	$smoothScroll.each(function (i, e) {
		var $this = $(this);
		var getId = $(e).data('smooth-scroll-to');
		var $target = $('[data-smooth-scroll-target=' + getId + ']');

		$this.on('click', function () {
			$('html, body').animate({
				scrollTop: $target.offset().top
			}, scrollSpeed);
		});
	});
};

app.highcharts = function () {
	// Инициализация графика Highcharts на страницах
	var $highcharts = $('[data-highcharts]');

	function renderChart (data, chart) {
		var currentId = $(chart).data('highcharts-id');

		return Highcharts.chart($('[data-highcharts-id="'+currentId+'"]')[0], {
			chart: {
				zoomType: 'x',
				backgroundColor: null,
				events: {
					load: function() {
						var $highchartsTab = $('[data-highcharts-tab="'+currentId+'"]');
						var highchartsChartIndex = $(this.renderTo).data('highcharts-chart');
						var _this = this;
						var addSeriesToChart = function() {
							_this.series[0].remove();
							_this.addSeries({
								data: data,
								type: 'area',
								name: 'руб.'
							});
						};

						if(highchartsChartIndex === 0) {
							addSeriesToChart();
						}

						$highchartsTab.on('click', function() {
							addSeriesToChart();
						});

						var waypointIsDone = false;
						$(this.renderTo).waypoint({
							offset: '100%',
							handler: function(dir) {
							    if (dir === 'down') {
							    	if (!waypointIsDone) {
										setTimeout(function() {
											addSeriesToChart();
											waypointIsDone = true;
										}, 300);
									}
								}
							}
						});

						$(this.renderTo).waypoint({
							offset: '-30%',
							handler: function() {
								if (!waypointIsDone) {
									setTimeout(function() {
										addSeriesToChart();
										waypointIsDone = true;
									}, 300);
								}
							}
						});
					}
				}
			},
			tooltip: {
				backgroundColor: '#333333',
				borderRadius: 4,
				borderWidth: 1,
				borderColor: 'transparent',
				padding: 0,
				shadow: false,
				useHTML: true,
				formatter: function (e) {
					var getPrice = this.y;
					var getName = this.series.userOptions.name;
					var getDate = Highcharts.dateFormat('%d.%m.%Y • %H:%M', this.x);

					return '<div class="highcharts-tooltip__parent">' +
                    '<div class="highcharts-tooltip__row">' +
                    '<div class="highcharts-tooltip__title">' +
                    '<span>Стоимость</span>' +
                    '</div>' +
                    '<div class="highcharts-tooltip__text">' +
                    '<span>'+getPrice+' '+'<b>'+getName+'</b>'+'</span>' +
                    '</div>' +
                    '</div>' +
                    '<div class="highcharts-tooltip__separator"></div>'	+
                    '<div class="highcharts-tooltip__row">' +
                    '<div class="highcharts-tooltip__title">' +
                    '<span>Данные на</span>' +
                    '</div>' +
                    '<div class="highcharts-tooltip__text">' +
                    '<span><b>'+getDate+'</b></span>' +
                    '</div>' +
                    '</div>' +
                    '</div>';
				},
				style: {
					color: '#ffffff'
				}
			},
			credits: {
				enabled: false
			},
			exporting: {
				enabled: false
			},
			title: {
				text: ''
			},
			subtitle: {
				text: ''
			},
			xAxis: {
				type: 'datetime',
				labels: {
					style: {
						fontSize: '15px',
						lineHeight: '28px',
						color: '#999999',
						fontWeight: 500,
						fontFamily: 'Gilroy'
					}
				},
				offset: 24,
				lineWidth: 0,
				tickWidth: 0
			},
			yAxis: {
				title: {
					text: ''
				},
				opposite: true,
				labels: {
					style: {
						fontSize: '15px',
						lineHeight: '28px',
						color: '#999999',
						fontWeight: 500,
						fontFamily: 'Gilroy'
					}
				},
				offset: 30,
				lineWidth: 0,
				tickWidth: 0
			},
			legend: {
				enabled: false
			},
			plotOptions: {
				animation: {
					duration: 1000
				},
				area: {
					fillOpacity: 0.1,
					fillColor: {
						linearGradient: {
							x1: 0,
							y1: 0,
							x2: 0,
							y2: 1
						},
						stops: [
							[0, 'rgba(0, 142, 206, 0.1)'],
							[1, 'rgba(0, 142, 206, 0)']
						]
					},
					marker: {
						radius: 2
					},
					lineWidth: 1,
					states: {
						hover: {
							lineWidth: 1
						}
					},
					threshold: null
				},
				series: {
					states: {
						hover: {
							halo: {
								opacity: 0,
								size: 0
							}
						}
					},
					marker: {
						enabled: false,
						states: {
							hover: {
								radius: 6,
								fillColor: '#3F91CD',
								lineWidthPlus: 4,
								lineColor: '#ffffff'
							}
						}
					}
				}
			},
			series: [{
				type: 'area',
				name: 'руб.',
				data: data
			}]
		});
	}

	$highcharts.each(function(i, e){
		if (typeof Highcharts !== 'undefined') {
			Highcharts.setOptions({
				lang: {
					months: ['Январь', 'Февраль', 'Март', 'Апрель',
						'Май', 'Июнь', 'Июль', 'Август',
						'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'],
					weekdays: ['Воскресенье', 'Понедельник', 'Вторник',
						'Среда', 'Четверг', 'Пятница', 'Суббота'],
					shortMonths: ['Январь', 'Февраль', 'Март', 'Апрель',
						'Май', 'Июнь', 'Июль', 'Август',
						'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь']
				}
			});
			Highcharts.getJSON(
				'https://cdn.jsdelivr.net/gh/highcharts/highcharts@v7.0.0/samples/data/usdeur.json',
				function (data) {
					renderChart(data, e);
				}
			);
		}
	});
};

app.wow = function () {
	// Плагин, который отыгрывает анимацию,
	// при появлении элемента на экране пользователя
	new WOW({
		resetAnimation: true,
		offset: app.dom.$window.height()*20/100,
		callback: function(box) {
			if ($(box).attr('data-wow-animation') && !$(box).attr('data-product-title')) {
				var animationName = $(box).attr('data-wow-animation');
				app.animateCSS($(box), animationName, function() {
					$(box).removeAttr('data-wow-animation').removeClass('wow').css({
						visibility: ''
					});
				}, 300);
			}
		}
	}).init();
};

app.revealBlockOnReset = function () {
	var $box = $('[data-product-wrapper]');
	$box.waypoint({
		handler: function () {
			$('[data-product-slide], [data-product-title], [data-product-button]').each(function () {
				var $this = $(this);
				var name = $this.attr('data-wow-animation');
				var delay = $this.attr('data-wow-delay');

				if (app.isIE()) {
					$this.css({
						'animation-delay': delay
					});
				}

				app.animateCSS($this, name, function() {
					console.log('Element:', $this);
					$this.removeAttr('data-wow-animation').removeClass('hidden').css({
						visibility: ''
					});
				}, 300);
			});
		},
		offset: '50%'
	});
};

app.openPopup = function () {
	var $popup = $('[data-open-popup]');
	$popup.magnificPopup({
		type: 'inline',
		midClick: true,
		// Delay in milliseconds before popup is removed
		removalDelay: 300,
		// Class that is added to popup wrapper and background
		// make it unique to apply your CSS animations just to this exact popup
		mainClass: 'mfp-fade'
	});
	// dev mode
	// $popup.click();
};

app.menu = function () {
	var $menu = $('[data-menu]');
	var $menuButton = $('[data-menu-button]');
	var $menuClose = $('[data-menu-close]');
	var $menuSubnav = $('[data-menu-subnav]');
	var $menuNav = $('[data-menu-nav]');

	var activeClass = '_active';
	var menuOpen = false;

	function renderMenu () {
		var elements = [
			{
				$element: $('[data-animate-delayed-target="menuHeader"]'),
				delay: 0.55
			},
			{
				$element: $('[data-animate-delayed-target="menuSeparator"]'),
				delay: 0.55
			},
		];

		setDelayOnNav('menuNavLink', 2);
		setDelayOnNav('menuBottomNavLink', 3);

		for (var i=0; i < elements.length; i++) {
			app.addSplittyDelay(elements[i].$element, elements[i].delay, function() {
				app.parseAnimateDelayed(elements[i].$element);
			});
		}
	}

	function closeMenu () {
		$('[data-menu-animate]').css({'animation-delay': ''});
	}

	function clearStylesAndStates () {
		$menuNav.removeClass(activeClass);
		$menuSubnav.stop().hide();
	}

	function restartAnimation (direction) {
		if (direction === undefined || !direction) {
			direction = 'in';
		}

		var $menuAnimate = $('[data-menu-animate]');

		$menuAnimate.each(function() {
			var $this = $(this);
			var $menuAnimateIn = $this.data('menu-animate-in') || 'fadeIn';
			var $menuAnimateOut = $this.data('menu-animate-out') || 'fadeOut';

			if (!$this.hasClass('animated')){
				$this.addClass('animated');
			}

			if (direction === 'in') {
				$this.removeClass($menuAnimateOut);
				$this.removeClass($menuAnimateIn);
				setTimeout(function() {
					$this.addClass($menuAnimateIn);
				}, 0);
			} else if (direction === 'out') {
				$this.removeClass($menuAnimateIn);
				$this.removeClass($menuAnimateOut);
				setTimeout(function() {
					$this.addClass($menuAnimateOut);
				}, 0);
			}
		});
	}

	function setDelayOnNav (delayedTargetName, delay) {
		var defaultMenuNavLinkDelay = 0.4 || delay;

		$('[data-animate-delayed-target="'+delayedTargetName+'"]').each(function(index) {
			var $this = $(this);
			var $children = $this.children('p, span');

			$children.each(function() {
				$(this).css({
					'animation-delay': (defaultMenuNavLinkDelay + (index * 0.08)) + 's'
				});
			});
		});

	}
	function menuSubnavItemsDelay (delay){
		var defaulMenuSubnavItemsDelay = delay ?  0.7 : 0;
		$menuSubnav.each(function () {
			var $this = $(this);
			var $children = $this.find('p, span');

			$children.each(function(index) {
				$(this).css({
					'animation-delay': (defaulMenuSubnavItemsDelay + (index * 0.05)) + 's'
				});
			});
		});
	}

	$menuButton.on('click', function() {
		menuSubnavItemsDelay(true);
		$('[data-menu-subnav]').hide(0);
		restartAnimation('in');

		app.animateCSS($menu, 'slideInRightMenu', null, null, 'slideOutRightMenu');
		setTimeout(function() {
			$menu.addClass(activeClass);
		}, 700);

		renderMenu();
		$menuNav.first().trigger('mouseenterEmulate');

	});

	$menuClose.on('click', function() {
		menuOpen = false;
		$menu.addClass('_close');
		closeMenu();
		app.animateCSS($menu, 'slideOutRightMenu', function() {
			$menu.removeClass(activeClass);
		}, null, 'slideInRightMenu');
		clearStylesAndStates();
		setTimeout(function() {
			$menuSubnav.stop().show(0);
			$menu.removeClass('_close');
		}, 600);
	});

	$menuNav.on('mouseenter mouseenterEmulate', function() {
		var $this = $(this);
		if($this.hasClass('_active')){
			return false;
		}
		if (menuOpen){
    		menuSubnavItemsDelay();
		}
		menuOpen = true;
		var $menuNavActive = $menuNav.filter('._active');
		var $subnavActive = $('[data-menu-subnav="'+$menuNavActive.data('menu-nav')+'"]');
		var getId = $this.data('menu-nav');
		var $getSubnav = $('[data-menu-subnav="'+getId+'"]');
		if($subnavActive.length){
			$subnavActive.addClass('_close');
			setTimeout(function () {
				$subnavActive.removeClass('_close');

				clearStylesAndStates();
				$this.addClass(activeClass);
				$getSubnav.stop().addClass('_active').show();
			},600);
		}else if($getSubnav.length){
			clearStylesAndStates();
			$getSubnav.stop().addClass('_active').show();
			$this.addClass(activeClass);
		}else{
			clearStylesAndStates();
			$this.addClass(activeClass);
		}
	});
};

app.fade = function () {
	// Появляющиеся при клике на кнопку скрытые блоки
	var init = function (){
		var $fadeElements = $('[data-fade-block], [data-fade-layout]');

		$fadeElements.each(function(i, e) {
			if ($(e).data('menu')) {
				return;
			}

			var dataAttrs = ['fade-in-effect', 'fade-speed'];

			$(dataAttrs).each(function(dataIndex, dataElem) {
				if($(e).data(dataElem)){
					$(e).addClass( $(e).data(dataElem)+' ' );
				}
			});
		});
	};
	init();

	// Запуск анимации на элементах с атрибутом 'data-fade-animate'
	// со стандартными свойствами
	var addClassToAnimatedBlocks = function (inst) {
		var $fadeAnimate = $(inst).find('[data-fade-animate]');
		if (!$fadeAnimate.hasClass('animated')) {
			$fadeAnimate.addClass('animated');
		}
	};

	// Обработка всех кнопок, при клике на которые появляются связанные с ними блоки
	var $fadeButton = $('[data-fade-button]');
	$fadeButton.each(function () {
		var $this = $(this);

		$this.on('click', function (e) {
			e.preventDefault();

			var $fadeName = $this.data('fade-button');
			var $fadeBlock = $('[data-fade-block="' + $fadeName + '"]'),
				$fadeBlockInEffect = $fadeBlock.data('fade-in-effect') || 'slideInRight',
				$fadeBlockOutEffect = $fadeBlock.data('fade-out-effect') || 'slideOutRight';
			var $fadeClose = $('[data-fade-close="' + $fadeName + '"]');
			var $fadeLayout = $('[data-fade-layout="' + $fadeName + '"]'),
				$fadeLayoutInEffect = $fadeLayout.data('fade-in-effect') || 'fadeIn',
				$fadeLayoutOutEffect = $fadeLayout.data('fade-out-effect') || 'fadeOut';

			var toggleBodyOverflow = function (par) {
				var $body = $('body');

				if (par) {
					$body.css('overflow', par);
				} else {
					if ($body.css('overflow') === 'hidden') {
						$body.css({
							overflow: 'visible'
						});
					} else {
						$body.css({
							overflow: 'hidden'
						});
					}
				}
			};

			$fadeBlock.stop().show(0, function() {
				var animationDuration = 1000;

				//- start IE11 animation hack
				$fadeBlock.hide(0).removeClass($fadeBlockInEffect);
				//- end
				setTimeout(function() {
					//- start IE11 animation hack
					$fadeBlock.show(0).addClass($fadeBlockInEffect);
					//- end
				}, 0);

				setTimeout(function() {
					addClassToAnimatedBlocks($fadeBlock);

					toggleBodyOverflow();
				}, animationDuration);
			});

			$fadeLayout.stop().show();

			$fadeLayout.on('click', function () {
				$fadeClose.trigger('click');
			});

			$fadeClose.on('click', function (e) {
				e.preventDefault();

				$fadeLayout.removeClass($fadeLayoutInEffect).addClass($fadeLayoutOutEffect);
				$fadeBlock.removeClass($fadeBlockInEffect).addClass($fadeBlockOutEffect);

				setTimeout(function () {
					toggleBodyOverflow('visible');
					$fadeBlock.stop().hide().removeClass($fadeBlockOutEffect).addClass($fadeBlockInEffect);
					$fadeLayout.stop().hide().removeClass($fadeLayoutOutEffect).addClass($fadeLayoutInEffect);
				}, 1000);
			});
		});
	});
};

app.collapse = function () {
	var $collapse = $('[data-collapse]');

	$collapse.each(function (i, e) {
		var $this = $(e);
		var $top = $this.find('[data-collapse-top]');
		var $content = $this.find('[data-collapse-content]');
		var $icon = $this.find('[data-collapse-icon]');
		var activeClass = '_active';
		var transitionSpeed = 300;

		$top.on('click', function () {
			if ($this.hasClass(activeClass)) {
				$icon.removeClass(activeClass);
				$content.stop().slideUp(transitionSpeed, function () {
					$this.removeClass(activeClass);
				});
			} else {
				$icon.addClass(activeClass);
				$content.stop().slideDown(transitionSpeed, function () {
					$this.addClass(activeClass);
				});
			}
		});
	});
};

app.tabs = function () {
	var $tabs = $('[data-tabs]');

	$tabs.each(function (i, e) {
		var $this = $(e);
		var $tabElements = $this.find('[data-tab-id]');
		var activeClass = '_active';

		$tabElements.each(function (tabIndex, tabElement) {
			var $getTabParent = $(tabElement).parents('[data-tabs]').eq(0);

			if ($this.is($getTabParent)) {
				var $current = $(tabElement);
				var $currentParent = $current.closest('[data-tabs]');
				var $currentTabs = $currentParent.find('[data-tab-id]');
				var $currentBlocks = $currentParent.find('[data-tab-block]');

				var activeClassRemover = function (i2, e2) {
					if ($(e2).closest('[data-tabs]').is($currentParent)) {
						$(e2).removeClass(activeClass);
					}
				};

				$current.on('click', function () {
				    var currentId = $(this).data('tab-id');

					$currentTabs.each(activeClassRemover);
					$currentBlocks.each(activeClassRemover);

					$currentParent.find('[data-tab-block="'+currentId+'"]').eq(0).addClass(activeClass);
					$current.addClass(activeClass);
				});
			}
		});
	});
};


app.cookieLayout = function () {
	var $cookie = $('[data-cookie]');
	var $close = $cookie.find('[data-cookie-close]');

	$close.on('click', function () {
		$cookie.remove();
	});
};

app.chosen = function () {
	$('[data-chosen-select]').chosen({disable_search: true, width: '100%'});
	$('[data-chosen-select-content-fit]').chosen({disable_search: true, width: 'calc(100% + 15px)'});
};

app.lang = function () {
	var $chosen = $('[data-chosen-select-lang]');
	var $lang = $('[data-lang]');
	var $single = $('a.chosen-single');

	$chosen.on('change', function(evt) {
		$lang.removeClass('header__language--default');
		$lang.removeClass('header__language--default-dark');
	});

	document.addEventListener('touchstart', function (evt) {
		if (evt.target.classList.contains('chosen-single')) {
			$lang.removeClass('header__language--default');
			$lang.removeClass('header__language--default-dark');
		}
	});

	$chosen.val('');

	$chosen.chosen({disable_search: true, width: '100%', placeholder_text_single: 'LAN'});
};

app.geoMap = function () {
	var $pins = $('[data-geo-map-pin]');
	var $countries = $('.country__with-enterprise');

	var visibleClass = '_visible';
	var activeClass = '_active';

	if ($countries.length > 0) {
		function getCountryNode (countryName) {
			if (countryName) {
				var targetCountryNode = null;

				countryName = countryName.toLowerCase();
				countryName = countryName[0].toUpperCase() + countryName.slice(1);

				var $countryPath = $('[data-map-country="'+countryName+'"]');

				if ($countryPath.length > 0) {
					targetCountryNode = $countryPath;
				}

				return targetCountryNode;
			}
		}

		function hideAllCards () {
			$('[data-geo-card]').removeClass(visibleClass);
		}

		function clearAllPaths () {
			$('[data-map-country]').removeClass(activeClass);
		}

		$pins.each(function() {
			var $pin = $(this);

			$pin.on('mouseover', function() {
				var $this = $(this);
				$this.addClass('_visible');

				var country = $pin.attr('data-country');
				var $countryPath = getCountryNode(country);
				$countryPath.addClass('_active');

				hideAllCards();

				var $card = $this.find('[data-geo-card]');
				if ($card.length > 0) {
					$card.addClass(visibleClass);
				}
			});

			$pin.on('mouseleave', function(){
				hideAllCards();
				clearAllPaths();
			});
		});
	}
};

app.history = function () {
	var timeline = document.querySelector('[data-timeline-container]');
	if (timeline) {
		var timelineItems = timeline.querySelectorAll('[data-timeline]');
		var historyStages = document.querySelectorAll('[data-history]');
		var historyActual = document.querySelector('[data-history-actual]');
		// var historyTotal = document.querySelector('[data-history-total]');
		var imageTriggerList = document.querySelectorAll('[data-history-image]');
		var imageContainer = document.querySelector('[data-history-images]');
		var footer = document.querySelector('.footer');

		// missing forEach on NodeList for IE11
		if (window.NodeList && !NodeList.prototype.forEach) {
			NodeList.prototype.forEach = Array.prototype.forEach;
		}

		// Задаем первоначальное состояние: первый пункт навигации выделен, первая фотография видна
		function initialState () {
			setActiveTimelineItem(historyStages[0].dataset.history);
			imageContainer.querySelectorAll('[data-history-image-item]')[0].style.opacity = '1';
		}

		// Очищаем классы всех элементов списка навигации
		function clearAllTimelineItems () {
			timelineItems.forEach(function (item) {
				item.classList.remove('timeline__item--active');
			});
		}

		// Задаем пункту навигации активное состояние
		function setActiveTimelineItem (anchor) {
			clearAllTimelineItems();
			var targetItem = timeline.querySelector('[data-timeline=' + anchor + ']');
			targetItem.classList.add('timeline__item--active');
		}

		// Задаем фотографии активное (видимое) состояние
		function setActiveImage (id) {
			imageContainer.querySelectorAll('[data-history-image-item]').forEach(function (img) {
				img.style.opacity = '0';
			});
			document.getElementById(id).style.opacity = '1';
		}

		// Перемещение position: fixed блоков справа и слева (timeline и изображения) при появлении футера
		function updateFixedPosition () {
			timeline.style.top = 96 - (document.documentElement.clientHeight - footer.getBoundingClientRect().top) + 'px';
			imageContainer.style.top = 96 - (document.documentElement.clientHeight - footer.getBoundingClientRect().top) + 'px';
		}

		// Отключение или включение всех waypoints разом для организации скролла
		function setWaypointsState (state) {
			switch (state) {
			case 'disable':
				historyWaypointsDown.forEach(function (waypoint) {
					waypoint.disable();
				});
				historyWaypointsUp.forEach(function (waypoint) {
					waypoint.disable();
				});
				imageWaypoints.forEach(function (waypoint) {
					waypoint.disable();
				});
				break;
			case 'enable':
			default:
				historyWaypointsDown.forEach(function (waypoint) {
					waypoint.enable();
				});
				historyWaypointsUp.forEach(function (waypoint) {
					waypoint.enable();
				});
				imageWaypoints.forEach(function (waypoint) {
					waypoint.enable();
				});
			}
		}

		initialState();

		// Заранее создаю массивы под waypoints, чтобы потом своевременно их отключать и включать
		var historyWaypointsDown = new Array(historyStages.length);
		var historyWaypointsUp = new Array(historyStages.length);
		var imageWaypoints = new Array(historyStages.length);

		historyStages.forEach(function (stage, index) {
			historyWaypointsDown[index] = new Waypoint({
				element: stage,
				handler: function (direction) {
					if (direction === 'down') {
						var updatedCounterValue = index + 1;
						historyActual.textContent = index + 1 > 10 ? updatedCounterValue : '0' + updatedCounterValue;
						setActiveTimelineItem(stage.dataset.history);
					}
				},
				offset: 0
			});
			historyWaypointsUp[index] = new Waypoint({
				element: stage,
				handler: function (direction) {
					if (direction === 'up') {
						var updatedCounterValue = index + 1;
						historyActual.textContent = index + 1 > 10 ? updatedCounterValue : '0' + updatedCounterValue;
						setActiveTimelineItem(stage.dataset.history);
					}
				},
				offset: 'bottom-in-view'
			});
		});

		// Создаем отдельные waypoints для управления изображениями, привязанными к data-history-image
		imageTriggerList.forEach(function (trigger, index) {
			imageWaypoints[index] = new Waypoint({
				element: trigger,
				handler: function () {
					setActiveImage(trigger.dataset.historyImage);
				},
				offset: 100
			});
		});

		// Обновляем положение изображения, когда докрутили до футера
		var footerWaypoint = new Waypoint({
			element: footer,
			handler: function (direction) {
				if (direction === 'down') {
					document.addEventListener('scroll', updateFixedPosition);
				}
				if (direction === 'up') {
					timeline.style.top = 96 + 'px';
					imageContainer.style.top = 96 + 'px';
					document.removeEventListener('scroll', updateFixedPosition);
				}
			},
			offset: '100%'
		});

		// Скролл текста к нужному пункту при клике на соответствующем элементе timeline
		// Для коллбэка по выполнении анимации переходим на jQuery
		$('[data-timeline]').each(function (index) {
			$(this).on('click', function(e) {
				e.preventDefault();
				setActiveTimelineItem(e.target.dataset.timeline);
				// Выбираем активной первую фотографию в блоке, который появится по клику на навигацию
				setActiveImage(historyStages[index].querySelector('[data-history-image]').dataset.historyImage);
				// Выставляем счетчик над timeline на новое значение
				var updatedCounterValue = index + 1;
				historyActual.textContent = index + 1 > 10 ? updatedCounterValue : '0' + updatedCounterValue;
				// Отключаем waypoints на период скролла
				setWaypointsState('disable');
				$([document.documentElement, document.body]).stop().animate({
					scrollTop: $('[data-history]').eq(index).offset().top - 50
				}, 500, function () {
					// После завершения скролла снова включаем waypoints
					setWaypointsState('enable');
				});
			});
		});
	}
};

app.stickyHeader = function () {
	var $stickyHeader = $('[data-sticky-header]');
	var activeClass = '_active';

	$('[data-waypoint="mp_second"]').waypoint({
		handler: function(dir) {
			if (dir === 'down') {
				$stickyHeader.addClass(activeClass);
			} else {
				$stickyHeader.removeClass(activeClass);
			}
		}
	});
};

app.swiperMainHeaderImages = function () {
	var $homeSwiper = $('[data-home-swiper]');
	var $homeSwiperImages = $homeSwiper.find('[data-home-swiper-src]');
	var $window = app.dom.$window;
	var calcImgWidth = 0;
	var calcImgHeight = 0;
	var transitionOffsetWidth = 0;
	var transitionOffsetHeight = 0;
	var counterSwiper;
	var imgSrc = $homeSwiperImages.data('home-swiper-src');
	var img = new Image();
	img.onload = function () {
		onLoadImg();
	};
	img.src = imgSrc;

	$window.on('resize', function () {
		onLoadImg();
	});

	function onLoadImg () {
		var kImg = img.width/img.height;
		var kWidth = $window.width() / img.width;
		var kHeight = $window.height() / img.height;
		if(kWidth > kHeight) {
			calcImgWidth = $window.width();
			calcImgHeight = calcImgWidth / kImg;
			transitionOffsetHeight = -(calcImgHeight - $window.height()) / 2;
			transitionOffsetWidth = 0;
		}else{
			calcImgHeight = $window.height();
			calcImgWidth = calcImgHeight * kImg;
			transitionOffsetWidth = -(calcImgWidth - $window.width()) / 2;
			transitionOffsetHeight = 0;
		}

		initSwiper();
	}

	function initPagination ($swipers) {
	    if (counterSwiper && counterSwiper !== 'undefined') {
	      counterSwiper.destroy();
		}

		var $counter = $('[data-counter="home"]');
		var $next = $counter.find('[data-counter-next]');
		var $prev = $counter.find('[data-counter-prev]');

		var $counterSwiper = $counter.find('[data-counter-swiper]');
		var speed = 1000;
		counterSwiper = new Swiper($counterSwiper, {
			slidesPerView: 1,
			direction: 'vertical',
			initialSlide: 0,
			speed: speed,
			height: 32,
			loop: true,
			autoplay: {
				delay: 5000,
				disableOnInteraction: false
			},
			controller: {
				control: [$swipers[0].swiper, $swipers[1].swiper, $swipers[2].swiper, $swipers[3].swiper]
			},
			on: {
				slideChangeTransitionStart: function() {
					var _this = this;
					this.allowSlidePrev = false;
					this.allowSlideNext = false;

					setTimeout(function() {
						_this.allowSlidePrev = true;
						_this.allowSlideNext = true;
					}, speed + 200);
				}
			}
		});

		$next.on('click', function() {
			if (counterSwiper.allowSlidePrev || counterSwiper.allowSlideNext) {
				counterSwiper.slideNext();
			}
		});

		$prev.on('click', function() {
			if (counterSwiper.allowSlidePrev || counterSwiper.allowSlideNext) {
				counterSwiper.slidePrev();
			}
		});
	}

	function initSwiper () {
		var $swipers = $homeSwiper.find('[data-swiper-main-images]');

		if ($swipers.length > 0) {
			var windowWidth = app.dom.$window.width();
			var quarter = Math.ceil(windowWidth / 4);
			$swipers.width(quarter);
			$swipers.each(function (swiperIndex) {
				var $slides = $(this).find('[data-slide-id]');
				var $imageElem = $slides.find('img');
				$imageElem.each(function () {
					$(this)[0].src = $(this).data('src');
					$(this).css({
						width: calcImgWidth + 'px',
						height: calcImgHeight + 'px',
						transform: 'translate(' + (-(quarter * swiperIndex) + transitionOffsetWidth) + 'px,' + transitionOffsetHeight + 'px)'
					});
				});

				var homeBannerSwiper = $('[data-home-banner]')[0];
				var swiperSettings = {
					allowTouchMove: false,
					virtualTranslate: true,
					speed: 1000,
					loop: true,
					on: {
						slideChange: function () {
							var _this = this;
							var slide = homeBannerSwiper.swiper.slides[this.realIndex];
							var $bannerTitle = $(slide).find('.main__slide-title p, .main__slide-title span');
							var $bannerText = $(slide).find('.main__slide-text p, .main__slide-text span');

							app.animateCSS($bannerTitle, 'titleSlideIn');
							app.animateCSS($bannerText, 'fadeInUp', 0, false);
						},
					},
					thumbs: {
						swiper: {
							el: homeBannerSwiper,
							virtualTranslate: true,
							allowTouchMove: false,
							on: {
								init: function () {
									app.swiperInitSplittyInside(this);
								}
							}
						}
					}
				};
				new Swiper(this, swiperSettings);
			});
			initPagination ($swipers);
		}
	}
};

app.swiperMainNews = function () {
	var $swiper = $('[data-swiper-main-news]');

	var swiperSettings = {
		slidesPerView: 1,
		spaceBetween: 32,
		allowTouchMove: false,
		breakpoints: {
			1200: {
				slidesPerView: 2
			},
			991: {
				slidesPerView: 1
			},
			580: {
				slidesPerView: 2
			}
		},
		on: {
			init: function() {
				app.swiperInitSplittyInside(this);
			}
		}
	};

	var resultSettings = $.extend(true, {}, app.swiperDefaultSettings, swiperSettings);

	if ($swiper.length) {
		var swiper = new Swiper($swiper, resultSettings);
		swiper.init();
	}
};

app.swiperMainStocks = function () {
	var $swiper = $('[data-swiper-mfs-swiper]');

	var swiperSettings = {
		allowTouchMove: false,
		thumbs: {
			swiper: {
				el: '[data-swiper-mfs-images]',
				speed: 1000
			}
		},
		pagination: {
			el: '[data-swiper-mfs-pagination]',
			clickable: true
		}
	};

	var resultSettings = $.extend(true, {}, app.swiperDefaultSettings, swiperSettings);

	if ($swiper.length) {
		var swiper = new Swiper($swiper, resultSettings);
		swiper.init();
	}
};

app.swiperMainProducts = function () {
	var $swiper = $('[data-swiper-main-products]');

	var swiperSettings = {
		spaceBetween: 32
	};

	var resultSettings = $.extend(true, {}, app.swiperDefaultSettings, swiperSettings);

	if ($swiper.length) {
		var swiper = new Swiper($swiper, resultSettings);
		swiper.init();
	}
};

app.swiperMainBannerMobile = function () {
	var $swiper = $('[data-swiper-main-mobile-banner]');

	var swiperSettings = {
		autoHeight: true,
		pagination: {
			el: '[data-swiper-main-mobile-banner-pagination]',
			type: 'bullets',
			clickable: true
		}
	};

	var resultSettings = $.extend(true, {}, app.swiperDefaultSettings, swiperSettings);

	if ($swiper.length) {
		var swiper = new Swiper($swiper, resultSettings);
		swiper.init();
	}
};

app.swiperPressGallery = function () {
	var $galleryCollection = $('[data-press-gallery-wrapper]');

	$galleryCollection.each(function() {
		var $this = $(this);
		var $gallery = $this.find('[data-press-gallery]');
		var $pagination = $this.find('[data-press-gallery-pagination]');
		var $next = $this.find('[data-press-gallery-next]');
		var $prev = $this.find('[data-press-gallery-prev]');

		new Swiper($gallery[0], {
			pagination: {
				el: $pagination[0],
				type: 'fraction',
			},
			navigation: {
				nextEl: $next[0],
				prevEl: $prev[0],
			},
		});
	});
};

app.swiperMoreNewsGallery = function () {
	var $galleryCollection = $('[data-more-news-gallery-wrapper]');

	$galleryCollection.each(function() {
		var $this = $(this);
		var $gallery = $this.find('[data-more-news-gallery]');
		var $pagination = $this.find('[data-more-news-gallery-pagination]');
		var $next = $this.find('[data-more-news-gallery-next]');
		var $prev = $this.find('[data-more-news-gallery-prev]');

		new Swiper($gallery[0], {
			spaceBetween: 32,
			slidesPerView: 'auto',
			pagination: {
				el: $pagination[0],
				type: 'fraction',
			},
			navigation: {
				nextEl: $next[0],
				prevEl: $prev[0],
			},
		});
	});
};

app.gallery = function () {
	var $videoTriggers = $('[data-video-trigger]');
	$videoTriggers.magnificPopup({
		type: 'iframe',
		iframe: {
			patterns: {
				youtube: {
					index: 'youtube.com/',
					id: function(url) {
						var m = url.match(/[\\?\\&]v=([^\\?\\&]+)/);
						if ( !m || !m[1] ) return null;
						return m[1];
					},
					src: '//www.youtube.com/embed/%id%?autoplay=1'
				}
			}
		},
		mainClass: 'gallery-popup',
		closeMarkup: '<div class="mfp-close-wrapper"><button title="%title%" type="button" class="mfp-close"></button></div>'
	});
};

app.careerImages = function () {
	var $careerImages = $('[data-career-images]'),
		careerImagesOffset = $careerImages.offset();

	if ($careerImages.length > 0) {
		var $careerImagesInner = $('[data-career-images-inner]');
		var $images = $careerImages.find('[data-career-images-item]');
		var imagesWidth = 0;
		var headerHeight = $('[data-header]').height();


		$images.each(function() {
			imagesWidth += $(this).outerWidth();
		});

		app.dom.$window.on('scroll', function(){
			var RATIO = -(0 - app.dom.$window.scrollTop()) / ($careerImages.height() + careerImagesOffset.top - headerHeight);

			var translateValue = RATIO * (app.dom.$window.width() - imagesWidth ) / 2;

			if (RATIO > 0) {
				$careerImagesInner.css({
					transform: 'translateX('+ translateValue +'px)'
				});
			} else {
				$careerImagesInner.css({
					transform: 'translateX(0px)'
				});
			}
		});
	}
};

app.imageLightbox = function () {
	$('[data-image-lightbox]').magnificPopup({
		type: 'image',
		mainClass: 'gallery-popup',
		closeMarkup: '<div class="mfp-close-wrapper"><button title="%title%" type="button" class="mfp-close"></button></div>'
	});
};

app.swiperAbout = function () {
	var swiperAbout = new Swiper ('[data-about-slider]', {
		speed: 1000,
		navigation: {
			nextEl: '[data-about-next]',
			prevEl: '[data-about-prev]'
		},
		on: {
			init: function () {
				var firstSlideContent = document.querySelector('[data-about-slider-content]');
				firstSlideContent.classList.add('about__slider-content--active');
			},
			slideChangeTransitionStart: function () {
				var slides = swiperAbout.slides;
				var prevItem = slides[swiperAbout.previousIndex].querySelector('[data-about-slider-content]');
				var nextItem = slides[swiperAbout.activeIndex].querySelector('[data-about-slider-content]');
				prevItem.classList.remove('about__slider-content--active');
				prevItem.classList.add('about__slider-content--closing');
				nextItem.classList.add('about__slider-content--active');
			},
			slideChangeTransitionEnd: function () {
				var slides = swiperAbout.slides;
				var prevItem = slides[swiperAbout.previousIndex].querySelector('[data-about-slider-content]');
				prevItem.classList.remove('about__slider-content--closing');
			}
		}
	});
};

app.dropzone = function () {
	var $dropzone = $('[data-dropzone]');

	$dropzone.each(function() {
		var $this = $(this);
		var $content = $this.find('[data-dropzone-content]');
		var $input = $this.find('[data-dropzone-input]');
		var $files = $this.find('[data-dropzone-files]');

		var dropzoneSettings = {
			paramName: 'file',
			uploadMultiple: true
		};

		$content.on('click', function() {
			$input.trigger('click');
		});

		$content.find('a').on('click', function(e){
			e.preventDefault();
		});

		$this.dropzone(dropzoneSettings).on('drop addedfile', function(e) {
			e.preventDefault();

			var files = e.originalEvent.dataTransfer.files;
			if (files.length > 0) {
				renderFiles(files, $files);
			}
		});

		$input.on('change', function(e) {
			e.preventDefault();

			var files = e.target.files;
			if (files.length > 0) {
				renderFiles(files, $files);
			}
		});

		function renderFiles (filesArray, $filesWrapperSelector) {
			var result = '';

			$(filesArray).each(function(i) {
				var name = this.name;

				result += '<div class="dropzone__file" data-dropzone-file data-dropzone-file-index="'+i+'">' +
					'<div class="dropzone__file-name">' +
						'<span>'+name+'</span>' +
					'</div>' +
					'<div class="dropzone__file-close" data-dropzone-file-close></div>' +
				'</div>';
			});

			$filesWrapperSelector.html(result);

			$('[data-dropzone-file-close]').on('click', function() {
				var $this = $(this);

				$this.closest('[data-dropzone-file]').remove();
			});
		}
	});
};

app.contactsMap = function () {
	var contactsMapSelector = $('[data-contacts-map]')[0];

	if (contactsMapSelector) {
		var position = {lat: 55.737297960689304, lng: 37.505245920606015};
		var map = new google.maps.Map(contactsMapSelector, {
			center: position,
			zoom: 17,
			format: 'png',
			maptype: 'roadmap',
			styles: [
				{
					'featureType': 'administrative',
					'elementType': 'geometry',
					'stylers': [
						{
							'visibility': 'off'
						}
					]
				},
				{
					'featureType': 'administrative',
					'elementType': 'geometry.fill',
					'stylers': [
						{
							'color': '#ffffff'
						},
						{
							'weight': 2
						}
					]
				},
				{
					'featureType': 'poi',
					'stylers': [
						{
							'visibility': 'off'
						}
					]
				},
				{
					'featureType': 'road',
					'elementType': 'labels.icon',
					'stylers': [
						{
							'visibility': 'off'
						}
					]
				},
				{
					'featureType': 'road.arterial',
					'elementType': 'geometry.fill',
					'stylers': [
						{
							'color': '#ffffff'
						}
					]
				},
				{
					'featureType': 'road.arterial',
					'elementType': 'geometry.stroke',
					'stylers': [
						{
							'color': '#ffffff'
						}
					]
				},
				{
					'featureType': 'road.highway',
					'elementType': 'geometry.fill',
					'stylers': [
						{
							'color': '#ffffff'
						}
					]
				},
				{
					'featureType': 'road.highway.controlled_access',
					'elementType': 'geometry.fill',
					'stylers': [
						{
							'color': '#ffffff'
						}
					]
				},
				{
					'featureType': 'road.local',
					'elementType': 'geometry.stroke',
					'stylers': [
						{
							'color': '#ffffff'
						}
					]
				},
				{
					'featureType': 'transit',
					'stylers': [
						{
							'visibility': 'off'
						}
					]
				}
			]
		});

		new google.maps.Marker({
			position: position,
			map: map,
			icon: '/common/images/i-map-marker.svg'
		});
	}
};

app.validateForm = function() {
	var $input = $('[data-input], [data-textarea]');

	var notEmptyClass = '_not-empty',
		validClass = '_valid',
		invalidClass = '_invalid';

	$input.each(function() {
		var $this = $(this);
		var $field = $this.find('[data-input-field]');
		var fieldType = $field.attr('type');

		$field.on('change keyup', function() {
			var value = $field.val();

			if (value.length > 0) {
				$field.addClass(notEmptyClass);
			} else {
				if(fieldType !== 'phone' && fieldType !== 'tel') {
					$field.removeClass(notEmptyClass);
				}
			}

			if(fieldType === 'email') {
				if (isEmail($field.val())) {
					$field.addClass(validClass).removeClass(invalidClass);

					removeInputError($this);
				} else {
					$field.removeClass(validClass).addClass(invalidClass);

					renderInputError($this, 'Некорректно введена почта');
				}
			}
		});

		if (fieldType === 'phone' || fieldType === 'tel') {
			$field.addClass(notEmptyClass);
		}
	});

	function isEmail(email) {
		var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
		return regex.test(email);
	}

	function renderInputError ($containerSelector, errorMessage) {
		var getErrorMessageContainer = $containerSelector.find('[data-input-error]');

		if (getErrorMessageContainer.length === 0) {
			var template = '<div class="input__error" data-input-error>' +
				'<span>'+errorMessage+'</span>' +
				'</div>';
			$containerSelector.append(template);
		}
	}

	function removeInputError ($containerSelector) {
		$containerSelector.find('[data-input-error]').remove();
	}
};

app.maskedInput = function() {
	$('input[type="phone"], input[type="tel"]').mask('+7 (999) 999-99-99', {
		autoclear: false
	}).addClass('_masked');
};

app.counter = function () {
	var $counters = $('[data-counter="common"]');

	$counters.each(function() {
		var $this = $(this);
		var $prev = $this.find('[data-counter-prev]');
		var $next = $this.find('[data-counter-next]');
		var $counterSwiper = $this.find('[data-counter-swiper]');
		var $swiper = $(this).closest('.swiper-container');

		if ($swiper.length > 0) {
			var swiper = $swiper[0].swiper;
		}


		if ($counterSwiper.length > 0) {
			var counterSwiper = new Swiper($counterSwiper[0], {
				slidesPerView: 1,
				initialSlide: 0,
				height: 32,
				direction: 'vertical',
				loop: false,
				navigation: {
					prevEl: $prev[0],
					nextEl: $next[0]
				}
			});
		}

		$prev.on('click', function() {
			if (swiper) {
				swiper.slidePrev();

				if (counterSwiper) {
					counterSwiper.slideTo(swiper.activeIndex);
				}
			}
		});

		$next.on('click', function() {
			if (swiper) {
				swiper.slideNext();

				if (counterSwiper) {
					counterSwiper.slideTo(swiper.activeIndex);
				}
			}
		});
	});
};

app.about = function () {
	var $wpAboutStock = $('[data-waypoint="about-stock"]');
	var $wpAboutStats = $('[data-waypoint="about-stats"]');
	var $wpAboutIndicators = $('[data-waypoint="about-indicators"]');

	$wpAboutIndicators.waypoint({
		offset: $('[data-header]').outerHeight(),
		handler: function(dir) {
			switch (dir) {
			case 'down':
				$wpAboutStock.addClass('_fixed-top');
				break;
			case 'up':
				$wpAboutStock.removeClass('_fixed-top');
				break;
			}
		}
	});

	$wpAboutStats.waypoint({
		offset: function() {
			return this.context.innerHeight() - this.adapter.outerHeight() - 32;
		},
		handler: function (dir) {
			switch (dir){
			case 'down':
				$wpAboutStock.addClass('_fixed-bottom').removeClass('_fixed-top');
				break;
			case 'up':
				$wpAboutStock.removeClass('_fixed-bottom').addClass('_fixed-top');
			}
		}
	});
};

app.search = function() {
	var $search = $('[data-search]');
	var $searchPredict = $search.find('[data-search-predict]');
	var $searchInput = $search.find('[data-search-input]');
	var $searchClear = $search.find('[data-search-clear]');

	$searchInput.on('keyup keydown', function(){
		var $this = $(this);
		var $val = $this.val();
		var testPredict = showSearchPredict($val, 'Производство');

		if ($val.length > 0) {
			$searchClear.stop().show();
		} else {
			$searchClear.stop().hide();
		}

		if ($val.length > 0 && testPredict) {
			$searchPredict.text(testPredict);
		} else {
			$searchPredict.text('');
		}
	});

	$searchClear.on('click', function() {
		$searchPredict.text('');
		$searchInput.val('').attr('value', '');
		$searchClear.stop().hide();
	});

	var showSearchPredict = function (query, predictString) {
		if (predictString.includes(query)) {
			return predictString;
		}
	};
};

app.alert = function () {
	var $alerts = $('[data-alert]');
	$alerts.each(function() {
		var $this = $(this);
		var $close = $this.find('[data-alert-close]');

		$close.on('click', function() {
			$this.stop().hide();
		});
	});
};

app.init = function () {
	app.smoothScroll();
	app.highcharts();
	app.splitty();
	app.openPopup();
	app.fade();
	app.menu();
	app.collapse();
	app.tabs();
	app.cookieLayout();
	app.chosen();
	app.stickyScroller();
	app.geoMap();
	app.history();
	app.stickyHeader();
	app.swiperPressGallery();
	app.swiperMoreNewsGallery();
	app.swiperMainHeaderImages();
	app.swiperMainStocks();
	app.swiperMainNews();
	app.swiperMainProducts();
	app.swiperMainBannerMobile();
	app.gallery();
	app.careerImages();
	app.imageLightbox();
	app.dropzone();
	app.contactsMap();
	app.validateForm();
	app.maskedInput();
	app.swiperAbout();
	app.counter();
	app.about();
	app.search();
	app.alert();
	app.lang();
	app.revealBlockOnReset();
};

$(function () {
	$(document).ready(function () {
		app.init();
	});
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImFwcCA9IHtcclxuXHRkb206IHtcclxuXHRcdCR3aW5kb3c6ICQod2luZG93KVxyXG5cdH0sXHJcblx0YW5pbWF0aW9uQmV0d2VlbkRlbGF5OiAwLjI1LFxyXG5cdHN3aXBlckRlZmF1bHRTZXR0aW5nczoge1xyXG5cdFx0c2xpZGVzUGVyVmlldzogMSxcclxuXHRcdGZvbGxvd0ZpbmdlcjogZmFsc2UsXHJcblx0XHRpbml0OiBmYWxzZSxcclxuXHRcdHNwZWVkOiAxMDAwXHJcblx0fVxyXG59O1xyXG5cclxuYXBwLnN3aXBlckluaXRTcGxpdHR5SW5zaWRlID0gZnVuY3Rpb24gKHN3aXBlciwgY2FsbGJhY2spIHtcclxuXHR2YXIgJGVsID0gJChzd2lwZXIuJGVsKTtcclxuXHR2YXIgJHNsaWRlcyA9ICRlbC5maW5kKCdbZGF0YS1ob21lLWJhbm5lci1zbGlkZV0nKTtcclxuXHQkc2xpZGVzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHQkKHRoaXMpLnJlbW92ZUNsYXNzKCdfcGFyc2VkJykuYWRkQ2xhc3MoJ19wYXJzaW5nJyk7XHJcblx0fSk7XHJcblxyXG5cdC8vINCg0LDQt9Cx0LjQstCw0LXQvCDRgdGC0YDQvtC60Lgg0L3QsCDRjdC70LXQvNC10L3RgtGLINCyINGB0LvQsNC50LTQsNGFINGB0LLQsNC50L/QtdGA0LAsINGB0L7Qt9C00LDQstCw0Y8g0LjQvCDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3Rg9GOINCy0LvQvtC20LXQvdC90L7RgdGC0YxcclxuXHQvLyAo0L3QtdC+0LHRhdC+0LTQuNC80L4g0LTQu9GPINCw0L3QuNC80LDRhtC40Lgg0LLRi9C10LfQttCw0L3QuNGPICfQuNC3INC/0L7QtCDRiNGC0L7RgNC60LgnKVxyXG5cdCRlbC5maW5kKCdbZGF0YS1zcGxpdHR5LXN3aXBlci10aXRsZV0nKS5zcGxpdHR5KHtcclxuXHRcdGFkZGl0aW9uYWxOZXN0aW5nOiB0cnVlXHJcblx0fSk7XHJcblxyXG5cdC8vINCg0LDQt9Cx0LjQstCw0LXQvCDRgdGC0YDQvtC60Lgg0L3QsCDRjdC70LXQvNC10L3RgtGLINCy0L3Rg9GC0YDQuCDRgdC70LDQudC00L7QsiDRgdCy0LDQudC/0LXRgNCwXHJcblx0JGVsLmZpbmQoJ1tkYXRhLXNwbGl0dHktc3dpcGVyXScpLnNwbGl0dHkoe1xyXG5cdFx0b25Jbml0OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGFwcC5wYXJzZUFuaW1hdGVEZWxheWVkKCk7XHJcblxyXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdCRzbGlkZXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoJ19wYXJzaW5nJykuYWRkQ2xhc3MoJ19wYXJzZWQnKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSwgMzAwKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0dHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nICYmIGNhbGxiYWNrKCk7XHJcbn07XHJcblxyXG5hcHAuY2hlY2tTY3JvbGxUb3BGb3JGaXJzdFNjcmVlbiA9IGZ1bmN0aW9uICgpIHtcclxuXHQvLyDQn9GA0L7QstC10YDRj9C10LwsINC90LDRhdC+0LTQuNGC0YHRjyDQu9C4INC/0LXRgNCy0YvQuSDRjdC60YDQsNC9INCz0LvQsNCy0L3QvtC5INGB0YLRgNCw0L3QuNGG0Ysg0LIg0LfQvtC90LUg0LLQuNC00LjQvNC+0YHRgtC4INGN0LrRgNCw0L3QsFxyXG5cdC8vINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjyDQv9GA0Lgg0LfQsNCz0YDRg9C30LrQtSDRgdGC0YDQsNC90LjRhtGLXHJcblx0dmFyIGN1cnJlbnRXaW5kb3dTY3JvbGwgPSBhcHAuZG9tLiR3aW5kb3cuc2Nyb2xsVG9wKCk7XHJcblx0dmFyIGZpcnN0U2NyZWVuSGVpZ2h0ID0gJCgnW2RhdGEtd2F5cG9pbnQ9XCJtcF9maXJzdFwiXScpLmhlaWdodCgpO1xyXG5cclxuXHRyZXR1cm4gY3VycmVudFdpbmRvd1Njcm9sbCA8PSBmaXJzdFNjcmVlbkhlaWdodDtcclxufTtcclxuXHJcbmFwcC5hZGRTcGxpdHR5RGVsYXkgPSBmdW5jdGlvbiAoJGl0ZW0sIGRlbGF5LCBjYWxsYmFjaykge1xyXG5cdC8vINCj0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdC8INC30LDQtNC10YDQttC60YMg0LIgZGF0YS3QsNGC0YDQuNCx0YPRgiDQv9C10YDQtdC00LDQvdC90L7Qs9C+INGN0LvQtdC80LXQvdGC0LBcclxuXHQkaXRlbS5hdHRyKCdkYXRhLWFuaW1hdGUtZGVsYXllZCcsIGRlbGF5KTtcclxuXHJcblx0dHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nICYmIGNhbGxiYWNrKHtcclxuXHRcdGRlbGF5OiBkZWxheSxcclxuXHRcdGVsZW1lbnQ6ICRpdGVtXHJcblx0fSk7XHJcbn07XHJcblxyXG5hcHAuZmlyc3RTcGxpdHR5SW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuXHQvLyDQo9GB0YLQsNC90LDQstC70LjQstCw0LXQvCDQt9Cw0LTQtdGA0LbQutGDINC90LAg0L/QvtGP0LLQu9C10L3QuNC1INGN0LvQtdC80LXQvdGC0L7QsixcclxuXHQvLyDQtdGB0LvQuCDQv9C10YDQstGL0Lkg0Y3QutGA0LDQvSDQs9C70LDQstC90L7QuSDRgdGC0YDQsNC90LjRhtGLINC90LDRhdC+0LTQuNGC0YHRjyDQsiDQt9C+0L3QtSDQstC40LTQuNC80L7RgdGC0Lgg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXHJcblx0aWYgKCBhcHAuY2hlY2tTY3JvbGxUb3BGb3JGaXJzdFNjcmVlbigpICkge1xyXG5cdFx0dmFyIGVsZW1lbnRzID0gW1xyXG5cdFx0XHR7XHJcblx0XHRcdFx0JGVsZW1lbnQ6ICQoJ1tkYXRhLWFuaW1hdGUtZGVsYXllZC10YXJnZXQ9XCJmaXJzdFRpdGxlXCJdJyksXHJcblx0XHRcdFx0ZGVsYXk6IDBcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdCRlbGVtZW50OiAkKCdbZGF0YS1hbmltYXRlLWRlbGF5ZWQtdGFyZ2V0PVwiZmlyc3RUZXh0XCJdJyksXHJcblx0XHRcdFx0ZGVsYXk6IDAuNlxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0JGVsZW1lbnQ6ICQoJ1tkYXRhLWFuaW1hdGUtZGVsYXllZC10YXJnZXQ9XCJoZWFkZXJcIl0nKSxcclxuXHRcdFx0XHRkZWxheTogMFxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0JGVsZW1lbnQ6ICQoJ1tkYXRhLWFuaW1hdGUtZGVsYXllZC10YXJnZXQ9XCJmaXJzdENvdW50ZXJcIl0nKSxcclxuXHRcdFx0XHRkZWxheTogMVxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0JGVsZW1lbnQ6ICQoJ1tkYXRhLWFuaW1hdGUtZGVsYXllZC10YXJnZXQ9XCJmaXJzdEljb25TZWFyY2hcIl0nKSxcclxuXHRcdFx0XHRkZWxheTogMS4yNVxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0JGVsZW1lbnQ6ICQoJ1tkYXRhLWFuaW1hdGUtZGVsYXllZC10YXJnZXQ9XCJmaXJzdEljb25BcnJvd1wiXScpLFxyXG5cdFx0XHRcdGRlbGF5OiAxLjI1XHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHQkZWxlbWVudDogJCgnW2RhdGEtYW5pbWF0ZS1kZWxheWVkLXRhcmdldD1cImZpcnN0SWNvbkFycm93V3JhcHBlclwiXScpLFxyXG5cdFx0XHRcdGRlbGF5OiAwLjY1XHJcblx0XHRcdH1cclxuXHRcdF07XHJcblxyXG5cdFx0Ly8g0KPRgdGC0LDQvdCy0LvQuNCy0LDQtdC8INCy0YHQtdC8INGN0LvQtdC80LXQvdGC0LDQvCDQsiDQvNCw0YHRgdC40LLQtSDQt9Cw0LTQtdGA0LbQutGDIChhbmltYXRlLWRlbGF5KSxcclxuXHRcdC8vINC60L7RgtC+0YDQsNGPINGD0LrQsNC30LDQvdCwINCyINCw0YLRgNC40LHRg9GC0LUgJ2RhdGEtYW5pbWF0ZS1kZWxheWVkJ1xyXG5cdFx0Zm9yICh2YXIgaT0wOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0YXBwLmFkZFNwbGl0dHlEZWxheShlbGVtZW50c1tpXS4kZWxlbWVudCwgZWxlbWVudHNbaV0uZGVsYXksIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGVsZW1lbnRzW2ldLiRlbGVtZW50LnJlbW92ZUF0dHIoJ2RhdGEtd293LWRlbGF5Jyk7XHJcblx0XHRcdFx0YXBwLnBhcnNlQW5pbWF0ZURlbGF5ZWQoZWxlbWVudHNbaV0uJGVsZW1lbnQpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyDQntCx0L3Rg9C70Y/QtdC8IGFuaW1hdGlvbi1kZWxheSDRgyDRjdC70LXQvNC10L3RgtC+0LJcclxuXHRcdGZ1bmN0aW9uIHJlc2V0RWxlbWVudHNEZWxheXMgKCkge1xyXG5cdFx0XHRmb3IgKHZhciBpPTA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGFwcC5wYXJzZUFuaW1hdGVEZWxheWVkKGVsZW1lbnRzW2ldLiRlbGVtZW50KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vINCf0L7RgdC70LUg0L7RgtGA0LDQsdC+0YLQutC4INCy0YHQtdGFINCw0L3QuNC80LDRhtC40LksINGD0LTQsNC70Y/QtdC8INGDINGN0LvQtdC80LXQvdGC0L7QsiDQt9Cw0LTQtdGA0LbQutC4XHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRmb3IgKHZhciBpPTA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdHZhciAkY3VycmVudCA9IGVsZW1lbnRzW2ldLiRlbGVtZW50O1xyXG5cdFx0XHRcdHZhciBkZWxheWVkVGFyZ2V0ID0gJGN1cnJlbnQuYXR0cignZGF0YS1hbmltYXRlLWRlbGF5ZWQtdGFyZ2V0Jyk7XHJcblxyXG5cdFx0XHRcdGlmIChkZWxheWVkVGFyZ2V0ID09PSAnZmlyc3RUaXRsZScpIHtcclxuXHRcdFx0XHRcdCRjdXJyZW50LmZpbmQoJ3AsIHNwYW4nKS5jc3Moe1xyXG5cdFx0XHRcdFx0XHQnYW5pbWF0aW9uLWRlbGF5JzogJydcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0JGN1cnJlbnQuYXR0cignZGF0YS1hbmltYXRlLWRlbGF5ZWQnLCAnJykuY3NzKHtcclxuXHRcdFx0XHRcdCdhbmltYXRpb24tZGVsYXknOiAnJ1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdCRjdXJyZW50LmZpbmQoJy5hbmltYXRlZCcpLmNzcyh7XHJcblx0XHRcdFx0XHQnYW5pbWF0aW9uLWRlbGF5JzogJydcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmVzZXRFbGVtZW50c0RlbGF5cygpO1xyXG5cdFx0fSwgNjAwMCk7XHJcblx0fVxyXG5cclxuXHRhcHAucGFyc2VBbmltYXRlRGVsYXllZCgpO1xyXG59O1xyXG5cclxuYXBwLnBhcnNlQW5pbWF0ZURlbGF5ZWQgPSBmdW5jdGlvbiAoJGVsZW0sIHJldmVyc2UpIHtcclxuXHQvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0YHRgtGD0L/QtdC90YfQsNGC0YPRjiDQt9Cw0LTQtdGA0LbQutGDINGN0LvQtdC80LXQvdGC0LDQvFxyXG5cdC8vICjRg9Cy0LXQu9C40YfQuNCy0LDQtdC8INC30LDQtNC10YDQutC20YMg0L/QvtGP0LLQu9C10L3QuNGPINGB0LvQtdC00YPRjtGJ0LXQs9C+INGN0LvQtdC80LXQvdGC0LAg0LIg0YbQuNC60LvQtVxyXG5cdC8vINC90LAg0LfQvdCw0YfQtdC90LjQtSDQsiBhcHAuYW5pbWF0aW9uQmV0d2VlbkRlbGF5LCDQu9C40LHQviAwXHJcblx0dmFyICR0aGlzID0gJGVsZW0gfHwgJCgnW2RhdGEtYW5pbWF0ZS1kZWxheWVkXScpO1xyXG5cclxuXHRpZiAoJHRoaXMpIHtcclxuXHRcdCR0aGlzLmVhY2goZnVuY3Rpb24oaSwgZWxlbWVudCl7XHJcblx0XHRcdHZhciBkYXRhQW5pbWF0ZURlbGF5ZWQgPSBwYXJzZUZsb2F0KCQoZWxlbWVudCkuYXR0cignZGF0YS1hbmltYXRlLWRlbGF5ZWQnKSk7XHJcblxyXG5cdFx0XHR2YXIgJGFuaW1hdGVDaGlsZHJlbiA9ICQoZWxlbWVudCkuZmluZCgncCwgc3BhbicpO1xyXG5cclxuXHRcdFx0dmFyICRwYXJzZVRhcmdldCA9ICRhbmltYXRlQ2hpbGRyZW4ubGVuZ3RoID4gMCA/ICRhbmltYXRlQ2hpbGRyZW4gOiAkKGVsZW1lbnQpO1xyXG5cclxuXHRcdFx0dmFyIGRlZmF1bHRBbmltYXRpb25EZWxheSA9IHJldmVyc2UgPyAoJHBhcnNlVGFyZ2V0Lmxlbmd0aCAtIDEpICogYXBwLmFuaW1hdGlvbkJldHdlZW5EZWxheSA6IDA7XHJcblx0XHRcdHZhciBhbmltYXRpb25EZWxheSA9IHR5cGVvZiBkYXRhQW5pbWF0ZURlbGF5ZWQgPT09ICdudW1iZXInICYmIChkYXRhQW5pbWF0ZURlbGF5ZWQgKyBkZWZhdWx0QW5pbWF0aW9uRGVsYXkpIHx8IGRlZmF1bHRBbmltYXRpb25EZWxheTtcclxuXHJcblx0XHRcdCRwYXJzZVRhcmdldC5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdC8vIEFkZCB0cmFuc2l0aW9uLWRlbGF5XHJcblx0XHRcdFx0JCh0aGlzKS5jc3Moe1xyXG5cdFx0XHRcdFx0J2FuaW1hdGlvbi1kZWxheSc6IGFuaW1hdGlvbkRlbGF5ICsgJ3MnXHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdC8vIFJlZHVjZSBjdXJyZW50IHRyYW5zaXRpb24gc3RlcFxyXG5cdFx0XHRcdGFuaW1hdGlvbkRlbGF5ICs9IChyZXZlcnNlID8gLTEgOiAxKSAqIGFwcC5hbmltYXRpb25CZXR3ZWVuRGVsYXk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxuYXBwLmFuaW1hdGVDU1MgPSBmdW5jdGlvbiAoZWxlbWVudCwgYW5pbWF0aW9uTmFtZSwgY2FsbGJhY2ssIG9mZlRpbWVvdXQsIHJlbW92ZUFuaW1hdGlvbkNsYXNzKSB7XHJcblx0Ly8g0KTRg9C90LrRhtC40Y8g0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNGPINCw0L3QuNC80LDRhtC40LggJ2FuaW1hdGlvbk5hbWUnINC00LvRjyDRjdC70LXQvNC10L3RgtCwICdlbGVtZW50J1xyXG5cdHZhciAkbm9kZSA9ICQoZWxlbWVudCk7XHJcblxyXG5cdC8vINCl0LDQuiDQtNC70Y8gSUUsINC00LvRjyDQutC+0YDRgNC10LrRgtC90L7QuSDQvtGC0YDQsNCx0L7RgtC60Lgg0LDQvdC40LzQsNGG0LjQuVxyXG5cdGlmIChhcHAuaXNJRSgpKSB7XHJcblx0XHQkbm9kZS5hZGRDbGFzcygnaGlkZGVuJykucmVtb3ZlQ2xhc3MoJ2FuaW1hdGVkJykucmVtb3ZlQ2xhc3MoYW5pbWF0aW9uTmFtZSk7XHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkbm9kZS5yZW1vdmVDbGFzcygnaGlkZGVuJykuYWRkQ2xhc3MoJ2FuaW1hdGVkJykuYWRkQ2xhc3MoYW5pbWF0aW9uTmFtZSk7XHJcblx0XHR9LCAwKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0JG5vZGUuYWRkQ2xhc3MoJ2FuaW1hdGVkJykuYWRkQ2xhc3MoYW5pbWF0aW9uTmFtZSk7XHJcblx0fVxyXG5cclxuXHQvLyDQo9C00LDQu9GP0LXQvCDQv9GA0LjRgdCy0L7QtdC90L3Ri9C1INGN0LvQtdC80LXQvdGC0YMg0YHQstC+0LnRgdGC0LLQsCDQv9C+0YHQu9C1INC+0LrQvtC90YfQsNC90LjRjyDQsNC90LjQvNCw0YbQuNC4XHJcblx0ZnVuY3Rpb24gaGFuZGxlQW5pbWF0aW9uRW5kKCkge1xyXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGlmIChyZW1vdmVBbmltYXRpb25DbGFzcykge1xyXG5cdFx0XHRcdCRub2RlLnJlbW92ZUNsYXNzKCdhbmltYXRlZCcpLnJlbW92ZUNsYXNzKGFuaW1hdGlvbk5hbWUpO1xyXG5cdFx0XHR9XHJcblx0XHRcdCRub2RlLm9mZignYW5pbWF0aW9uZW5kJywgaGFuZGxlQW5pbWF0aW9uRW5kKTtcclxuXHRcdH0sIG9mZlRpbWVvdXQgfHwgMCk7XHJcblxyXG5cdFx0aWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykgY2FsbGJhY2soKTtcclxuXHR9XHJcblxyXG5cdCRub2RlLm9uKCdhbmltYXRpb25lbmQnLCBoYW5kbGVBbmltYXRpb25FbmQpO1xyXG59O1xyXG5cclxuYXBwLmlzSUUgPSBmdW5jdGlvbiAoKSB7XHJcblx0Ly8g0J/RgNC+0LLQtdGA0LrQsCDQsdGA0LDRg9C30LXRgNCwINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjyDQvdCwIElFXHJcblx0dmFyIHVzZXJBZ2VudCA9IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCk7XHJcblxyXG5cdGlmICgoL3RyaWRlbnQvZ2kpLnRlc3QodXNlckFnZW50KSB8fCAoL21zaWUvZ2kpLnRlc3QodXNlckFnZW50KSkge1xyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gZmFsc2U7XHJcbn07XHJcblxyXG5hcHAuc3RpY2t5U2Nyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XHJcblx0Ly8g0L7QsdC10YDRgtC60LAsINCy0L3Rg9GC0YDQuCDQutC+0YLQvtGA0L7QuSDQsdGD0LTQtdGCINGA0LDQsdC+0YLQsNGC0Ywg0LHQu9C+0Logc3RpY2t5XHJcblx0dmFyICRzdGlja3lTY3JvbGxlclBhcmVudCA9ICQoJ1tkYXRhLXN0aWNreS1zY3JvbGxlcl0nKTtcclxuXHRpZiAoJHN0aWNreVNjcm9sbGVyUGFyZW50Lmxlbmd0aCkge1xyXG5cdFx0Ly8g0LHQu9C+0LosINC60L7RgtC+0YDRi9C5INCy0LXQtNC10YIg0YHQtdCx0Y8g0LrQsNC6IHN0aWNreVxyXG5cdFx0dmFyICRzdGlja3lTY3JvbGxlckJsb2NrID0gJHN0aWNreVNjcm9sbGVyUGFyZW50LmZpbmQoJ1tkYXRhLXN0aWNreS1zY3JvbGxlci1ibG9ja10nKTtcclxuXHRcdC8vINCy0L3Rg9GC0YDQtdC90L3RjyDQs9Cw0LvQsNGA0LXRjywg0LrQvtGC0L7RgNCw0Y8g0L/RgNC+0LrRgNGD0YfQuNCy0LDQtdGC0YHRjyDQv9GA0Lgg0YHQutGA0L7Qu9C1XHJcblx0XHR2YXIgJHN0aWNreVNjcm9sbGVyR2FsbGVyeSA9ICRzdGlja3lTY3JvbGxlckJsb2NrLmZpbmQoJ1tkYXRhLXN0aWNreS1zY3JvbGxlci1nYWxsZXJ5XScpO1xyXG5cdFx0dmFyIHN0aWNreVNjcm9sbGVyR2FsbGVyeVdpZHRoID0gJHN0aWNreVNjcm9sbGVyR2FsbGVyeVswXS5zY3JvbGxXaWR0aDsgLy8g0YjQuNGA0LjQvdCwINCz0LDQu9C10YDQtdC4XHJcblx0XHR2YXIgaGVhZGVySGVpZ2h0ID0gJCgnW2RhdGEtaGVhZGVyXScpLmhlaWdodCgpOyAvLyDQstGL0YHQvtGC0LAg0YjQsNC/0LrQuCDRgdCw0LnRgtCwXHJcblxyXG5cdFx0Ly8g0LLRi9GB0YLQsNCy0LvRj9C10Lwg0LLRi9GB0L7RgtGDINC00LvRjyDQvdCw0YjQtdCz0L4g0LHQu9C+0LrQsCDRgdC+INGB0YLQuNC60Lgg0LjRgdGF0L7QtNGPINC40Lcg0YjQuNGA0LjQvdGLINCz0LDQu9C10YDQtdC4XHJcblx0XHRmdW5jdGlvbiB1cGRhdGVTY3JvbGxlckhlaWdodCAoKSB7XHJcblx0XHRcdCRzdGlja3lTY3JvbGxlclBhcmVudC5oZWlnaHQoc3RpY2t5U2Nyb2xsZXJHYWxsZXJ5V2lkdGggKyAkc3RpY2t5U2Nyb2xsZXJCbG9jay5vdXRlckhlaWdodCgpKS5jc3Moe1xyXG5cdFx0XHRcdHBvc2l0aW9uOiAncmVsYXRpdmUnXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdGFwcC5kb20uJHdpbmRvdy5vbigncmVzaXplJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdHVwZGF0ZVNjcm9sbGVySGVpZ2h0KCk7XHJcblx0XHR9KTtcclxuXHRcdHVwZGF0ZVNjcm9sbGVySGVpZ2h0KCk7XHJcblxyXG5cdFx0Ly8g0LLQstC+0LTQuNC8INGB0L7RgdGC0L7Rj9C90LjQtSBzdGlja3kg0LHQu9C+0LrQsFxyXG5cdFx0dmFyIHN0YXRlID0gJ3RvcCc7IC8vIFt0b3AsIGJvdHRvbSwgZml4ZWRdXHJcblxyXG5cdFx0Ly8g0YTRg9C90LrRhtC40Y8g0LTQu9GPINCy0YvRh9C40YHQu9C10L3QuNGPINC/0L7Qu9C+0LbQtdC90LjRjyBzdGlja3kg0LHQu9C+0LrQsCwg0YHQvNC10YjQtdC90LjRjyDQs9Cw0LvQtdGA0LXQuCDQuCDRg9GB0YLQsNC90L7QstC60Lgg0L3Rg9C20L3Ri9GFIGNzc1xyXG5cdFx0Ly8g0LLRi9C30L7QstCw0LXRgtGB0Y8g0L/RgNC4INGB0LrRgNC+0LvQtSDQuCDRgNC10YHQsNC50LfQtVxyXG5cdFx0ZnVuY3Rpb24gdXBkYXRlICgpIHtcclxuXHRcdFx0Ly8g0LLQtdGA0YXQvdC40Lkg0L7RgtGB0YLRg9C/LCDRh9GC0L7QsdGLINCx0LvQvtC6INCx0YvQuyDQv9C+INGB0LXRgNC10LTQuNC90LUg0Y3QutGA0LDQvdCwINGBINGD0YfQtdGC0L7QvCDRiNCw0L/QutC4XHJcblx0XHRcdHZhciBvZmZzZXRUb3AgPSAoYXBwLmRvbS4kd2luZG93LmhlaWdodCgpIC0gaGVhZGVySGVpZ2h0IC0gJHN0aWNreVNjcm9sbGVyQmxvY2suaGVpZ2h0KCkpIC8gMiArIGhlYWRlckhlaWdodDtcclxuXHRcdFx0Ly8g0L/QvtC70L7QttC10L3QuNC1INC+0LHRg9GA0YLQutC4INGB0L3QuNC60Lgg0LLQviB2aWV3cG9ydFxyXG5cdFx0XHR2YXIgcGFyZW50UmVjdCA9ICRzdGlja3lTY3JvbGxlclBhcmVudFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcblx0XHRcdC8vINC10YHQu9C4INC+0LHQtdGA0YLQutCwINC90LjQttC1INCy0LXRgNGF0L3QtdCz0L4g0L7RgtGB0YLRg9C/0LAsINGC0L4g0YTQuNC60YHQuNGA0YPQtdC8IHN0aWNreSDQstCy0LXRgNGF0YMg0LHQu9C+0LrQsFxyXG5cdFx0XHRpZiAocGFyZW50UmVjdC50b3AgPiBvZmZzZXRUb3ApIHtcclxuXHRcdFx0XHQvLyDQvdC1INCy0YvQv9C+0LvQvdGP0LXQvCDQvdC40YfQtdCz0L4sINC10YHQu9C4INGB0L7RgdGC0L7Rj9C90LjQtSBzdGlja3kg0L3QtSDQuNC30LzQtdC90Y/Qu9C+0YHRjFxyXG5cdFx0XHRcdGlmKHN0YXRlICE9PSAndG9wJykge1xyXG5cdFx0XHRcdFx0c3RhdGUgPSAndG9wJztcclxuXHRcdFx0XHRcdCRzdGlja3lTY3JvbGxlckJsb2NrLmNzcyh7XHJcblx0XHRcdFx0XHRcdHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxyXG5cdFx0XHRcdFx0XHR0b3A6IDAsXHJcblx0XHRcdFx0XHRcdHdpZHRoOiAnMTAwJScsXHJcblx0XHRcdFx0XHRcdGJvdHRvbTogJ2F1dG8nXHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdC8vINC10YHQu9C4INGA0LDRgdGB0YLQvtGP0L3QuNC1INC00L4g0L3QuNC20L3QtdC5INCz0YDQsNC90LjRhtGLINCx0L7Qu9GM0YjQtSDQsdC+0LvRjNGI0LUsINGH0LXQvCDQstGL0YHQvtGC0LAgc3RpY2t5INCx0LvQvtC60LAgKyDRgdC80LXRidC10L3QuNC1LCDRgtC+INC30LDQutGA0LXQv9C70Y/QtdC8INC/0L4g0YHQtdGA0LXQtNC40L3QtSDRjdC60YDQsNC90LBcclxuXHRcdFx0fSBlbHNlIGlmIChwYXJlbnRSZWN0LmJvdHRvbSA+ICRzdGlja3lTY3JvbGxlckJsb2NrLm91dGVySGVpZ2h0KCkgKyBvZmZzZXRUb3ApIHtcclxuXHRcdFx0XHRpZihzdGF0ZSAhPT0gJ2ZpeGVkJykge1xyXG5cdFx0XHRcdFx0c3RhdGUgPSAnZml4ZWQnO1xyXG5cdFx0XHRcdFx0JHN0aWNreVNjcm9sbGVyQmxvY2suY3NzKHtcclxuXHRcdFx0XHRcdFx0cG9zaXRpb246ICdmaXhlZCcsXHJcblx0XHRcdFx0XHRcdHdpZHRoOiAkc3RpY2t5U2Nyb2xsZXJQYXJlbnQud2lkdGgoKSArICdweCcsXHJcblx0XHRcdFx0XHRcdHRvcDogb2Zmc2V0VG9wICsgJ3B4JyxcclxuXHRcdFx0XHRcdFx0Ym90dG9tOiAnYXV0bydcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0Ly8g0LIg0L7RgdGC0LDQu9GM0L3Ri9GFINGB0LvRg9GH0LDRj9GFINC30LDQutGA0LXQv9C70Y/QtdC8IHN0aWNreSDQsiDQvdC40LbQvdC10Lkg0LPRgNCw0L3QuNGG0Ysg0L7QsdC10YDRgtC60LhcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZihzdGF0ZSAhPT0gJ2JvdHRvbScpIHtcclxuXHRcdFx0XHRcdHN0YXRlID0gJ2JvdHRvbSc7XHJcblx0XHRcdFx0XHQkc3RpY2t5U2Nyb2xsZXJCbG9jay5jc3Moe1xyXG5cdFx0XHRcdFx0XHRwb3NpdGlvbjogJ2Fic29sdXRlJyxcclxuXHRcdFx0XHRcdFx0dG9wOiAnYXV0bycsXHJcblx0XHRcdFx0XHRcdGJvdHRvbTogMCxcclxuXHRcdFx0XHRcdFx0d2lkdGg6ICcxMDAlJ1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyDQstGL0YfQuNGB0LvRj9C10Lwg0YHQvNC10YnQtdC90LjQtSDQs9Cw0LvQtdGA0LXQuCDQstC+INCy0YDQtdC80Y8g0YHQutGA0L7Qu9CwXHJcblx0XHRcdHZhciBSQVRJTyA9ICgtcGFyZW50UmVjdC50b3AgKyBvZmZzZXRUb3ApIC8gKCRzdGlja3lTY3JvbGxlclBhcmVudC5oZWlnaHQoKSAtICRzdGlja3lTY3JvbGxlckJsb2NrLm91dGVySGVpZ2h0KCkpO1xyXG5cclxuXHRcdFx0UkFUSU8gPSBNYXRoLm1heCgwLCBNYXRoLm1pbihSQVRJTywgMSkpO1xyXG5cclxuXHRcdFx0dmFyIHNjcm9sbExlZnQgPSAtUkFUSU8gKiAoc3RpY2t5U2Nyb2xsZXJHYWxsZXJ5V2lkdGggLSAkc3RpY2t5U2Nyb2xsZXJHYWxsZXJ5LndpZHRoKCkpO1xyXG5cdFx0XHQkc3RpY2t5U2Nyb2xsZXJHYWxsZXJ5LmNzcyh7XHJcblx0XHRcdFx0dHJhbnNmb3JtOiAndHJhbnNsYXRlWCgnK3Njcm9sbExlZnQrJ3B4KSdcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblxyXG5cdFx0YXBwLmRvbS4kd2luZG93Lm9uKCdzY3JvbGwgcmVzaXplJywgdXBkYXRlKTtcclxuXHRcdHVwZGF0ZSgpO1xyXG5cdH1cclxufTtcclxuXHJcbmFwcC5zcGxpdHR5ID0gZnVuY3Rpb24gKCkge1xyXG5cdC8vINCg0LDQt9Cx0LjQstCw0LXQvCDQstGB0LUg0YHRgtGA0L7QutC4INGBINCw0YLRgNC40LHRg9GC0L7QvCAnZGF0YS1zcGxpdHR5JyDQvdCwINC90LXRgdC60L7Qu9GM0LrQviDRjdC70LXQvNC10L3RgtC+0LJcclxuXHQvLyDQsiDRgdC70YPRh9Cw0LUsINC10YHQu9C4INGN0LvQtdC80LXQvdGCINC90LUg0YPQvNC10YnQsNC10YLRgdGPINCyINGI0LjRgNC40L3RgyDRgNC+0LTQuNGC0LXQu9GPINC4INGC0LXQutGB0YIg0L/QtdGA0LXQvdC+0YHQuNGC0YHRjyDQvdCwINC90L7QstGD0Y4g0YHRgtGA0L7QutGDXHJcblx0JCgnW2RhdGEtc3BsaXR0eV0nKS5zcGxpdHR5KHtcclxuXHRcdHBhcnNlVGltZW91dDogMCxcclxuXHRcdHJlc2l6ZURlbGF5OiAzMDAsXHJcblx0XHRvblJlaW5pdDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdGFwcC5wYXJzZUFuaW1hdGVEZWxheWVkKCk7XHJcblx0XHR9LFxyXG5cdFx0b25Jbml0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0YXBwLmZpcnN0U3BsaXR0eUluaXQoKTtcclxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRhcHAud293KCk7XHJcblx0XHRcdH0sIDE1MDApO1xyXG5cdFx0fSxcclxuXHRcdHJlaW5pdE9uUmVzaXplOiB0cnVlXHJcblx0fSk7XHJcblx0JCgnW2RhdGEtc3BsaXR0eS10aXRsZV0nKS5zcGxpdHR5KHtcclxuXHRcdHBhcnNlVGltZW91dDogMCxcclxuXHRcdHJlc2l6ZURlbGF5OiAzMDAsXHJcblx0XHRhZGRpdGlvbmFsTmVzdGluZzogdHJ1ZSxcclxuXHRcdG9uUmVpbml0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0YXBwLnBhcnNlQW5pbWF0ZURlbGF5ZWQoKTtcclxuXHRcdH0sXHJcblx0XHRvbkluaXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRhcHAucGFyc2VBbmltYXRlRGVsYXllZCgpO1xyXG5cdFx0fSxcclxuXHRcdHJlaW5pdE9uUmVzaXplOiB0cnVlXHJcblx0fSk7XHJcbn07XHJcblxyXG5hcHAuc21vb3RoU2Nyb2xsID0gZnVuY3Rpb24gKCkge1xyXG5cdC8vINCf0LvQsNCy0L3Ri9C5INGB0LrRgNC+0LvQuyDQuiDQsdC70L7QutGDINGBINGP0LrQvtGA0LXQvFxyXG5cdHZhciAkc21vb3RoU2Nyb2xsID0gJCgnW2RhdGEtc21vb3RoLXNjcm9sbF0nKTtcclxuXHR2YXIgc2Nyb2xsU3BlZWQgPSA3MDA7XHJcblxyXG5cdCRzbW9vdGhTY3JvbGwuZWFjaChmdW5jdGlvbiAoaSwgZSkge1xyXG5cdFx0dmFyICR0aGlzID0gJCh0aGlzKTtcclxuXHRcdHZhciBnZXRJZCA9ICQoZSkuZGF0YSgnc21vb3RoLXNjcm9sbC10bycpO1xyXG5cdFx0dmFyICR0YXJnZXQgPSAkKCdbZGF0YS1zbW9vdGgtc2Nyb2xsLXRhcmdldD0nICsgZ2V0SWQgKyAnXScpO1xyXG5cclxuXHRcdCR0aGlzLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0JCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xyXG5cdFx0XHRcdHNjcm9sbFRvcDogJHRhcmdldC5vZmZzZXQoKS50b3BcclxuXHRcdFx0fSwgc2Nyb2xsU3BlZWQpO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcbn07XHJcblxyXG5hcHAuaGlnaGNoYXJ0cyA9IGZ1bmN0aW9uICgpIHtcclxuXHQvLyDQmNC90LjRhtC40LDQu9C40LfQsNGG0LjRjyDQs9GA0LDRhNC40LrQsCBIaWdoY2hhcnRzINC90LAg0YHRgtGA0LDQvdC40YbQsNGFXHJcblx0dmFyICRoaWdoY2hhcnRzID0gJCgnW2RhdGEtaGlnaGNoYXJ0c10nKTtcclxuXHJcblx0ZnVuY3Rpb24gcmVuZGVyQ2hhcnQgKGRhdGEsIGNoYXJ0KSB7XHJcblx0XHR2YXIgY3VycmVudElkID0gJChjaGFydCkuZGF0YSgnaGlnaGNoYXJ0cy1pZCcpO1xyXG5cclxuXHRcdHJldHVybiBIaWdoY2hhcnRzLmNoYXJ0KCQoJ1tkYXRhLWhpZ2hjaGFydHMtaWQ9XCInK2N1cnJlbnRJZCsnXCJdJylbMF0sIHtcclxuXHRcdFx0Y2hhcnQ6IHtcclxuXHRcdFx0XHR6b29tVHlwZTogJ3gnLFxyXG5cdFx0XHRcdGJhY2tncm91bmRDb2xvcjogbnVsbCxcclxuXHRcdFx0XHRldmVudHM6IHtcclxuXHRcdFx0XHRcdGxvYWQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgJGhpZ2hjaGFydHNUYWIgPSAkKCdbZGF0YS1oaWdoY2hhcnRzLXRhYj1cIicrY3VycmVudElkKydcIl0nKTtcclxuXHRcdFx0XHRcdFx0dmFyIGhpZ2hjaGFydHNDaGFydEluZGV4ID0gJCh0aGlzLnJlbmRlclRvKS5kYXRhKCdoaWdoY2hhcnRzLWNoYXJ0Jyk7XHJcblx0XHRcdFx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XHJcblx0XHRcdFx0XHRcdHZhciBhZGRTZXJpZXNUb0NoYXJ0ID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0X3RoaXMuc2VyaWVzWzBdLnJlbW92ZSgpO1xyXG5cdFx0XHRcdFx0XHRcdF90aGlzLmFkZFNlcmllcyh7XHJcblx0XHRcdFx0XHRcdFx0XHRkYXRhOiBkYXRhLFxyXG5cdFx0XHRcdFx0XHRcdFx0dHlwZTogJ2FyZWEnLFxyXG5cdFx0XHRcdFx0XHRcdFx0bmFtZTogJ9GA0YPQsS4nXHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdH07XHJcblxyXG5cdFx0XHRcdFx0XHRpZihoaWdoY2hhcnRzQ2hhcnRJbmRleCA9PT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdGFkZFNlcmllc1RvQ2hhcnQoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0JGhpZ2hjaGFydHNUYWIub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0YWRkU2VyaWVzVG9DaGFydCgpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0XHRcdHZhciB3YXlwb2ludElzRG9uZSA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHQkKHRoaXMucmVuZGVyVG8pLndheXBvaW50KHtcclxuXHRcdFx0XHRcdFx0XHRvZmZzZXQ6ICcxMDAlJyxcclxuXHRcdFx0XHRcdFx0XHRoYW5kbGVyOiBmdW5jdGlvbihkaXIpIHtcclxuXHRcdFx0XHRcdFx0XHQgICAgaWYgKGRpciA9PT0gJ2Rvd24nKSB7XHJcblx0XHRcdFx0XHRcdFx0ICAgIFx0aWYgKCF3YXlwb2ludElzRG9uZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhZGRTZXJpZXNUb0NoYXJ0KCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR3YXlwb2ludElzRG9uZSA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSwgMzAwKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdFx0XHQkKHRoaXMucmVuZGVyVG8pLndheXBvaW50KHtcclxuXHRcdFx0XHRcdFx0XHRvZmZzZXQ6ICctMzAlJyxcclxuXHRcdFx0XHRcdFx0XHRoYW5kbGVyOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmICghd2F5cG9pbnRJc0RvbmUpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRhZGRTZXJpZXNUb0NoYXJ0KCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0d2F5cG9pbnRJc0RvbmUgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9LCAzMDApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHR0b29sdGlwOiB7XHJcblx0XHRcdFx0YmFja2dyb3VuZENvbG9yOiAnIzMzMzMzMycsXHJcblx0XHRcdFx0Ym9yZGVyUmFkaXVzOiA0LFxyXG5cdFx0XHRcdGJvcmRlcldpZHRoOiAxLFxyXG5cdFx0XHRcdGJvcmRlckNvbG9yOiAndHJhbnNwYXJlbnQnLFxyXG5cdFx0XHRcdHBhZGRpbmc6IDAsXHJcblx0XHRcdFx0c2hhZG93OiBmYWxzZSxcclxuXHRcdFx0XHR1c2VIVE1MOiB0cnVlLFxyXG5cdFx0XHRcdGZvcm1hdHRlcjogZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0XHRcdHZhciBnZXRQcmljZSA9IHRoaXMueTtcclxuXHRcdFx0XHRcdHZhciBnZXROYW1lID0gdGhpcy5zZXJpZXMudXNlck9wdGlvbnMubmFtZTtcclxuXHRcdFx0XHRcdHZhciBnZXREYXRlID0gSGlnaGNoYXJ0cy5kYXRlRm9ybWF0KCclZC4lbS4lWSDigKIgJUg6JU0nLCB0aGlzLngpO1xyXG5cclxuXHRcdFx0XHRcdHJldHVybiAnPGRpdiBjbGFzcz1cImhpZ2hjaGFydHMtdG9vbHRpcF9fcGFyZW50XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJoaWdoY2hhcnRzLXRvb2x0aXBfX3Jvd1wiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGlnaGNoYXJ0cy10b29sdGlwX190aXRsZVwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8c3Bhbj7QodGC0L7QuNC80L7RgdGC0Yw8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGlnaGNoYXJ0cy10b29sdGlwX190ZXh0XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxzcGFuPicrZ2V0UHJpY2UrJyAnKyc8Yj4nK2dldE5hbWUrJzwvYj4nKyc8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImhpZ2hjaGFydHMtdG9vbHRpcF9fc2VwYXJhdG9yXCI+PC9kaXY+J1x0K1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGlnaGNoYXJ0cy10b29sdGlwX19yb3dcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImhpZ2hjaGFydHMtdG9vbHRpcF9fdGl0bGVcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPHNwYW4+0JTQsNC90L3Ri9C1INC90LA8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGlnaGNoYXJ0cy10b29sdGlwX190ZXh0XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxzcGFuPjxiPicrZ2V0RGF0ZSsnPC9iPjwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nO1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0c3R5bGU6IHtcclxuXHRcdFx0XHRcdGNvbG9yOiAnI2ZmZmZmZidcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdGNyZWRpdHM6IHtcclxuXHRcdFx0XHRlbmFibGVkOiBmYWxzZVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRleHBvcnRpbmc6IHtcclxuXHRcdFx0XHRlbmFibGVkOiBmYWxzZVxyXG5cdFx0XHR9LFxyXG5cdFx0XHR0aXRsZToge1xyXG5cdFx0XHRcdHRleHQ6ICcnXHJcblx0XHRcdH0sXHJcblx0XHRcdHN1YnRpdGxlOiB7XHJcblx0XHRcdFx0dGV4dDogJydcclxuXHRcdFx0fSxcclxuXHRcdFx0eEF4aXM6IHtcclxuXHRcdFx0XHR0eXBlOiAnZGF0ZXRpbWUnLFxyXG5cdFx0XHRcdGxhYmVsczoge1xyXG5cdFx0XHRcdFx0c3R5bGU6IHtcclxuXHRcdFx0XHRcdFx0Zm9udFNpemU6ICcxNXB4JyxcclxuXHRcdFx0XHRcdFx0bGluZUhlaWdodDogJzI4cHgnLFxyXG5cdFx0XHRcdFx0XHRjb2xvcjogJyM5OTk5OTknLFxyXG5cdFx0XHRcdFx0XHRmb250V2VpZ2h0OiA1MDAsXHJcblx0XHRcdFx0XHRcdGZvbnRGYW1pbHk6ICdHaWxyb3knXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRvZmZzZXQ6IDI0LFxyXG5cdFx0XHRcdGxpbmVXaWR0aDogMCxcclxuXHRcdFx0XHR0aWNrV2lkdGg6IDBcclxuXHRcdFx0fSxcclxuXHRcdFx0eUF4aXM6IHtcclxuXHRcdFx0XHR0aXRsZToge1xyXG5cdFx0XHRcdFx0dGV4dDogJydcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdG9wcG9zaXRlOiB0cnVlLFxyXG5cdFx0XHRcdGxhYmVsczoge1xyXG5cdFx0XHRcdFx0c3R5bGU6IHtcclxuXHRcdFx0XHRcdFx0Zm9udFNpemU6ICcxNXB4JyxcclxuXHRcdFx0XHRcdFx0bGluZUhlaWdodDogJzI4cHgnLFxyXG5cdFx0XHRcdFx0XHRjb2xvcjogJyM5OTk5OTknLFxyXG5cdFx0XHRcdFx0XHRmb250V2VpZ2h0OiA1MDAsXHJcblx0XHRcdFx0XHRcdGZvbnRGYW1pbHk6ICdHaWxyb3knXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRvZmZzZXQ6IDMwLFxyXG5cdFx0XHRcdGxpbmVXaWR0aDogMCxcclxuXHRcdFx0XHR0aWNrV2lkdGg6IDBcclxuXHRcdFx0fSxcclxuXHRcdFx0bGVnZW5kOiB7XHJcblx0XHRcdFx0ZW5hYmxlZDogZmFsc2VcclxuXHRcdFx0fSxcclxuXHRcdFx0cGxvdE9wdGlvbnM6IHtcclxuXHRcdFx0XHRhbmltYXRpb246IHtcclxuXHRcdFx0XHRcdGR1cmF0aW9uOiAxMDAwXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRhcmVhOiB7XHJcblx0XHRcdFx0XHRmaWxsT3BhY2l0eTogMC4xLFxyXG5cdFx0XHRcdFx0ZmlsbENvbG9yOiB7XHJcblx0XHRcdFx0XHRcdGxpbmVhckdyYWRpZW50OiB7XHJcblx0XHRcdFx0XHRcdFx0eDE6IDAsXHJcblx0XHRcdFx0XHRcdFx0eTE6IDAsXHJcblx0XHRcdFx0XHRcdFx0eDI6IDAsXHJcblx0XHRcdFx0XHRcdFx0eTI6IDFcclxuXHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0c3RvcHM6IFtcclxuXHRcdFx0XHRcdFx0XHRbMCwgJ3JnYmEoMCwgMTQyLCAyMDYsIDAuMSknXSxcclxuXHRcdFx0XHRcdFx0XHRbMSwgJ3JnYmEoMCwgMTQyLCAyMDYsIDApJ11cclxuXHRcdFx0XHRcdFx0XVxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdG1hcmtlcjoge1xyXG5cdFx0XHRcdFx0XHRyYWRpdXM6IDJcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRsaW5lV2lkdGg6IDEsXHJcblx0XHRcdFx0XHRzdGF0ZXM6IHtcclxuXHRcdFx0XHRcdFx0aG92ZXI6IHtcclxuXHRcdFx0XHRcdFx0XHRsaW5lV2lkdGg6IDFcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHRocmVzaG9sZDogbnVsbFxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0c2VyaWVzOiB7XHJcblx0XHRcdFx0XHRzdGF0ZXM6IHtcclxuXHRcdFx0XHRcdFx0aG92ZXI6IHtcclxuXHRcdFx0XHRcdFx0XHRoYWxvOiB7XHJcblx0XHRcdFx0XHRcdFx0XHRvcGFjaXR5OiAwLFxyXG5cdFx0XHRcdFx0XHRcdFx0c2l6ZTogMFxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdG1hcmtlcjoge1xyXG5cdFx0XHRcdFx0XHRlbmFibGVkOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0c3RhdGVzOiB7XHJcblx0XHRcdFx0XHRcdFx0aG92ZXI6IHtcclxuXHRcdFx0XHRcdFx0XHRcdHJhZGl1czogNixcclxuXHRcdFx0XHRcdFx0XHRcdGZpbGxDb2xvcjogJyMzRjkxQ0QnLFxyXG5cdFx0XHRcdFx0XHRcdFx0bGluZVdpZHRoUGx1czogNCxcclxuXHRcdFx0XHRcdFx0XHRcdGxpbmVDb2xvcjogJyNmZmZmZmYnXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRzZXJpZXM6IFt7XHJcblx0XHRcdFx0dHlwZTogJ2FyZWEnLFxyXG5cdFx0XHRcdG5hbWU6ICfRgNGD0LEuJyxcclxuXHRcdFx0XHRkYXRhOiBkYXRhXHJcblx0XHRcdH1dXHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdCRoaWdoY2hhcnRzLmVhY2goZnVuY3Rpb24oaSwgZSl7XHJcblx0XHRpZiAodHlwZW9mIEhpZ2hjaGFydHMgIT09ICd1bmRlZmluZWQnKSB7XHJcblx0XHRcdEhpZ2hjaGFydHMuc2V0T3B0aW9ucyh7XHJcblx0XHRcdFx0bGFuZzoge1xyXG5cdFx0XHRcdFx0bW9udGhzOiBbJ9Cv0L3QstCw0YDRjCcsICfQpNC10LLRgNCw0LvRjCcsICfQnNCw0YDRgicsICfQkNC/0YDQtdC70YwnLFxyXG5cdFx0XHRcdFx0XHQn0JzQsNC5JywgJ9CY0Y7QvdGMJywgJ9CY0Y7Qu9GMJywgJ9CQ0LLQs9GD0YHRgicsXHJcblx0XHRcdFx0XHRcdCfQodC10L3RgtGP0LHRgNGMJywgJ9Ce0LrRgtGP0LHRgNGMJywgJ9Cd0L7Rj9Cx0YDRjCcsICfQlNC10LrQsNCx0YDRjCddLFxyXG5cdFx0XHRcdFx0d2Vla2RheXM6IFsn0JLQvtGB0LrRgNC10YHQtdC90YzQtScsICfQn9C+0L3QtdC00LXQu9GM0L3QuNC6JywgJ9CS0YLQvtGA0L3QuNC6JyxcclxuXHRcdFx0XHRcdFx0J9Ch0YDQtdC00LAnLCAn0KfQtdGC0LLQtdGA0LMnLCAn0J/Rj9GC0L3QuNGG0LAnLCAn0KHRg9Cx0LHQvtGC0LAnXSxcclxuXHRcdFx0XHRcdHNob3J0TW9udGhzOiBbJ9Cv0L3QstCw0YDRjCcsICfQpNC10LLRgNCw0LvRjCcsICfQnNCw0YDRgicsICfQkNC/0YDQtdC70YwnLFxyXG5cdFx0XHRcdFx0XHQn0JzQsNC5JywgJ9CY0Y7QvdGMJywgJ9CY0Y7Qu9GMJywgJ9CQ0LLQs9GD0YHRgicsXHJcblx0XHRcdFx0XHRcdCfQodC10L3RgtGP0LHRgNGMJywgJ9Ce0LrRgtGP0LHRgNGMJywgJ9Cd0L7Rj9Cx0YDRjCcsICfQlNC10LrQsNCx0YDRjCddXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0SGlnaGNoYXJ0cy5nZXRKU09OKFxyXG5cdFx0XHRcdCdodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaGlnaGNoYXJ0cy9oaWdoY2hhcnRzQHY3LjAuMC9zYW1wbGVzL2RhdGEvdXNkZXVyLmpzb24nLFxyXG5cdFx0XHRcdGZ1bmN0aW9uIChkYXRhKSB7XHJcblx0XHRcdFx0XHRyZW5kZXJDaGFydChkYXRhLCBlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdCk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG5hcHAud293ID0gZnVuY3Rpb24gKCkge1xyXG5cdC8vINCf0LvQsNCz0LjQvSwg0LrQvtGC0L7RgNGL0Lkg0L7RgtGL0LPRgNGL0LLQsNC10YIg0LDQvdC40LzQsNGG0LjRjixcclxuXHQvLyDQv9GA0Lgg0L/QvtGP0LLQu9C10L3QuNC4INGN0LvQtdC80LXQvdGC0LAg0L3QsCDRjdC60YDQsNC90LUg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXHJcblx0bmV3IFdPVyh7XHJcblx0XHRyZXNldEFuaW1hdGlvbjogdHJ1ZSxcclxuXHRcdG9mZnNldDogYXBwLmRvbS4kd2luZG93LmhlaWdodCgpKjIwLzEwMCxcclxuXHRcdGNhbGxiYWNrOiBmdW5jdGlvbihib3gpIHtcclxuXHRcdFx0aWYgKCQoYm94KS5hdHRyKCdkYXRhLXdvdy1hbmltYXRpb24nKSAmJiAhJChib3gpLmF0dHIoJ2RhdGEtcHJvZHVjdC10aXRsZScpKSB7XHJcblx0XHRcdFx0dmFyIGFuaW1hdGlvbk5hbWUgPSAkKGJveCkuYXR0cignZGF0YS13b3ctYW5pbWF0aW9uJyk7XHJcblx0XHRcdFx0YXBwLmFuaW1hdGVDU1MoJChib3gpLCBhbmltYXRpb25OYW1lLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQoYm94KS5yZW1vdmVBdHRyKCdkYXRhLXdvdy1hbmltYXRpb24nKS5yZW1vdmVDbGFzcygnd293JykuY3NzKHtcclxuXHRcdFx0XHRcdFx0dmlzaWJpbGl0eTogJydcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0sIDMwMCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9KS5pbml0KCk7XHJcbn07XHJcblxyXG5hcHAucmV2ZWFsQmxvY2tPblJlc2V0ID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciAkYm94ID0gJCgnW2RhdGEtcHJvZHVjdC13cmFwcGVyXScpO1xyXG5cdCRib3gud2F5cG9pbnQoe1xyXG5cdFx0aGFuZGxlcjogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHQkKCdbZGF0YS1wcm9kdWN0LXNsaWRlXSwgW2RhdGEtcHJvZHVjdC10aXRsZV0sIFtkYXRhLXByb2R1Y3QtYnV0dG9uXScpLmVhY2goZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdHZhciAkdGhpcyA9ICQodGhpcyk7XHJcblx0XHRcdFx0dmFyIG5hbWUgPSAkdGhpcy5hdHRyKCdkYXRhLXdvdy1hbmltYXRpb24nKTtcclxuXHRcdFx0XHR2YXIgZGVsYXkgPSAkdGhpcy5hdHRyKCdkYXRhLXdvdy1kZWxheScpO1xyXG5cclxuXHRcdFx0XHRpZiAoYXBwLmlzSUUoKSkge1xyXG5cdFx0XHRcdFx0JHRoaXMuY3NzKHtcclxuXHRcdFx0XHRcdFx0J2FuaW1hdGlvbi1kZWxheSc6IGRlbGF5XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGFwcC5hbmltYXRlQ1NTKCR0aGlzLCBuYW1lLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdFbGVtZW50OicsICR0aGlzKTtcclxuXHRcdFx0XHRcdCR0aGlzLnJlbW92ZUF0dHIoJ2RhdGEtd293LWFuaW1hdGlvbicpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5jc3Moe1xyXG5cdFx0XHRcdFx0XHR2aXNpYmlsaXR5OiAnJ1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSwgMzAwKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9LFxyXG5cdFx0b2Zmc2V0OiAnNTAlJ1xyXG5cdH0pO1xyXG59O1xyXG5cclxuYXBwLm9wZW5Qb3B1cCA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgJHBvcHVwID0gJCgnW2RhdGEtb3Blbi1wb3B1cF0nKTtcclxuXHQkcG9wdXAubWFnbmlmaWNQb3B1cCh7XHJcblx0XHR0eXBlOiAnaW5saW5lJyxcclxuXHRcdG1pZENsaWNrOiB0cnVlLFxyXG5cdFx0Ly8gRGVsYXkgaW4gbWlsbGlzZWNvbmRzIGJlZm9yZSBwb3B1cCBpcyByZW1vdmVkXHJcblx0XHRyZW1vdmFsRGVsYXk6IDMwMCxcclxuXHRcdC8vIENsYXNzIHRoYXQgaXMgYWRkZWQgdG8gcG9wdXAgd3JhcHBlciBhbmQgYmFja2dyb3VuZFxyXG5cdFx0Ly8gbWFrZSBpdCB1bmlxdWUgdG8gYXBwbHkgeW91ciBDU1MgYW5pbWF0aW9ucyBqdXN0IHRvIHRoaXMgZXhhY3QgcG9wdXBcclxuXHRcdG1haW5DbGFzczogJ21mcC1mYWRlJ1xyXG5cdH0pO1xyXG5cdC8vIGRldiBtb2RlXHJcblx0Ly8gJHBvcHVwLmNsaWNrKCk7XHJcbn07XHJcblxyXG5hcHAubWVudSA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgJG1lbnUgPSAkKCdbZGF0YS1tZW51XScpO1xyXG5cdHZhciAkbWVudUJ1dHRvbiA9ICQoJ1tkYXRhLW1lbnUtYnV0dG9uXScpO1xyXG5cdHZhciAkbWVudUNsb3NlID0gJCgnW2RhdGEtbWVudS1jbG9zZV0nKTtcclxuXHR2YXIgJG1lbnVTdWJuYXYgPSAkKCdbZGF0YS1tZW51LXN1Ym5hdl0nKTtcclxuXHR2YXIgJG1lbnVOYXYgPSAkKCdbZGF0YS1tZW51LW5hdl0nKTtcclxuXHJcblx0dmFyIGFjdGl2ZUNsYXNzID0gJ19hY3RpdmUnO1xyXG5cdHZhciBtZW51T3BlbiA9IGZhbHNlO1xyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJNZW51ICgpIHtcclxuXHRcdHZhciBlbGVtZW50cyA9IFtcclxuXHRcdFx0e1xyXG5cdFx0XHRcdCRlbGVtZW50OiAkKCdbZGF0YS1hbmltYXRlLWRlbGF5ZWQtdGFyZ2V0PVwibWVudUhlYWRlclwiXScpLFxyXG5cdFx0XHRcdGRlbGF5OiAwLjU1XHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHQkZWxlbWVudDogJCgnW2RhdGEtYW5pbWF0ZS1kZWxheWVkLXRhcmdldD1cIm1lbnVTZXBhcmF0b3JcIl0nKSxcclxuXHRcdFx0XHRkZWxheTogMC41NVxyXG5cdFx0XHR9LFxyXG5cdFx0XTtcclxuXHJcblx0XHRzZXREZWxheU9uTmF2KCdtZW51TmF2TGluaycsIDIpO1xyXG5cdFx0c2V0RGVsYXlPbk5hdignbWVudUJvdHRvbU5hdkxpbmsnLCAzKTtcclxuXHJcblx0XHRmb3IgKHZhciBpPTA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRhcHAuYWRkU3BsaXR0eURlbGF5KGVsZW1lbnRzW2ldLiRlbGVtZW50LCBlbGVtZW50c1tpXS5kZWxheSwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0YXBwLnBhcnNlQW5pbWF0ZURlbGF5ZWQoZWxlbWVudHNbaV0uJGVsZW1lbnQpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGNsb3NlTWVudSAoKSB7XHJcblx0XHQkKCdbZGF0YS1tZW51LWFuaW1hdGVdJykuY3NzKHsnYW5pbWF0aW9uLWRlbGF5JzogJyd9KTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGNsZWFyU3R5bGVzQW5kU3RhdGVzICgpIHtcclxuXHRcdCRtZW51TmF2LnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxuXHRcdCRtZW51U3VibmF2LnN0b3AoKS5oaWRlKCk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZXN0YXJ0QW5pbWF0aW9uIChkaXJlY3Rpb24pIHtcclxuXHRcdGlmIChkaXJlY3Rpb24gPT09IHVuZGVmaW5lZCB8fCAhZGlyZWN0aW9uKSB7XHJcblx0XHRcdGRpcmVjdGlvbiA9ICdpbic7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyICRtZW51QW5pbWF0ZSA9ICQoJ1tkYXRhLW1lbnUtYW5pbWF0ZV0nKTtcclxuXHJcblx0XHQkbWVudUFuaW1hdGUuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyICR0aGlzID0gJCh0aGlzKTtcclxuXHRcdFx0dmFyICRtZW51QW5pbWF0ZUluID0gJHRoaXMuZGF0YSgnbWVudS1hbmltYXRlLWluJykgfHwgJ2ZhZGVJbic7XHJcblx0XHRcdHZhciAkbWVudUFuaW1hdGVPdXQgPSAkdGhpcy5kYXRhKCdtZW51LWFuaW1hdGUtb3V0JykgfHwgJ2ZhZGVPdXQnO1xyXG5cclxuXHRcdFx0aWYgKCEkdGhpcy5oYXNDbGFzcygnYW5pbWF0ZWQnKSl7XHJcblx0XHRcdFx0JHRoaXMuYWRkQ2xhc3MoJ2FuaW1hdGVkJyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmIChkaXJlY3Rpb24gPT09ICdpbicpIHtcclxuXHRcdFx0XHQkdGhpcy5yZW1vdmVDbGFzcygkbWVudUFuaW1hdGVPdXQpO1xyXG5cdFx0XHRcdCR0aGlzLnJlbW92ZUNsYXNzKCRtZW51QW5pbWF0ZUluKTtcclxuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JHRoaXMuYWRkQ2xhc3MoJG1lbnVBbmltYXRlSW4pO1xyXG5cdFx0XHRcdH0sIDApO1xyXG5cdFx0XHR9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ291dCcpIHtcclxuXHRcdFx0XHQkdGhpcy5yZW1vdmVDbGFzcygkbWVudUFuaW1hdGVJbik7XHJcblx0XHRcdFx0JHRoaXMucmVtb3ZlQ2xhc3MoJG1lbnVBbmltYXRlT3V0KTtcclxuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JHRoaXMuYWRkQ2xhc3MoJG1lbnVBbmltYXRlT3V0KTtcclxuXHRcdFx0XHR9LCAwKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXREZWxheU9uTmF2IChkZWxheWVkVGFyZ2V0TmFtZSwgZGVsYXkpIHtcclxuXHRcdHZhciBkZWZhdWx0TWVudU5hdkxpbmtEZWxheSA9IDAuNCB8fCBkZWxheTtcclxuXHJcblx0XHQkKCdbZGF0YS1hbmltYXRlLWRlbGF5ZWQtdGFyZ2V0PVwiJytkZWxheWVkVGFyZ2V0TmFtZSsnXCJdJykuZWFjaChmdW5jdGlvbihpbmRleCkge1xyXG5cdFx0XHR2YXIgJHRoaXMgPSAkKHRoaXMpO1xyXG5cdFx0XHR2YXIgJGNoaWxkcmVuID0gJHRoaXMuY2hpbGRyZW4oJ3AsIHNwYW4nKTtcclxuXHJcblx0XHRcdCRjaGlsZHJlbi5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdCQodGhpcykuY3NzKHtcclxuXHRcdFx0XHRcdCdhbmltYXRpb24tZGVsYXknOiAoZGVmYXVsdE1lbnVOYXZMaW5rRGVsYXkgKyAoaW5kZXggKiAwLjA4KSkgKyAncydcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0fVxyXG5cdGZ1bmN0aW9uIG1lbnVTdWJuYXZJdGVtc0RlbGF5IChkZWxheSl7XHJcblx0XHR2YXIgZGVmYXVsTWVudVN1Ym5hdkl0ZW1zRGVsYXkgPSBkZWxheSA/ICAwLjcgOiAwO1xyXG5cdFx0JG1lbnVTdWJuYXYuZWFjaChmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHZhciAkdGhpcyA9ICQodGhpcyk7XHJcblx0XHRcdHZhciAkY2hpbGRyZW4gPSAkdGhpcy5maW5kKCdwLCBzcGFuJyk7XHJcblxyXG5cdFx0XHQkY2hpbGRyZW4uZWFjaChmdW5jdGlvbihpbmRleCkge1xyXG5cdFx0XHRcdCQodGhpcykuY3NzKHtcclxuXHRcdFx0XHRcdCdhbmltYXRpb24tZGVsYXknOiAoZGVmYXVsTWVudVN1Ym5hdkl0ZW1zRGVsYXkgKyAoaW5kZXggKiAwLjA1KSkgKyAncydcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdCRtZW51QnV0dG9uLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0bWVudVN1Ym5hdkl0ZW1zRGVsYXkodHJ1ZSk7XHJcblx0XHQkKCdbZGF0YS1tZW51LXN1Ym5hdl0nKS5oaWRlKDApO1xyXG5cdFx0cmVzdGFydEFuaW1hdGlvbignaW4nKTtcclxuXHJcblx0XHRhcHAuYW5pbWF0ZUNTUygkbWVudSwgJ3NsaWRlSW5SaWdodE1lbnUnLCBudWxsLCBudWxsLCAnc2xpZGVPdXRSaWdodE1lbnUnKTtcclxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdCRtZW51LmFkZENsYXNzKGFjdGl2ZUNsYXNzKTtcclxuXHRcdH0sIDcwMCk7XHJcblxyXG5cdFx0cmVuZGVyTWVudSgpO1xyXG5cdFx0JG1lbnVOYXYuZmlyc3QoKS50cmlnZ2VyKCdtb3VzZWVudGVyRW11bGF0ZScpO1xyXG5cclxuXHR9KTtcclxuXHJcblx0JG1lbnVDbG9zZS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuXHRcdG1lbnVPcGVuID0gZmFsc2U7XHJcblx0XHQkbWVudS5hZGRDbGFzcygnX2Nsb3NlJyk7XHJcblx0XHRjbG9zZU1lbnUoKTtcclxuXHRcdGFwcC5hbmltYXRlQ1NTKCRtZW51LCAnc2xpZGVPdXRSaWdodE1lbnUnLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0JG1lbnUucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG5cdFx0fSwgbnVsbCwgJ3NsaWRlSW5SaWdodE1lbnUnKTtcclxuXHRcdGNsZWFyU3R5bGVzQW5kU3RhdGVzKCk7XHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkbWVudVN1Ym5hdi5zdG9wKCkuc2hvdygwKTtcclxuXHRcdFx0JG1lbnUucmVtb3ZlQ2xhc3MoJ19jbG9zZScpO1xyXG5cdFx0fSwgNjAwKTtcclxuXHR9KTtcclxuXHJcblx0JG1lbnVOYXYub24oJ21vdXNlZW50ZXIgbW91c2VlbnRlckVtdWxhdGUnLCBmdW5jdGlvbigpIHtcclxuXHRcdHZhciAkdGhpcyA9ICQodGhpcyk7XHJcblx0XHRpZigkdGhpcy5oYXNDbGFzcygnX2FjdGl2ZScpKXtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0aWYgKG1lbnVPcGVuKXtcclxuICAgIFx0XHRtZW51U3VibmF2SXRlbXNEZWxheSgpO1xyXG5cdFx0fVxyXG5cdFx0bWVudU9wZW4gPSB0cnVlO1xyXG5cdFx0dmFyICRtZW51TmF2QWN0aXZlID0gJG1lbnVOYXYuZmlsdGVyKCcuX2FjdGl2ZScpO1xyXG5cdFx0dmFyICRzdWJuYXZBY3RpdmUgPSAkKCdbZGF0YS1tZW51LXN1Ym5hdj1cIicrJG1lbnVOYXZBY3RpdmUuZGF0YSgnbWVudS1uYXYnKSsnXCJdJyk7XHJcblx0XHR2YXIgZ2V0SWQgPSAkdGhpcy5kYXRhKCdtZW51LW5hdicpO1xyXG5cdFx0dmFyICRnZXRTdWJuYXYgPSAkKCdbZGF0YS1tZW51LXN1Ym5hdj1cIicrZ2V0SWQrJ1wiXScpO1xyXG5cdFx0aWYoJHN1Ym5hdkFjdGl2ZS5sZW5ndGgpe1xyXG5cdFx0XHQkc3VibmF2QWN0aXZlLmFkZENsYXNzKCdfY2xvc2UnKTtcclxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0JHN1Ym5hdkFjdGl2ZS5yZW1vdmVDbGFzcygnX2Nsb3NlJyk7XHJcblxyXG5cdFx0XHRcdGNsZWFyU3R5bGVzQW5kU3RhdGVzKCk7XHJcblx0XHRcdFx0JHRoaXMuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG5cdFx0XHRcdCRnZXRTdWJuYXYuc3RvcCgpLmFkZENsYXNzKCdfYWN0aXZlJykuc2hvdygpO1xyXG5cdFx0XHR9LDYwMCk7XHJcblx0XHR9ZWxzZSBpZigkZ2V0U3VibmF2Lmxlbmd0aCl7XHJcblx0XHRcdGNsZWFyU3R5bGVzQW5kU3RhdGVzKCk7XHJcblx0XHRcdCRnZXRTdWJuYXYuc3RvcCgpLmFkZENsYXNzKCdfYWN0aXZlJykuc2hvdygpO1xyXG5cdFx0XHQkdGhpcy5hZGRDbGFzcyhhY3RpdmVDbGFzcyk7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0Y2xlYXJTdHlsZXNBbmRTdGF0ZXMoKTtcclxuXHRcdFx0JHRoaXMuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuYXBwLmZhZGUgPSBmdW5jdGlvbiAoKSB7XHJcblx0Ly8g0J/QvtGP0LLQu9GP0Y7RidC40LXRgdGPINC/0YDQuCDQutC70LjQutC1INC90LAg0LrQvdC+0L/QutGDINGB0LrRgNGL0YLRi9C1INCx0LvQvtC60LhcclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uICgpe1xyXG5cdFx0dmFyICRmYWRlRWxlbWVudHMgPSAkKCdbZGF0YS1mYWRlLWJsb2NrXSwgW2RhdGEtZmFkZS1sYXlvdXRdJyk7XHJcblxyXG5cdFx0JGZhZGVFbGVtZW50cy5lYWNoKGZ1bmN0aW9uKGksIGUpIHtcclxuXHRcdFx0aWYgKCQoZSkuZGF0YSgnbWVudScpKSB7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgZGF0YUF0dHJzID0gWydmYWRlLWluLWVmZmVjdCcsICdmYWRlLXNwZWVkJ107XHJcblxyXG5cdFx0XHQkKGRhdGFBdHRycykuZWFjaChmdW5jdGlvbihkYXRhSW5kZXgsIGRhdGFFbGVtKSB7XHJcblx0XHRcdFx0aWYoJChlKS5kYXRhKGRhdGFFbGVtKSl7XHJcblx0XHRcdFx0XHQkKGUpLmFkZENsYXNzKCAkKGUpLmRhdGEoZGF0YUVsZW0pKycgJyApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cdGluaXQoKTtcclxuXHJcblx0Ly8g0JfQsNC/0YPRgdC6INCw0L3QuNC80LDRhtC40Lgg0L3QsCDRjdC70LXQvNC10L3RgtCw0YUg0YEg0LDRgtGA0LjQsdGD0YLQvtC8ICdkYXRhLWZhZGUtYW5pbWF0ZSdcclxuXHQvLyDRgdC+INGB0YLQsNC90LTQsNGA0YLQvdGL0LzQuCDRgdCy0L7QudGB0YLQstCw0LzQuFxyXG5cdHZhciBhZGRDbGFzc1RvQW5pbWF0ZWRCbG9ja3MgPSBmdW5jdGlvbiAoaW5zdCkge1xyXG5cdFx0dmFyICRmYWRlQW5pbWF0ZSA9ICQoaW5zdCkuZmluZCgnW2RhdGEtZmFkZS1hbmltYXRlXScpO1xyXG5cdFx0aWYgKCEkZmFkZUFuaW1hdGUuaGFzQ2xhc3MoJ2FuaW1hdGVkJykpIHtcclxuXHRcdFx0JGZhZGVBbmltYXRlLmFkZENsYXNzKCdhbmltYXRlZCcpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8vINCe0LHRgNCw0LHQvtGC0LrQsCDQstGB0LXRhSDQutC90L7Qv9C+0LosINC/0YDQuCDQutC70LjQutC1INC90LAg0LrQvtGC0L7RgNGL0LUg0L/QvtGP0LLQu9GP0Y7RgtGB0Y8g0YHQstGP0LfQsNC90L3Ri9C1INGBINC90LjQvNC4INCx0LvQvtC60LhcclxuXHR2YXIgJGZhZGVCdXR0b24gPSAkKCdbZGF0YS1mYWRlLWJ1dHRvbl0nKTtcclxuXHQkZmFkZUJ1dHRvbi5lYWNoKGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciAkdGhpcyA9ICQodGhpcyk7XHJcblxyXG5cdFx0JHRoaXMub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuXHRcdFx0dmFyICRmYWRlTmFtZSA9ICR0aGlzLmRhdGEoJ2ZhZGUtYnV0dG9uJyk7XHJcblx0XHRcdHZhciAkZmFkZUJsb2NrID0gJCgnW2RhdGEtZmFkZS1ibG9jaz1cIicgKyAkZmFkZU5hbWUgKyAnXCJdJyksXHJcblx0XHRcdFx0JGZhZGVCbG9ja0luRWZmZWN0ID0gJGZhZGVCbG9jay5kYXRhKCdmYWRlLWluLWVmZmVjdCcpIHx8ICdzbGlkZUluUmlnaHQnLFxyXG5cdFx0XHRcdCRmYWRlQmxvY2tPdXRFZmZlY3QgPSAkZmFkZUJsb2NrLmRhdGEoJ2ZhZGUtb3V0LWVmZmVjdCcpIHx8ICdzbGlkZU91dFJpZ2h0JztcclxuXHRcdFx0dmFyICRmYWRlQ2xvc2UgPSAkKCdbZGF0YS1mYWRlLWNsb3NlPVwiJyArICRmYWRlTmFtZSArICdcIl0nKTtcclxuXHRcdFx0dmFyICRmYWRlTGF5b3V0ID0gJCgnW2RhdGEtZmFkZS1sYXlvdXQ9XCInICsgJGZhZGVOYW1lICsgJ1wiXScpLFxyXG5cdFx0XHRcdCRmYWRlTGF5b3V0SW5FZmZlY3QgPSAkZmFkZUxheW91dC5kYXRhKCdmYWRlLWluLWVmZmVjdCcpIHx8ICdmYWRlSW4nLFxyXG5cdFx0XHRcdCRmYWRlTGF5b3V0T3V0RWZmZWN0ID0gJGZhZGVMYXlvdXQuZGF0YSgnZmFkZS1vdXQtZWZmZWN0JykgfHwgJ2ZhZGVPdXQnO1xyXG5cclxuXHRcdFx0dmFyIHRvZ2dsZUJvZHlPdmVyZmxvdyA9IGZ1bmN0aW9uIChwYXIpIHtcclxuXHRcdFx0XHR2YXIgJGJvZHkgPSAkKCdib2R5Jyk7XHJcblxyXG5cdFx0XHRcdGlmIChwYXIpIHtcclxuXHRcdFx0XHRcdCRib2R5LmNzcygnb3ZlcmZsb3cnLCBwYXIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRpZiAoJGJvZHkuY3NzKCdvdmVyZmxvdycpID09PSAnaGlkZGVuJykge1xyXG5cdFx0XHRcdFx0XHQkYm9keS5jc3Moe1xyXG5cdFx0XHRcdFx0XHRcdG92ZXJmbG93OiAndmlzaWJsZSdcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQkYm9keS5jc3Moe1xyXG5cdFx0XHRcdFx0XHRcdG92ZXJmbG93OiAnaGlkZGVuJ1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHQkZmFkZUJsb2NrLnN0b3AoKS5zaG93KDAsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHZhciBhbmltYXRpb25EdXJhdGlvbiA9IDEwMDA7XHJcblxyXG5cdFx0XHRcdC8vLSBzdGFydCBJRTExIGFuaW1hdGlvbiBoYWNrXHJcblx0XHRcdFx0JGZhZGVCbG9jay5oaWRlKDApLnJlbW92ZUNsYXNzKCRmYWRlQmxvY2tJbkVmZmVjdCk7XHJcblx0XHRcdFx0Ly8tIGVuZFxyXG5cdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLy0gc3RhcnQgSUUxMSBhbmltYXRpb24gaGFja1xyXG5cdFx0XHRcdFx0JGZhZGVCbG9jay5zaG93KDApLmFkZENsYXNzKCRmYWRlQmxvY2tJbkVmZmVjdCk7XHJcblx0XHRcdFx0XHQvLy0gZW5kXHJcblx0XHRcdFx0fSwgMCk7XHJcblxyXG5cdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRhZGRDbGFzc1RvQW5pbWF0ZWRCbG9ja3MoJGZhZGVCbG9jayk7XHJcblxyXG5cdFx0XHRcdFx0dG9nZ2xlQm9keU92ZXJmbG93KCk7XHJcblx0XHRcdFx0fSwgYW5pbWF0aW9uRHVyYXRpb24pO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdCRmYWRlTGF5b3V0LnN0b3AoKS5zaG93KCk7XHJcblxyXG5cdFx0XHQkZmFkZUxheW91dC5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0JGZhZGVDbG9zZS50cmlnZ2VyKCdjbGljaycpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdCRmYWRlQ2xvc2Uub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdFx0XHRcdCRmYWRlTGF5b3V0LnJlbW92ZUNsYXNzKCRmYWRlTGF5b3V0SW5FZmZlY3QpLmFkZENsYXNzKCRmYWRlTGF5b3V0T3V0RWZmZWN0KTtcclxuXHRcdFx0XHQkZmFkZUJsb2NrLnJlbW92ZUNsYXNzKCRmYWRlQmxvY2tJbkVmZmVjdCkuYWRkQ2xhc3MoJGZhZGVCbG9ja091dEVmZmVjdCk7XHJcblxyXG5cdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0dG9nZ2xlQm9keU92ZXJmbG93KCd2aXNpYmxlJyk7XHJcblx0XHRcdFx0XHQkZmFkZUJsb2NrLnN0b3AoKS5oaWRlKCkucmVtb3ZlQ2xhc3MoJGZhZGVCbG9ja091dEVmZmVjdCkuYWRkQ2xhc3MoJGZhZGVCbG9ja0luRWZmZWN0KTtcclxuXHRcdFx0XHRcdCRmYWRlTGF5b3V0LnN0b3AoKS5oaWRlKCkucmVtb3ZlQ2xhc3MoJGZhZGVMYXlvdXRPdXRFZmZlY3QpLmFkZENsYXNzKCRmYWRlTGF5b3V0SW5FZmZlY3QpO1xyXG5cdFx0XHRcdH0sIDEwMDApO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuYXBwLmNvbGxhcHNlID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciAkY29sbGFwc2UgPSAkKCdbZGF0YS1jb2xsYXBzZV0nKTtcclxuXHJcblx0JGNvbGxhcHNlLmVhY2goZnVuY3Rpb24gKGksIGUpIHtcclxuXHRcdHZhciAkdGhpcyA9ICQoZSk7XHJcblx0XHR2YXIgJHRvcCA9ICR0aGlzLmZpbmQoJ1tkYXRhLWNvbGxhcHNlLXRvcF0nKTtcclxuXHRcdHZhciAkY29udGVudCA9ICR0aGlzLmZpbmQoJ1tkYXRhLWNvbGxhcHNlLWNvbnRlbnRdJyk7XHJcblx0XHR2YXIgJGljb24gPSAkdGhpcy5maW5kKCdbZGF0YS1jb2xsYXBzZS1pY29uXScpO1xyXG5cdFx0dmFyIGFjdGl2ZUNsYXNzID0gJ19hY3RpdmUnO1xyXG5cdFx0dmFyIHRyYW5zaXRpb25TcGVlZCA9IDMwMDtcclxuXHJcblx0XHQkdG9wLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0aWYgKCR0aGlzLmhhc0NsYXNzKGFjdGl2ZUNsYXNzKSkge1xyXG5cdFx0XHRcdCRpY29uLnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxuXHRcdFx0XHQkY29udGVudC5zdG9wKCkuc2xpZGVVcCh0cmFuc2l0aW9uU3BlZWQsIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdCR0aGlzLnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkaWNvbi5hZGRDbGFzcyhhY3RpdmVDbGFzcyk7XHJcblx0XHRcdFx0JGNvbnRlbnQuc3RvcCgpLnNsaWRlRG93bih0cmFuc2l0aW9uU3BlZWQsIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdCR0aGlzLmFkZENsYXNzKGFjdGl2ZUNsYXNzKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSk7XHJcbn07XHJcblxyXG5hcHAudGFicyA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgJHRhYnMgPSAkKCdbZGF0YS10YWJzXScpO1xyXG5cclxuXHQkdGFicy5lYWNoKGZ1bmN0aW9uIChpLCBlKSB7XHJcblx0XHR2YXIgJHRoaXMgPSAkKGUpO1xyXG5cdFx0dmFyICR0YWJFbGVtZW50cyA9ICR0aGlzLmZpbmQoJ1tkYXRhLXRhYi1pZF0nKTtcclxuXHRcdHZhciBhY3RpdmVDbGFzcyA9ICdfYWN0aXZlJztcclxuXHJcblx0XHQkdGFiRWxlbWVudHMuZWFjaChmdW5jdGlvbiAodGFiSW5kZXgsIHRhYkVsZW1lbnQpIHtcclxuXHRcdFx0dmFyICRnZXRUYWJQYXJlbnQgPSAkKHRhYkVsZW1lbnQpLnBhcmVudHMoJ1tkYXRhLXRhYnNdJykuZXEoMCk7XHJcblxyXG5cdFx0XHRpZiAoJHRoaXMuaXMoJGdldFRhYlBhcmVudCkpIHtcclxuXHRcdFx0XHR2YXIgJGN1cnJlbnQgPSAkKHRhYkVsZW1lbnQpO1xyXG5cdFx0XHRcdHZhciAkY3VycmVudFBhcmVudCA9ICRjdXJyZW50LmNsb3Nlc3QoJ1tkYXRhLXRhYnNdJyk7XHJcblx0XHRcdFx0dmFyICRjdXJyZW50VGFicyA9ICRjdXJyZW50UGFyZW50LmZpbmQoJ1tkYXRhLXRhYi1pZF0nKTtcclxuXHRcdFx0XHR2YXIgJGN1cnJlbnRCbG9ja3MgPSAkY3VycmVudFBhcmVudC5maW5kKCdbZGF0YS10YWItYmxvY2tdJyk7XHJcblxyXG5cdFx0XHRcdHZhciBhY3RpdmVDbGFzc1JlbW92ZXIgPSBmdW5jdGlvbiAoaTIsIGUyKSB7XHJcblx0XHRcdFx0XHRpZiAoJChlMikuY2xvc2VzdCgnW2RhdGEtdGFic10nKS5pcygkY3VycmVudFBhcmVudCkpIHtcclxuXHRcdFx0XHRcdFx0JChlMikucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH07XHJcblxyXG5cdFx0XHRcdCRjdXJyZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHQgICAgdmFyIGN1cnJlbnRJZCA9ICQodGhpcykuZGF0YSgndGFiLWlkJyk7XHJcblxyXG5cdFx0XHRcdFx0JGN1cnJlbnRUYWJzLmVhY2goYWN0aXZlQ2xhc3NSZW1vdmVyKTtcclxuXHRcdFx0XHRcdCRjdXJyZW50QmxvY2tzLmVhY2goYWN0aXZlQ2xhc3NSZW1vdmVyKTtcclxuXHJcblx0XHRcdFx0XHQkY3VycmVudFBhcmVudC5maW5kKCdbZGF0YS10YWItYmxvY2s9XCInK2N1cnJlbnRJZCsnXCJdJykuZXEoMCkuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG5cdFx0XHRcdFx0JGN1cnJlbnQuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9KTtcclxufTtcclxuXHJcblxyXG5hcHAuY29va2llTGF5b3V0ID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciAkY29va2llID0gJCgnW2RhdGEtY29va2llXScpO1xyXG5cdHZhciAkY2xvc2UgPSAkY29va2llLmZpbmQoJ1tkYXRhLWNvb2tpZS1jbG9zZV0nKTtcclxuXHJcblx0JGNsb3NlLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuXHRcdCRjb29raWUucmVtb3ZlKCk7XHJcblx0fSk7XHJcbn07XHJcblxyXG5hcHAuY2hvc2VuID0gZnVuY3Rpb24gKCkge1xyXG5cdCQoJ1tkYXRhLWNob3Nlbi1zZWxlY3RdJykuY2hvc2VuKHtkaXNhYmxlX3NlYXJjaDogdHJ1ZSwgd2lkdGg6ICcxMDAlJ30pO1xyXG5cdCQoJ1tkYXRhLWNob3Nlbi1zZWxlY3QtY29udGVudC1maXRdJykuY2hvc2VuKHtkaXNhYmxlX3NlYXJjaDogdHJ1ZSwgd2lkdGg6ICdjYWxjKDEwMCUgKyAxNXB4KSd9KTtcclxufTtcclxuXHJcbmFwcC5sYW5nID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciAkY2hvc2VuID0gJCgnW2RhdGEtY2hvc2VuLXNlbGVjdC1sYW5nXScpO1xyXG5cdHZhciAkbGFuZyA9ICQoJ1tkYXRhLWxhbmddJyk7XHJcblx0dmFyICRzaW5nbGUgPSAkKCdhLmNob3Nlbi1zaW5nbGUnKTtcclxuXHJcblx0JGNob3Nlbi5vbignY2hhbmdlJywgZnVuY3Rpb24oZXZ0KSB7XHJcblx0XHQkbGFuZy5yZW1vdmVDbGFzcygnaGVhZGVyX19sYW5ndWFnZS0tZGVmYXVsdCcpO1xyXG5cdFx0JGxhbmcucmVtb3ZlQ2xhc3MoJ2hlYWRlcl9fbGFuZ3VhZ2UtLWRlZmF1bHQtZGFyaycpO1xyXG5cdH0pO1xyXG5cclxuXHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24gKGV2dCkge1xyXG5cdFx0aWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaG9zZW4tc2luZ2xlJykpIHtcclxuXHRcdFx0JGxhbmcucmVtb3ZlQ2xhc3MoJ2hlYWRlcl9fbGFuZ3VhZ2UtLWRlZmF1bHQnKTtcclxuXHRcdFx0JGxhbmcucmVtb3ZlQ2xhc3MoJ2hlYWRlcl9fbGFuZ3VhZ2UtLWRlZmF1bHQtZGFyaycpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHQkY2hvc2VuLnZhbCgnJyk7XHJcblxyXG5cdCRjaG9zZW4uY2hvc2VuKHtkaXNhYmxlX3NlYXJjaDogdHJ1ZSwgd2lkdGg6ICcxMDAlJywgcGxhY2Vob2xkZXJfdGV4dF9zaW5nbGU6ICdMQU4nfSk7XHJcbn07XHJcblxyXG5hcHAuZ2VvTWFwID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciAkcGlucyA9ICQoJ1tkYXRhLWdlby1tYXAtcGluXScpO1xyXG5cdHZhciAkY291bnRyaWVzID0gJCgnLmNvdW50cnlfX3dpdGgtZW50ZXJwcmlzZScpO1xyXG5cclxuXHR2YXIgdmlzaWJsZUNsYXNzID0gJ192aXNpYmxlJztcclxuXHR2YXIgYWN0aXZlQ2xhc3MgPSAnX2FjdGl2ZSc7XHJcblxyXG5cdGlmICgkY291bnRyaWVzLmxlbmd0aCA+IDApIHtcclxuXHRcdGZ1bmN0aW9uIGdldENvdW50cnlOb2RlIChjb3VudHJ5TmFtZSkge1xyXG5cdFx0XHRpZiAoY291bnRyeU5hbWUpIHtcclxuXHRcdFx0XHR2YXIgdGFyZ2V0Q291bnRyeU5vZGUgPSBudWxsO1xyXG5cclxuXHRcdFx0XHRjb3VudHJ5TmFtZSA9IGNvdW50cnlOYW1lLnRvTG93ZXJDYXNlKCk7XHJcblx0XHRcdFx0Y291bnRyeU5hbWUgPSBjb3VudHJ5TmFtZVswXS50b1VwcGVyQ2FzZSgpICsgY291bnRyeU5hbWUuc2xpY2UoMSk7XHJcblxyXG5cdFx0XHRcdHZhciAkY291bnRyeVBhdGggPSAkKCdbZGF0YS1tYXAtY291bnRyeT1cIicrY291bnRyeU5hbWUrJ1wiXScpO1xyXG5cclxuXHRcdFx0XHRpZiAoJGNvdW50cnlQYXRoLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdHRhcmdldENvdW50cnlOb2RlID0gJGNvdW50cnlQYXRoO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0cmV0dXJuIHRhcmdldENvdW50cnlOb2RlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0ZnVuY3Rpb24gaGlkZUFsbENhcmRzICgpIHtcclxuXHRcdFx0JCgnW2RhdGEtZ2VvLWNhcmRdJykucmVtb3ZlQ2xhc3ModmlzaWJsZUNsYXNzKTtcclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiBjbGVhckFsbFBhdGhzICgpIHtcclxuXHRcdFx0JCgnW2RhdGEtbWFwLWNvdW50cnldJykucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG5cdFx0fVxyXG5cclxuXHRcdCRwaW5zLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciAkcGluID0gJCh0aGlzKTtcclxuXHJcblx0XHRcdCRwaW4ub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHZhciAkdGhpcyA9ICQodGhpcyk7XHJcblx0XHRcdFx0JHRoaXMuYWRkQ2xhc3MoJ192aXNpYmxlJyk7XHJcblxyXG5cdFx0XHRcdHZhciBjb3VudHJ5ID0gJHBpbi5hdHRyKCdkYXRhLWNvdW50cnknKTtcclxuXHRcdFx0XHR2YXIgJGNvdW50cnlQYXRoID0gZ2V0Q291bnRyeU5vZGUoY291bnRyeSk7XHJcblx0XHRcdFx0JGNvdW50cnlQYXRoLmFkZENsYXNzKCdfYWN0aXZlJyk7XHJcblxyXG5cdFx0XHRcdGhpZGVBbGxDYXJkcygpO1xyXG5cclxuXHRcdFx0XHR2YXIgJGNhcmQgPSAkdGhpcy5maW5kKCdbZGF0YS1nZW8tY2FyZF0nKTtcclxuXHRcdFx0XHRpZiAoJGNhcmQubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0JGNhcmQuYWRkQ2xhc3ModmlzaWJsZUNsYXNzKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0JHBpbi5vbignbW91c2VsZWF2ZScsIGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0aGlkZUFsbENhcmRzKCk7XHJcblx0XHRcdFx0Y2xlYXJBbGxQYXRocygpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbmFwcC5oaXN0b3J5ID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciB0aW1lbGluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRpbWVsaW5lLWNvbnRhaW5lcl0nKTtcclxuXHRpZiAodGltZWxpbmUpIHtcclxuXHRcdHZhciB0aW1lbGluZUl0ZW1zID0gdGltZWxpbmUucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdGltZWxpbmVdJyk7XHJcblx0XHR2YXIgaGlzdG9yeVN0YWdlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWhpc3RvcnldJyk7XHJcblx0XHR2YXIgaGlzdG9yeUFjdHVhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWhpc3RvcnktYWN0dWFsXScpO1xyXG5cdFx0Ly8gdmFyIGhpc3RvcnlUb3RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWhpc3RvcnktdG90YWxdJyk7XHJcblx0XHR2YXIgaW1hZ2VUcmlnZ2VyTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWhpc3RvcnktaW1hZ2VdJyk7XHJcblx0XHR2YXIgaW1hZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1oaXN0b3J5LWltYWdlc10nKTtcclxuXHRcdHZhciBmb290ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9vdGVyJyk7XHJcblxyXG5cdFx0Ly8gbWlzc2luZyBmb3JFYWNoIG9uIE5vZGVMaXN0IGZvciBJRTExXHJcblx0XHRpZiAod2luZG93Lk5vZGVMaXN0ICYmICFOb2RlTGlzdC5wcm90b3R5cGUuZm9yRWFjaCkge1xyXG5cdFx0XHROb2RlTGlzdC5wcm90b3R5cGUuZm9yRWFjaCA9IEFycmF5LnByb3RvdHlwZS5mb3JFYWNoO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vINCX0LDQtNCw0LXQvCDQv9C10YDQstC+0L3QsNGH0LDQu9GM0L3QvtC1INGB0L7RgdGC0L7Rj9C90LjQtTog0L/QtdGA0LLRi9C5INC/0YPQvdC60YIg0L3QsNCy0LjQs9Cw0YbQuNC4INCy0YvQtNC10LvQtdC9LCDQv9C10YDQstCw0Y8g0YTQvtGC0L7Qs9GA0LDRhNC40Y8g0LLQuNC00L3QsFxyXG5cdFx0ZnVuY3Rpb24gaW5pdGlhbFN0YXRlICgpIHtcclxuXHRcdFx0c2V0QWN0aXZlVGltZWxpbmVJdGVtKGhpc3RvcnlTdGFnZXNbMF0uZGF0YXNldC5oaXN0b3J5KTtcclxuXHRcdFx0aW1hZ2VDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtaGlzdG9yeS1pbWFnZS1pdGVtXScpWzBdLnN0eWxlLm9wYWNpdHkgPSAnMSc7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8g0J7Rh9C40YnQsNC10Lwg0LrQu9Cw0YHRgdGLINCy0YHQtdGFINGN0LvQtdC80LXQvdGC0L7QsiDRgdC/0LjRgdC60LAg0L3QsNCy0LjQs9Cw0YbQuNC4XHJcblx0XHRmdW5jdGlvbiBjbGVhckFsbFRpbWVsaW5lSXRlbXMgKCkge1xyXG5cdFx0XHR0aW1lbGluZUl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuXHRcdFx0XHRpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ3RpbWVsaW5lX19pdGVtLS1hY3RpdmUnKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8g0JfQsNC00LDQtdC8INC/0YPQvdC60YLRgyDQvdCw0LLQuNCz0LDRhtC40Lgg0LDQutGC0LjQstC90L7QtSDRgdC+0YHRgtC+0Y/QvdC40LVcclxuXHRcdGZ1bmN0aW9uIHNldEFjdGl2ZVRpbWVsaW5lSXRlbSAoYW5jaG9yKSB7XHJcblx0XHRcdGNsZWFyQWxsVGltZWxpbmVJdGVtcygpO1xyXG5cdFx0XHR2YXIgdGFyZ2V0SXRlbSA9IHRpbWVsaW5lLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRpbWVsaW5lPScgKyBhbmNob3IgKyAnXScpO1xyXG5cdFx0XHR0YXJnZXRJdGVtLmNsYXNzTGlzdC5hZGQoJ3RpbWVsaW5lX19pdGVtLS1hY3RpdmUnKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyDQl9Cw0LTQsNC10Lwg0YTQvtGC0L7Qs9GA0LDRhNC40Lgg0LDQutGC0LjQstC90L7QtSAo0LLQuNC00LjQvNC+0LUpINGB0L7RgdGC0L7Rj9C90LjQtVxyXG5cdFx0ZnVuY3Rpb24gc2V0QWN0aXZlSW1hZ2UgKGlkKSB7XHJcblx0XHRcdGltYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWhpc3RvcnktaW1hZ2UtaXRlbV0nKS5mb3JFYWNoKGZ1bmN0aW9uIChpbWcpIHtcclxuXHRcdFx0XHRpbWcuc3R5bGUub3BhY2l0eSA9ICcwJztcclxuXHRcdFx0fSk7XHJcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5zdHlsZS5vcGFjaXR5ID0gJzEnO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vINCf0LXRgNC10LzQtdGJ0LXQvdC40LUgcG9zaXRpb246IGZpeGVkINCx0LvQvtC60L7QsiDRgdC/0YDQsNCy0LAg0Lgg0YHQu9C10LLQsCAodGltZWxpbmUg0Lgg0LjQt9C+0LHRgNCw0LbQtdC90LjRjykg0L/RgNC4INC/0L7Rj9Cy0LvQtdC90LjQuCDRhNGD0YLQtdGA0LBcclxuXHRcdGZ1bmN0aW9uIHVwZGF0ZUZpeGVkUG9zaXRpb24gKCkge1xyXG5cdFx0XHR0aW1lbGluZS5zdHlsZS50b3AgPSA5NiAtIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gZm9vdGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCkgKyAncHgnO1xyXG5cdFx0XHRpbWFnZUNvbnRhaW5lci5zdHlsZS50b3AgPSA5NiAtIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gZm9vdGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCkgKyAncHgnO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vINCe0YLQutC70Y7Rh9C10L3QuNC1INC40LvQuCDQstC60LvRjtGH0LXQvdC40LUg0LLRgdC10YUgd2F5cG9pbnRzINGA0LDQt9C+0Lwg0LTQu9GPINC+0YDQs9Cw0L3QuNC30LDRhtC40Lgg0YHQutGA0L7Qu9C70LBcclxuXHRcdGZ1bmN0aW9uIHNldFdheXBvaW50c1N0YXRlIChzdGF0ZSkge1xyXG5cdFx0XHRzd2l0Y2ggKHN0YXRlKSB7XHJcblx0XHRcdGNhc2UgJ2Rpc2FibGUnOlxyXG5cdFx0XHRcdGhpc3RvcnlXYXlwb2ludHNEb3duLmZvckVhY2goZnVuY3Rpb24gKHdheXBvaW50KSB7XHJcblx0XHRcdFx0XHR3YXlwb2ludC5kaXNhYmxlKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aGlzdG9yeVdheXBvaW50c1VwLmZvckVhY2goZnVuY3Rpb24gKHdheXBvaW50KSB7XHJcblx0XHRcdFx0XHR3YXlwb2ludC5kaXNhYmxlKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aW1hZ2VXYXlwb2ludHMuZm9yRWFjaChmdW5jdGlvbiAod2F5cG9pbnQpIHtcclxuXHRcdFx0XHRcdHdheXBvaW50LmRpc2FibGUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAnZW5hYmxlJzpcclxuXHRcdFx0ZGVmYXVsdDpcclxuXHRcdFx0XHRoaXN0b3J5V2F5cG9pbnRzRG93bi5mb3JFYWNoKGZ1bmN0aW9uICh3YXlwb2ludCkge1xyXG5cdFx0XHRcdFx0d2F5cG9pbnQuZW5hYmxlKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aGlzdG9yeVdheXBvaW50c1VwLmZvckVhY2goZnVuY3Rpb24gKHdheXBvaW50KSB7XHJcblx0XHRcdFx0XHR3YXlwb2ludC5lbmFibGUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpbWFnZVdheXBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uICh3YXlwb2ludCkge1xyXG5cdFx0XHRcdFx0d2F5cG9pbnQuZW5hYmxlKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpbml0aWFsU3RhdGUoKTtcclxuXHJcblx0XHQvLyDQl9Cw0YDQsNC90LXQtSDRgdC+0LfQtNCw0Y4g0LzQsNGB0YHQuNCy0Ysg0L/QvtC0IHdheXBvaW50cywg0YfRgtC+0LHRiyDQv9C+0YLQvtC8INGB0LLQvtC10LLRgNC10LzQtdC90L3QviDQuNGFINC+0YLQutC70Y7Rh9Cw0YLRjCDQuCDQstC60LvRjtGH0LDRgtGMXHJcblx0XHR2YXIgaGlzdG9yeVdheXBvaW50c0Rvd24gPSBuZXcgQXJyYXkoaGlzdG9yeVN0YWdlcy5sZW5ndGgpO1xyXG5cdFx0dmFyIGhpc3RvcnlXYXlwb2ludHNVcCA9IG5ldyBBcnJheShoaXN0b3J5U3RhZ2VzLmxlbmd0aCk7XHJcblx0XHR2YXIgaW1hZ2VXYXlwb2ludHMgPSBuZXcgQXJyYXkoaGlzdG9yeVN0YWdlcy5sZW5ndGgpO1xyXG5cclxuXHRcdGhpc3RvcnlTdGFnZXMuZm9yRWFjaChmdW5jdGlvbiAoc3RhZ2UsIGluZGV4KSB7XHJcblx0XHRcdGhpc3RvcnlXYXlwb2ludHNEb3duW2luZGV4XSA9IG5ldyBXYXlwb2ludCh7XHJcblx0XHRcdFx0ZWxlbWVudDogc3RhZ2UsXHJcblx0XHRcdFx0aGFuZGxlcjogZnVuY3Rpb24gKGRpcmVjdGlvbikge1xyXG5cdFx0XHRcdFx0aWYgKGRpcmVjdGlvbiA9PT0gJ2Rvd24nKSB7XHJcblx0XHRcdFx0XHRcdHZhciB1cGRhdGVkQ291bnRlclZhbHVlID0gaW5kZXggKyAxO1xyXG5cdFx0XHRcdFx0XHRoaXN0b3J5QWN0dWFsLnRleHRDb250ZW50ID0gaW5kZXggKyAxID4gMTAgPyB1cGRhdGVkQ291bnRlclZhbHVlIDogJzAnICsgdXBkYXRlZENvdW50ZXJWYWx1ZTtcclxuXHRcdFx0XHRcdFx0c2V0QWN0aXZlVGltZWxpbmVJdGVtKHN0YWdlLmRhdGFzZXQuaGlzdG9yeSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRvZmZzZXQ6IDBcclxuXHRcdFx0fSk7XHJcblx0XHRcdGhpc3RvcnlXYXlwb2ludHNVcFtpbmRleF0gPSBuZXcgV2F5cG9pbnQoe1xyXG5cdFx0XHRcdGVsZW1lbnQ6IHN0YWdlLFxyXG5cdFx0XHRcdGhhbmRsZXI6IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcclxuXHRcdFx0XHRcdGlmIChkaXJlY3Rpb24gPT09ICd1cCcpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHVwZGF0ZWRDb3VudGVyVmFsdWUgPSBpbmRleCArIDE7XHJcblx0XHRcdFx0XHRcdGhpc3RvcnlBY3R1YWwudGV4dENvbnRlbnQgPSBpbmRleCArIDEgPiAxMCA/IHVwZGF0ZWRDb3VudGVyVmFsdWUgOiAnMCcgKyB1cGRhdGVkQ291bnRlclZhbHVlO1xyXG5cdFx0XHRcdFx0XHRzZXRBY3RpdmVUaW1lbGluZUl0ZW0oc3RhZ2UuZGF0YXNldC5oaXN0b3J5KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdG9mZnNldDogJ2JvdHRvbS1pbi12aWV3J1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vINCh0L7Qt9C00LDQtdC8INC+0YLQtNC10LvRjNC90YvQtSB3YXlwb2ludHMg0LTQu9GPINGD0L/RgNCw0LLQu9C10L3QuNGPINC40LfQvtCx0YDQsNC20LXQvdC40Y/QvNC4LCDQv9GA0LjQstGP0LfQsNC90L3Ri9C80Lgg0LogZGF0YS1oaXN0b3J5LWltYWdlXHJcblx0XHRpbWFnZVRyaWdnZXJMaXN0LmZvckVhY2goZnVuY3Rpb24gKHRyaWdnZXIsIGluZGV4KSB7XHJcblx0XHRcdGltYWdlV2F5cG9pbnRzW2luZGV4XSA9IG5ldyBXYXlwb2ludCh7XHJcblx0XHRcdFx0ZWxlbWVudDogdHJpZ2dlcixcclxuXHRcdFx0XHRoYW5kbGVyOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHRzZXRBY3RpdmVJbWFnZSh0cmlnZ2VyLmRhdGFzZXQuaGlzdG9yeUltYWdlKTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdG9mZnNldDogMTAwXHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8g0J7QsdC90L7QstC70Y/QtdC8INC/0L7Qu9C+0LbQtdC90LjQtSDQuNC30L7QsdGA0LDQttC10L3QuNGPLCDQutC+0LPQtNCwINC00L7QutGA0YPRgtC40LvQuCDQtNC+INGE0YPRgtC10YDQsFxyXG5cdFx0dmFyIGZvb3RlcldheXBvaW50ID0gbmV3IFdheXBvaW50KHtcclxuXHRcdFx0ZWxlbWVudDogZm9vdGVyLFxyXG5cdFx0XHRoYW5kbGVyOiBmdW5jdGlvbiAoZGlyZWN0aW9uKSB7XHJcblx0XHRcdFx0aWYgKGRpcmVjdGlvbiA9PT0gJ2Rvd24nKSB7XHJcblx0XHRcdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB1cGRhdGVGaXhlZFBvc2l0aW9uKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGRpcmVjdGlvbiA9PT0gJ3VwJykge1xyXG5cdFx0XHRcdFx0dGltZWxpbmUuc3R5bGUudG9wID0gOTYgKyAncHgnO1xyXG5cdFx0XHRcdFx0aW1hZ2VDb250YWluZXIuc3R5bGUudG9wID0gOTYgKyAncHgnO1xyXG5cdFx0XHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdXBkYXRlRml4ZWRQb3NpdGlvbik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRvZmZzZXQ6ICcxMDAlJ1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8g0KHQutGA0L7Qu9C7INGC0LXQutGB0YLQsCDQuiDQvdGD0LbQvdC+0LzRgyDQv9GD0L3QutGC0YMg0L/RgNC4INC60LvQuNC60LUg0L3QsCDRgdC+0L7RgtCy0LXRgtGB0YLQstGD0Y7RidC10Lwg0Y3Qu9C10LzQtdC90YLQtSB0aW1lbGluZVxyXG5cdFx0Ly8g0JTQu9GPINC60L7Qu9C70LHRjdC60LAg0L/QviDQstGL0L/QvtC70L3QtdC90LjQuCDQsNC90LjQvNCw0YbQuNC4INC/0LXRgNC10YXQvtC00LjQvCDQvdCwIGpRdWVyeVxyXG5cdFx0JCgnW2RhdGEtdGltZWxpbmVdJykuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcclxuXHRcdFx0JCh0aGlzKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdHNldEFjdGl2ZVRpbWVsaW5lSXRlbShlLnRhcmdldC5kYXRhc2V0LnRpbWVsaW5lKTtcclxuXHRcdFx0XHQvLyDQktGL0LHQuNGA0LDQtdC8INCw0LrRgtC40LLQvdC+0Lkg0L/QtdGA0LLRg9GOINGE0L7RgtC+0LPRgNCw0YTQuNGOINCyINCx0LvQvtC60LUsINC60L7RgtC+0YDRi9C5INC/0L7Rj9Cy0LjRgtGB0Y8g0L/QviDQutC70LjQutGDINC90LAg0L3QsNCy0LjQs9Cw0YbQuNGOXHJcblx0XHRcdFx0c2V0QWN0aXZlSW1hZ2UoaGlzdG9yeVN0YWdlc1tpbmRleF0ucXVlcnlTZWxlY3RvcignW2RhdGEtaGlzdG9yeS1pbWFnZV0nKS5kYXRhc2V0Lmhpc3RvcnlJbWFnZSk7XHJcblx0XHRcdFx0Ly8g0JLRi9GB0YLQsNCy0LvRj9C10Lwg0YHRh9C10YLRh9C40Log0L3QsNC0IHRpbWVsaW5lINC90LAg0L3QvtCy0L7QtSDQt9C90LDRh9C10L3QuNC1XHJcblx0XHRcdFx0dmFyIHVwZGF0ZWRDb3VudGVyVmFsdWUgPSBpbmRleCArIDE7XHJcblx0XHRcdFx0aGlzdG9yeUFjdHVhbC50ZXh0Q29udGVudCA9IGluZGV4ICsgMSA+IDEwID8gdXBkYXRlZENvdW50ZXJWYWx1ZSA6ICcwJyArIHVwZGF0ZWRDb3VudGVyVmFsdWU7XHJcblx0XHRcdFx0Ly8g0J7RgtC60LvRjtGH0LDQtdC8IHdheXBvaW50cyDQvdCwINC/0LXRgNC40L7QtCDRgdC60YDQvtC70LvQsFxyXG5cdFx0XHRcdHNldFdheXBvaW50c1N0YXRlKCdkaXNhYmxlJyk7XHJcblx0XHRcdFx0JChbZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBkb2N1bWVudC5ib2R5XSkuc3RvcCgpLmFuaW1hdGUoe1xyXG5cdFx0XHRcdFx0c2Nyb2xsVG9wOiAkKCdbZGF0YS1oaXN0b3J5XScpLmVxKGluZGV4KS5vZmZzZXQoKS50b3AgLSA1MFxyXG5cdFx0XHRcdH0sIDUwMCwgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0Ly8g0J/QvtGB0LvQtSDQt9Cw0LLQtdGA0YjQtdC90LjRjyDRgdC60YDQvtC70LvQsCDRgdC90L7QstCwINCy0LrQu9GO0YfQsNC10Lwgd2F5cG9pbnRzXHJcblx0XHRcdFx0XHRzZXRXYXlwb2ludHNTdGF0ZSgnZW5hYmxlJyk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxuYXBwLnN0aWNreUhlYWRlciA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgJHN0aWNreUhlYWRlciA9ICQoJ1tkYXRhLXN0aWNreS1oZWFkZXJdJyk7XHJcblx0dmFyIGFjdGl2ZUNsYXNzID0gJ19hY3RpdmUnO1xyXG5cclxuXHQkKCdbZGF0YS13YXlwb2ludD1cIm1wX3NlY29uZFwiXScpLndheXBvaW50KHtcclxuXHRcdGhhbmRsZXI6IGZ1bmN0aW9uKGRpcikge1xyXG5cdFx0XHRpZiAoZGlyID09PSAnZG93bicpIHtcclxuXHRcdFx0XHQkc3RpY2t5SGVhZGVyLmFkZENsYXNzKGFjdGl2ZUNsYXNzKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkc3RpY2t5SGVhZGVyLnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuYXBwLnN3aXBlck1haW5IZWFkZXJJbWFnZXMgPSBmdW5jdGlvbiAoKSB7XHJcblx0dmFyICRob21lU3dpcGVyID0gJCgnW2RhdGEtaG9tZS1zd2lwZXJdJyk7XHJcblx0dmFyICRob21lU3dpcGVySW1hZ2VzID0gJGhvbWVTd2lwZXIuZmluZCgnW2RhdGEtaG9tZS1zd2lwZXItc3JjXScpO1xyXG5cdHZhciAkd2luZG93ID0gYXBwLmRvbS4kd2luZG93O1xyXG5cdHZhciBjYWxjSW1nV2lkdGggPSAwO1xyXG5cdHZhciBjYWxjSW1nSGVpZ2h0ID0gMDtcclxuXHR2YXIgdHJhbnNpdGlvbk9mZnNldFdpZHRoID0gMDtcclxuXHR2YXIgdHJhbnNpdGlvbk9mZnNldEhlaWdodCA9IDA7XHJcblx0dmFyIGNvdW50ZXJTd2lwZXI7XHJcblx0dmFyIGltZ1NyYyA9ICRob21lU3dpcGVySW1hZ2VzLmRhdGEoJ2hvbWUtc3dpcGVyLXNyYycpO1xyXG5cdHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcclxuXHRpbWcub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0b25Mb2FkSW1nKCk7XHJcblx0fTtcclxuXHRpbWcuc3JjID0gaW1nU3JjO1xyXG5cclxuXHQkd2luZG93Lm9uKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRvbkxvYWRJbWcoKTtcclxuXHR9KTtcclxuXHJcblx0ZnVuY3Rpb24gb25Mb2FkSW1nICgpIHtcclxuXHRcdHZhciBrSW1nID0gaW1nLndpZHRoL2ltZy5oZWlnaHQ7XHJcblx0XHR2YXIga1dpZHRoID0gJHdpbmRvdy53aWR0aCgpIC8gaW1nLndpZHRoO1xyXG5cdFx0dmFyIGtIZWlnaHQgPSAkd2luZG93LmhlaWdodCgpIC8gaW1nLmhlaWdodDtcclxuXHRcdGlmKGtXaWR0aCA+IGtIZWlnaHQpIHtcclxuXHRcdFx0Y2FsY0ltZ1dpZHRoID0gJHdpbmRvdy53aWR0aCgpO1xyXG5cdFx0XHRjYWxjSW1nSGVpZ2h0ID0gY2FsY0ltZ1dpZHRoIC8ga0ltZztcclxuXHRcdFx0dHJhbnNpdGlvbk9mZnNldEhlaWdodCA9IC0oY2FsY0ltZ0hlaWdodCAtICR3aW5kb3cuaGVpZ2h0KCkpIC8gMjtcclxuXHRcdFx0dHJhbnNpdGlvbk9mZnNldFdpZHRoID0gMDtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRjYWxjSW1nSGVpZ2h0ID0gJHdpbmRvdy5oZWlnaHQoKTtcclxuXHRcdFx0Y2FsY0ltZ1dpZHRoID0gY2FsY0ltZ0hlaWdodCAqIGtJbWc7XHJcblx0XHRcdHRyYW5zaXRpb25PZmZzZXRXaWR0aCA9IC0oY2FsY0ltZ1dpZHRoIC0gJHdpbmRvdy53aWR0aCgpKSAvIDI7XHJcblx0XHRcdHRyYW5zaXRpb25PZmZzZXRIZWlnaHQgPSAwO1xyXG5cdFx0fVxyXG5cclxuXHRcdGluaXRTd2lwZXIoKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGluaXRQYWdpbmF0aW9uICgkc3dpcGVycykge1xyXG5cdCAgICBpZiAoY291bnRlclN3aXBlciAmJiBjb3VudGVyU3dpcGVyICE9PSAndW5kZWZpbmVkJykge1xyXG5cdCAgICAgIGNvdW50ZXJTd2lwZXIuZGVzdHJveSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciAkY291bnRlciA9ICQoJ1tkYXRhLWNvdW50ZXI9XCJob21lXCJdJyk7XHJcblx0XHR2YXIgJG5leHQgPSAkY291bnRlci5maW5kKCdbZGF0YS1jb3VudGVyLW5leHRdJyk7XHJcblx0XHR2YXIgJHByZXYgPSAkY291bnRlci5maW5kKCdbZGF0YS1jb3VudGVyLXByZXZdJyk7XHJcblxyXG5cdFx0dmFyICRjb3VudGVyU3dpcGVyID0gJGNvdW50ZXIuZmluZCgnW2RhdGEtY291bnRlci1zd2lwZXJdJyk7XHJcblx0XHR2YXIgc3BlZWQgPSAxMDAwO1xyXG5cdFx0Y291bnRlclN3aXBlciA9IG5ldyBTd2lwZXIoJGNvdW50ZXJTd2lwZXIsIHtcclxuXHRcdFx0c2xpZGVzUGVyVmlldzogMSxcclxuXHRcdFx0ZGlyZWN0aW9uOiAndmVydGljYWwnLFxyXG5cdFx0XHRpbml0aWFsU2xpZGU6IDAsXHJcblx0XHRcdHNwZWVkOiBzcGVlZCxcclxuXHRcdFx0aGVpZ2h0OiAzMixcclxuXHRcdFx0bG9vcDogdHJ1ZSxcclxuXHRcdFx0YXV0b3BsYXk6IHtcclxuXHRcdFx0XHRkZWxheTogNTAwMCxcclxuXHRcdFx0XHRkaXNhYmxlT25JbnRlcmFjdGlvbjogZmFsc2VcclxuXHRcdFx0fSxcclxuXHRcdFx0Y29udHJvbGxlcjoge1xyXG5cdFx0XHRcdGNvbnRyb2w6IFskc3dpcGVyc1swXS5zd2lwZXIsICRzd2lwZXJzWzFdLnN3aXBlciwgJHN3aXBlcnNbMl0uc3dpcGVyLCAkc3dpcGVyc1szXS5zd2lwZXJdXHJcblx0XHRcdH0sXHJcblx0XHRcdG9uOiB7XHJcblx0XHRcdFx0c2xpZGVDaGFuZ2VUcmFuc2l0aW9uU3RhcnQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIF90aGlzID0gdGhpcztcclxuXHRcdFx0XHRcdHRoaXMuYWxsb3dTbGlkZVByZXYgPSBmYWxzZTtcclxuXHRcdFx0XHRcdHRoaXMuYWxsb3dTbGlkZU5leHQgPSBmYWxzZTtcclxuXHJcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRfdGhpcy5hbGxvd1NsaWRlUHJldiA9IHRydWU7XHJcblx0XHRcdFx0XHRcdF90aGlzLmFsbG93U2xpZGVOZXh0ID0gdHJ1ZTtcclxuXHRcdFx0XHRcdH0sIHNwZWVkICsgMjAwKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdCRuZXh0Lm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZiAoY291bnRlclN3aXBlci5hbGxvd1NsaWRlUHJldiB8fCBjb3VudGVyU3dpcGVyLmFsbG93U2xpZGVOZXh0KSB7XHJcblx0XHRcdFx0Y291bnRlclN3aXBlci5zbGlkZU5leHQoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0JHByZXYub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmIChjb3VudGVyU3dpcGVyLmFsbG93U2xpZGVQcmV2IHx8IGNvdW50ZXJTd2lwZXIuYWxsb3dTbGlkZU5leHQpIHtcclxuXHRcdFx0XHRjb3VudGVyU3dpcGVyLnNsaWRlUHJldigpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGluaXRTd2lwZXIgKCkge1xyXG5cdFx0dmFyICRzd2lwZXJzID0gJGhvbWVTd2lwZXIuZmluZCgnW2RhdGEtc3dpcGVyLW1haW4taW1hZ2VzXScpO1xyXG5cclxuXHRcdGlmICgkc3dpcGVycy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdHZhciB3aW5kb3dXaWR0aCA9IGFwcC5kb20uJHdpbmRvdy53aWR0aCgpO1xyXG5cdFx0XHR2YXIgcXVhcnRlciA9IE1hdGguY2VpbCh3aW5kb3dXaWR0aCAvIDQpO1xyXG5cdFx0XHQkc3dpcGVycy53aWR0aChxdWFydGVyKTtcclxuXHRcdFx0JHN3aXBlcnMuZWFjaChmdW5jdGlvbiAoc3dpcGVySW5kZXgpIHtcclxuXHRcdFx0XHR2YXIgJHNsaWRlcyA9ICQodGhpcykuZmluZCgnW2RhdGEtc2xpZGUtaWRdJyk7XHJcblx0XHRcdFx0dmFyICRpbWFnZUVsZW0gPSAkc2xpZGVzLmZpbmQoJ2ltZycpO1xyXG5cdFx0XHRcdCRpbWFnZUVsZW0uZWFjaChmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHQkKHRoaXMpWzBdLnNyYyA9ICQodGhpcykuZGF0YSgnc3JjJyk7XHJcblx0XHRcdFx0XHQkKHRoaXMpLmNzcyh7XHJcblx0XHRcdFx0XHRcdHdpZHRoOiBjYWxjSW1nV2lkdGggKyAncHgnLFxyXG5cdFx0XHRcdFx0XHRoZWlnaHQ6IGNhbGNJbWdIZWlnaHQgKyAncHgnLFxyXG5cdFx0XHRcdFx0XHR0cmFuc2Zvcm06ICd0cmFuc2xhdGUoJyArICgtKHF1YXJ0ZXIgKiBzd2lwZXJJbmRleCkgKyB0cmFuc2l0aW9uT2Zmc2V0V2lkdGgpICsgJ3B4LCcgKyB0cmFuc2l0aW9uT2Zmc2V0SGVpZ2h0ICsgJ3B4KSdcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHR2YXIgaG9tZUJhbm5lclN3aXBlciA9ICQoJ1tkYXRhLWhvbWUtYmFubmVyXScpWzBdO1xyXG5cdFx0XHRcdHZhciBzd2lwZXJTZXR0aW5ncyA9IHtcclxuXHRcdFx0XHRcdGFsbG93VG91Y2hNb3ZlOiBmYWxzZSxcclxuXHRcdFx0XHRcdHZpcnR1YWxUcmFuc2xhdGU6IHRydWUsXHJcblx0XHRcdFx0XHRzcGVlZDogMTAwMCxcclxuXHRcdFx0XHRcdGxvb3A6IHRydWUsXHJcblx0XHRcdFx0XHRvbjoge1xyXG5cdFx0XHRcdFx0XHRzbGlkZUNoYW5nZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XHJcblx0XHRcdFx0XHRcdFx0dmFyIHNsaWRlID0gaG9tZUJhbm5lclN3aXBlci5zd2lwZXIuc2xpZGVzW3RoaXMucmVhbEluZGV4XTtcclxuXHRcdFx0XHRcdFx0XHR2YXIgJGJhbm5lclRpdGxlID0gJChzbGlkZSkuZmluZCgnLm1haW5fX3NsaWRlLXRpdGxlIHAsIC5tYWluX19zbGlkZS10aXRsZSBzcGFuJyk7XHJcblx0XHRcdFx0XHRcdFx0dmFyICRiYW5uZXJUZXh0ID0gJChzbGlkZSkuZmluZCgnLm1haW5fX3NsaWRlLXRleHQgcCwgLm1haW5fX3NsaWRlLXRleHQgc3BhbicpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRhcHAuYW5pbWF0ZUNTUygkYmFubmVyVGl0bGUsICd0aXRsZVNsaWRlSW4nKTtcclxuXHRcdFx0XHRcdFx0XHRhcHAuYW5pbWF0ZUNTUygkYmFubmVyVGV4dCwgJ2ZhZGVJblVwJywgMCwgZmFsc2UpO1xyXG5cdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHRodW1iczoge1xyXG5cdFx0XHRcdFx0XHRzd2lwZXI6IHtcclxuXHRcdFx0XHRcdFx0XHRlbDogaG9tZUJhbm5lclN3aXBlcixcclxuXHRcdFx0XHRcdFx0XHR2aXJ0dWFsVHJhbnNsYXRlOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdGFsbG93VG91Y2hNb3ZlOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRvbjoge1xyXG5cdFx0XHRcdFx0XHRcdFx0aW5pdDogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRhcHAuc3dpcGVySW5pdFNwbGl0dHlJbnNpZGUodGhpcyk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fTtcclxuXHRcdFx0XHRuZXcgU3dpcGVyKHRoaXMsIHN3aXBlclNldHRpbmdzKTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdGluaXRQYWdpbmF0aW9uICgkc3dpcGVycyk7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuYXBwLnN3aXBlck1haW5OZXdzID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciAkc3dpcGVyID0gJCgnW2RhdGEtc3dpcGVyLW1haW4tbmV3c10nKTtcclxuXHJcblx0dmFyIHN3aXBlclNldHRpbmdzID0ge1xyXG5cdFx0c2xpZGVzUGVyVmlldzogMSxcclxuXHRcdHNwYWNlQmV0d2VlbjogMzIsXHJcblx0XHRhbGxvd1RvdWNoTW92ZTogZmFsc2UsXHJcblx0XHRicmVha3BvaW50czoge1xyXG5cdFx0XHQxMjAwOiB7XHJcblx0XHRcdFx0c2xpZGVzUGVyVmlldzogMlxyXG5cdFx0XHR9LFxyXG5cdFx0XHQ5OTE6IHtcclxuXHRcdFx0XHRzbGlkZXNQZXJWaWV3OiAxXHJcblx0XHRcdH0sXHJcblx0XHRcdDU4MDoge1xyXG5cdFx0XHRcdHNsaWRlc1BlclZpZXc6IDJcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdG9uOiB7XHJcblx0XHRcdGluaXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGFwcC5zd2lwZXJJbml0U3BsaXR0eUluc2lkZSh0aGlzKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHZhciByZXN1bHRTZXR0aW5ncyA9ICQuZXh0ZW5kKHRydWUsIHt9LCBhcHAuc3dpcGVyRGVmYXVsdFNldHRpbmdzLCBzd2lwZXJTZXR0aW5ncyk7XHJcblxyXG5cdGlmICgkc3dpcGVyLmxlbmd0aCkge1xyXG5cdFx0dmFyIHN3aXBlciA9IG5ldyBTd2lwZXIoJHN3aXBlciwgcmVzdWx0U2V0dGluZ3MpO1xyXG5cdFx0c3dpcGVyLmluaXQoKTtcclxuXHR9XHJcbn07XHJcblxyXG5hcHAuc3dpcGVyTWFpblN0b2NrcyA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgJHN3aXBlciA9ICQoJ1tkYXRhLXN3aXBlci1tZnMtc3dpcGVyXScpO1xyXG5cclxuXHR2YXIgc3dpcGVyU2V0dGluZ3MgPSB7XHJcblx0XHRhbGxvd1RvdWNoTW92ZTogZmFsc2UsXHJcblx0XHR0aHVtYnM6IHtcclxuXHRcdFx0c3dpcGVyOiB7XHJcblx0XHRcdFx0ZWw6ICdbZGF0YS1zd2lwZXItbWZzLWltYWdlc10nLFxyXG5cdFx0XHRcdHNwZWVkOiAxMDAwXHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRwYWdpbmF0aW9uOiB7XHJcblx0XHRcdGVsOiAnW2RhdGEtc3dpcGVyLW1mcy1wYWdpbmF0aW9uXScsXHJcblx0XHRcdGNsaWNrYWJsZTogdHJ1ZVxyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHZhciByZXN1bHRTZXR0aW5ncyA9ICQuZXh0ZW5kKHRydWUsIHt9LCBhcHAuc3dpcGVyRGVmYXVsdFNldHRpbmdzLCBzd2lwZXJTZXR0aW5ncyk7XHJcblxyXG5cdGlmICgkc3dpcGVyLmxlbmd0aCkge1xyXG5cdFx0dmFyIHN3aXBlciA9IG5ldyBTd2lwZXIoJHN3aXBlciwgcmVzdWx0U2V0dGluZ3MpO1xyXG5cdFx0c3dpcGVyLmluaXQoKTtcclxuXHR9XHJcbn07XHJcblxyXG5hcHAuc3dpcGVyTWFpblByb2R1Y3RzID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciAkc3dpcGVyID0gJCgnW2RhdGEtc3dpcGVyLW1haW4tcHJvZHVjdHNdJyk7XHJcblxyXG5cdHZhciBzd2lwZXJTZXR0aW5ncyA9IHtcclxuXHRcdHNwYWNlQmV0d2VlbjogMzJcclxuXHR9O1xyXG5cclxuXHR2YXIgcmVzdWx0U2V0dGluZ3MgPSAkLmV4dGVuZCh0cnVlLCB7fSwgYXBwLnN3aXBlckRlZmF1bHRTZXR0aW5ncywgc3dpcGVyU2V0dGluZ3MpO1xyXG5cclxuXHRpZiAoJHN3aXBlci5sZW5ndGgpIHtcclxuXHRcdHZhciBzd2lwZXIgPSBuZXcgU3dpcGVyKCRzd2lwZXIsIHJlc3VsdFNldHRpbmdzKTtcclxuXHRcdHN3aXBlci5pbml0KCk7XHJcblx0fVxyXG59O1xyXG5cclxuYXBwLnN3aXBlck1haW5CYW5uZXJNb2JpbGUgPSBmdW5jdGlvbiAoKSB7XHJcblx0dmFyICRzd2lwZXIgPSAkKCdbZGF0YS1zd2lwZXItbWFpbi1tb2JpbGUtYmFubmVyXScpO1xyXG5cclxuXHR2YXIgc3dpcGVyU2V0dGluZ3MgPSB7XHJcblx0XHRhdXRvSGVpZ2h0OiB0cnVlLFxyXG5cdFx0cGFnaW5hdGlvbjoge1xyXG5cdFx0XHRlbDogJ1tkYXRhLXN3aXBlci1tYWluLW1vYmlsZS1iYW5uZXItcGFnaW5hdGlvbl0nLFxyXG5cdFx0XHR0eXBlOiAnYnVsbGV0cycsXHJcblx0XHRcdGNsaWNrYWJsZTogdHJ1ZVxyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHZhciByZXN1bHRTZXR0aW5ncyA9ICQuZXh0ZW5kKHRydWUsIHt9LCBhcHAuc3dpcGVyRGVmYXVsdFNldHRpbmdzLCBzd2lwZXJTZXR0aW5ncyk7XHJcblxyXG5cdGlmICgkc3dpcGVyLmxlbmd0aCkge1xyXG5cdFx0dmFyIHN3aXBlciA9IG5ldyBTd2lwZXIoJHN3aXBlciwgcmVzdWx0U2V0dGluZ3MpO1xyXG5cdFx0c3dpcGVyLmluaXQoKTtcclxuXHR9XHJcbn07XHJcblxyXG5hcHAuc3dpcGVyUHJlc3NHYWxsZXJ5ID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciAkZ2FsbGVyeUNvbGxlY3Rpb24gPSAkKCdbZGF0YS1wcmVzcy1nYWxsZXJ5LXdyYXBwZXJdJyk7XHJcblxyXG5cdCRnYWxsZXJ5Q29sbGVjdGlvbi5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyICR0aGlzID0gJCh0aGlzKTtcclxuXHRcdHZhciAkZ2FsbGVyeSA9ICR0aGlzLmZpbmQoJ1tkYXRhLXByZXNzLWdhbGxlcnldJyk7XHJcblx0XHR2YXIgJHBhZ2luYXRpb24gPSAkdGhpcy5maW5kKCdbZGF0YS1wcmVzcy1nYWxsZXJ5LXBhZ2luYXRpb25dJyk7XHJcblx0XHR2YXIgJG5leHQgPSAkdGhpcy5maW5kKCdbZGF0YS1wcmVzcy1nYWxsZXJ5LW5leHRdJyk7XHJcblx0XHR2YXIgJHByZXYgPSAkdGhpcy5maW5kKCdbZGF0YS1wcmVzcy1nYWxsZXJ5LXByZXZdJyk7XHJcblxyXG5cdFx0bmV3IFN3aXBlcigkZ2FsbGVyeVswXSwge1xyXG5cdFx0XHRwYWdpbmF0aW9uOiB7XHJcblx0XHRcdFx0ZWw6ICRwYWdpbmF0aW9uWzBdLFxyXG5cdFx0XHRcdHR5cGU6ICdmcmFjdGlvbicsXHJcblx0XHRcdH0sXHJcblx0XHRcdG5hdmlnYXRpb246IHtcclxuXHRcdFx0XHRuZXh0RWw6ICRuZXh0WzBdLFxyXG5cdFx0XHRcdHByZXZFbDogJHByZXZbMF0sXHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHR9KTtcclxufTtcclxuXHJcbmFwcC5zd2lwZXJNb3JlTmV3c0dhbGxlcnkgPSBmdW5jdGlvbiAoKSB7XHJcblx0dmFyICRnYWxsZXJ5Q29sbGVjdGlvbiA9ICQoJ1tkYXRhLW1vcmUtbmV3cy1nYWxsZXJ5LXdyYXBwZXJdJyk7XHJcblxyXG5cdCRnYWxsZXJ5Q29sbGVjdGlvbi5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyICR0aGlzID0gJCh0aGlzKTtcclxuXHRcdHZhciAkZ2FsbGVyeSA9ICR0aGlzLmZpbmQoJ1tkYXRhLW1vcmUtbmV3cy1nYWxsZXJ5XScpO1xyXG5cdFx0dmFyICRwYWdpbmF0aW9uID0gJHRoaXMuZmluZCgnW2RhdGEtbW9yZS1uZXdzLWdhbGxlcnktcGFnaW5hdGlvbl0nKTtcclxuXHRcdHZhciAkbmV4dCA9ICR0aGlzLmZpbmQoJ1tkYXRhLW1vcmUtbmV3cy1nYWxsZXJ5LW5leHRdJyk7XHJcblx0XHR2YXIgJHByZXYgPSAkdGhpcy5maW5kKCdbZGF0YS1tb3JlLW5ld3MtZ2FsbGVyeS1wcmV2XScpO1xyXG5cclxuXHRcdG5ldyBTd2lwZXIoJGdhbGxlcnlbMF0sIHtcclxuXHRcdFx0c3BhY2VCZXR3ZWVuOiAzMixcclxuXHRcdFx0c2xpZGVzUGVyVmlldzogJ2F1dG8nLFxyXG5cdFx0XHRwYWdpbmF0aW9uOiB7XHJcblx0XHRcdFx0ZWw6ICRwYWdpbmF0aW9uWzBdLFxyXG5cdFx0XHRcdHR5cGU6ICdmcmFjdGlvbicsXHJcblx0XHRcdH0sXHJcblx0XHRcdG5hdmlnYXRpb246IHtcclxuXHRcdFx0XHRuZXh0RWw6ICRuZXh0WzBdLFxyXG5cdFx0XHRcdHByZXZFbDogJHByZXZbMF0sXHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHR9KTtcclxufTtcclxuXHJcbmFwcC5nYWxsZXJ5ID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciAkdmlkZW9UcmlnZ2VycyA9ICQoJ1tkYXRhLXZpZGVvLXRyaWdnZXJdJyk7XHJcblx0JHZpZGVvVHJpZ2dlcnMubWFnbmlmaWNQb3B1cCh7XHJcblx0XHR0eXBlOiAnaWZyYW1lJyxcclxuXHRcdGlmcmFtZToge1xyXG5cdFx0XHRwYXR0ZXJuczoge1xyXG5cdFx0XHRcdHlvdXR1YmU6IHtcclxuXHRcdFx0XHRcdGluZGV4OiAneW91dHViZS5jb20vJyxcclxuXHRcdFx0XHRcdGlkOiBmdW5jdGlvbih1cmwpIHtcclxuXHRcdFx0XHRcdFx0dmFyIG0gPSB1cmwubWF0Y2goL1tcXFxcP1xcXFwmXXY9KFteXFxcXD9cXFxcJl0rKS8pO1xyXG5cdFx0XHRcdFx0XHRpZiAoICFtIHx8ICFtWzFdICkgcmV0dXJuIG51bGw7XHJcblx0XHRcdFx0XHRcdHJldHVybiBtWzFdO1xyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHNyYzogJy8vd3d3LnlvdXR1YmUuY29tL2VtYmVkLyVpZCU/YXV0b3BsYXk9MSdcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRtYWluQ2xhc3M6ICdnYWxsZXJ5LXBvcHVwJyxcclxuXHRcdGNsb3NlTWFya3VwOiAnPGRpdiBjbGFzcz1cIm1mcC1jbG9zZS13cmFwcGVyXCI+PGJ1dHRvbiB0aXRsZT1cIiV0aXRsZSVcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJtZnAtY2xvc2VcIj48L2J1dHRvbj48L2Rpdj4nXHJcblx0fSk7XHJcbn07XHJcblxyXG5hcHAuY2FyZWVySW1hZ2VzID0gZnVuY3Rpb24gKCkge1xyXG5cdHZhciAkY2FyZWVySW1hZ2VzID0gJCgnW2RhdGEtY2FyZWVyLWltYWdlc10nKSxcclxuXHRcdGNhcmVlckltYWdlc09mZnNldCA9ICRjYXJlZXJJbWFnZXMub2Zmc2V0KCk7XHJcblxyXG5cdGlmICgkY2FyZWVySW1hZ2VzLmxlbmd0aCA+IDApIHtcclxuXHRcdHZhciAkY2FyZWVySW1hZ2VzSW5uZXIgPSAkKCdbZGF0YS1jYXJlZXItaW1hZ2VzLWlubmVyXScpO1xyXG5cdFx0dmFyICRpbWFnZXMgPSAkY2FyZWVySW1hZ2VzLmZpbmQoJ1tkYXRhLWNhcmVlci1pbWFnZXMtaXRlbV0nKTtcclxuXHRcdHZhciBpbWFnZXNXaWR0aCA9IDA7XHJcblx0XHR2YXIgaGVhZGVySGVpZ2h0ID0gJCgnW2RhdGEtaGVhZGVyXScpLmhlaWdodCgpO1xyXG5cclxuXHJcblx0XHQkaW1hZ2VzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdGltYWdlc1dpZHRoICs9ICQodGhpcykub3V0ZXJXaWR0aCgpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0YXBwLmRvbS4kd2luZG93Lm9uKCdzY3JvbGwnLCBmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgUkFUSU8gPSAtKDAgLSBhcHAuZG9tLiR3aW5kb3cuc2Nyb2xsVG9wKCkpIC8gKCRjYXJlZXJJbWFnZXMuaGVpZ2h0KCkgKyBjYXJlZXJJbWFnZXNPZmZzZXQudG9wIC0gaGVhZGVySGVpZ2h0KTtcclxuXHJcblx0XHRcdHZhciB0cmFuc2xhdGVWYWx1ZSA9IFJBVElPICogKGFwcC5kb20uJHdpbmRvdy53aWR0aCgpIC0gaW1hZ2VzV2lkdGggKSAvIDI7XHJcblxyXG5cdFx0XHRpZiAoUkFUSU8gPiAwKSB7XHJcblx0XHRcdFx0JGNhcmVlckltYWdlc0lubmVyLmNzcyh7XHJcblx0XHRcdFx0XHR0cmFuc2Zvcm06ICd0cmFuc2xhdGVYKCcrIHRyYW5zbGF0ZVZhbHVlICsncHgpJ1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCRjYXJlZXJJbWFnZXNJbm5lci5jc3Moe1xyXG5cdFx0XHRcdFx0dHJhbnNmb3JtOiAndHJhbnNsYXRlWCgwcHgpJ1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG5hcHAuaW1hZ2VMaWdodGJveCA9IGZ1bmN0aW9uICgpIHtcclxuXHQkKCdbZGF0YS1pbWFnZS1saWdodGJveF0nKS5tYWduaWZpY1BvcHVwKHtcclxuXHRcdHR5cGU6ICdpbWFnZScsXHJcblx0XHRtYWluQ2xhc3M6ICdnYWxsZXJ5LXBvcHVwJyxcclxuXHRcdGNsb3NlTWFya3VwOiAnPGRpdiBjbGFzcz1cIm1mcC1jbG9zZS13cmFwcGVyXCI+PGJ1dHRvbiB0aXRsZT1cIiV0aXRsZSVcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJtZnAtY2xvc2VcIj48L2J1dHRvbj48L2Rpdj4nXHJcblx0fSk7XHJcbn07XHJcblxyXG5hcHAuc3dpcGVyQWJvdXQgPSBmdW5jdGlvbiAoKSB7XHJcblx0dmFyIHN3aXBlckFib3V0ID0gbmV3IFN3aXBlciAoJ1tkYXRhLWFib3V0LXNsaWRlcl0nLCB7XHJcblx0XHRzcGVlZDogMTAwMCxcclxuXHRcdG5hdmlnYXRpb246IHtcclxuXHRcdFx0bmV4dEVsOiAnW2RhdGEtYWJvdXQtbmV4dF0nLFxyXG5cdFx0XHRwcmV2RWw6ICdbZGF0YS1hYm91dC1wcmV2XSdcclxuXHRcdH0sXHJcblx0XHRvbjoge1xyXG5cdFx0XHRpbml0OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0dmFyIGZpcnN0U2xpZGVDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtYWJvdXQtc2xpZGVyLWNvbnRlbnRdJyk7XHJcblx0XHRcdFx0Zmlyc3RTbGlkZUNvbnRlbnQuY2xhc3NMaXN0LmFkZCgnYWJvdXRfX3NsaWRlci1jb250ZW50LS1hY3RpdmUnKTtcclxuXHRcdFx0fSxcclxuXHRcdFx0c2xpZGVDaGFuZ2VUcmFuc2l0aW9uU3RhcnQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHR2YXIgc2xpZGVzID0gc3dpcGVyQWJvdXQuc2xpZGVzO1xyXG5cdFx0XHRcdHZhciBwcmV2SXRlbSA9IHNsaWRlc1tzd2lwZXJBYm91dC5wcmV2aW91c0luZGV4XS5xdWVyeVNlbGVjdG9yKCdbZGF0YS1hYm91dC1zbGlkZXItY29udGVudF0nKTtcclxuXHRcdFx0XHR2YXIgbmV4dEl0ZW0gPSBzbGlkZXNbc3dpcGVyQWJvdXQuYWN0aXZlSW5kZXhdLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWFib3V0LXNsaWRlci1jb250ZW50XScpO1xyXG5cdFx0XHRcdHByZXZJdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2Fib3V0X19zbGlkZXItY29udGVudC0tYWN0aXZlJyk7XHJcblx0XHRcdFx0cHJldkl0ZW0uY2xhc3NMaXN0LmFkZCgnYWJvdXRfX3NsaWRlci1jb250ZW50LS1jbG9zaW5nJyk7XHJcblx0XHRcdFx0bmV4dEl0ZW0uY2xhc3NMaXN0LmFkZCgnYWJvdXRfX3NsaWRlci1jb250ZW50LS1hY3RpdmUnKTtcclxuXHRcdFx0fSxcclxuXHRcdFx0c2xpZGVDaGFuZ2VUcmFuc2l0aW9uRW5kOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0dmFyIHNsaWRlcyA9IHN3aXBlckFib3V0LnNsaWRlcztcclxuXHRcdFx0XHR2YXIgcHJldkl0ZW0gPSBzbGlkZXNbc3dpcGVyQWJvdXQucHJldmlvdXNJbmRleF0ucXVlcnlTZWxlY3RvcignW2RhdGEtYWJvdXQtc2xpZGVyLWNvbnRlbnRdJyk7XHJcblx0XHRcdFx0cHJldkl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnYWJvdXRfX3NsaWRlci1jb250ZW50LS1jbG9zaW5nJyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbmFwcC5kcm9wem9uZSA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgJGRyb3B6b25lID0gJCgnW2RhdGEtZHJvcHpvbmVdJyk7XHJcblxyXG5cdCRkcm9wem9uZS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyICR0aGlzID0gJCh0aGlzKTtcclxuXHRcdHZhciAkY29udGVudCA9ICR0aGlzLmZpbmQoJ1tkYXRhLWRyb3B6b25lLWNvbnRlbnRdJyk7XHJcblx0XHR2YXIgJGlucHV0ID0gJHRoaXMuZmluZCgnW2RhdGEtZHJvcHpvbmUtaW5wdXRdJyk7XHJcblx0XHR2YXIgJGZpbGVzID0gJHRoaXMuZmluZCgnW2RhdGEtZHJvcHpvbmUtZmlsZXNdJyk7XHJcblxyXG5cdFx0dmFyIGRyb3B6b25lU2V0dGluZ3MgPSB7XHJcblx0XHRcdHBhcmFtTmFtZTogJ2ZpbGUnLFxyXG5cdFx0XHR1cGxvYWRNdWx0aXBsZTogdHJ1ZVxyXG5cdFx0fTtcclxuXHJcblx0XHQkY29udGVudC5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0JGlucHV0LnRyaWdnZXIoJ2NsaWNrJyk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQkY29udGVudC5maW5kKCdhJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdCR0aGlzLmRyb3B6b25lKGRyb3B6b25lU2V0dGluZ3MpLm9uKCdkcm9wIGFkZGVkZmlsZScsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuXHRcdFx0dmFyIGZpbGVzID0gZS5vcmlnaW5hbEV2ZW50LmRhdGFUcmFuc2Zlci5maWxlcztcclxuXHRcdFx0aWYgKGZpbGVzLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRyZW5kZXJGaWxlcyhmaWxlcywgJGZpbGVzKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0JGlucHV0Lm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihlKSB7XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcblx0XHRcdHZhciBmaWxlcyA9IGUudGFyZ2V0LmZpbGVzO1xyXG5cdFx0XHRpZiAoZmlsZXMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdHJlbmRlckZpbGVzKGZpbGVzLCAkZmlsZXMpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHRmdW5jdGlvbiByZW5kZXJGaWxlcyAoZmlsZXNBcnJheSwgJGZpbGVzV3JhcHBlclNlbGVjdG9yKSB7XHJcblx0XHRcdHZhciByZXN1bHQgPSAnJztcclxuXHJcblx0XHRcdCQoZmlsZXNBcnJheSkuZWFjaChmdW5jdGlvbihpKSB7XHJcblx0XHRcdFx0dmFyIG5hbWUgPSB0aGlzLm5hbWU7XHJcblxyXG5cdFx0XHRcdHJlc3VsdCArPSAnPGRpdiBjbGFzcz1cImRyb3B6b25lX19maWxlXCIgZGF0YS1kcm9wem9uZS1maWxlIGRhdGEtZHJvcHpvbmUtZmlsZS1pbmRleD1cIicraSsnXCI+JyArXHJcblx0XHRcdFx0XHQnPGRpdiBjbGFzcz1cImRyb3B6b25lX19maWxlLW5hbWVcIj4nICtcclxuXHRcdFx0XHRcdFx0JzxzcGFuPicrbmFtZSsnPC9zcGFuPicgK1xyXG5cdFx0XHRcdFx0JzwvZGl2PicgK1xyXG5cdFx0XHRcdFx0JzxkaXYgY2xhc3M9XCJkcm9wem9uZV9fZmlsZS1jbG9zZVwiIGRhdGEtZHJvcHpvbmUtZmlsZS1jbG9zZT48L2Rpdj4nICtcclxuXHRcdFx0XHQnPC9kaXY+JztcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQkZmlsZXNXcmFwcGVyU2VsZWN0b3IuaHRtbChyZXN1bHQpO1xyXG5cclxuXHRcdFx0JCgnW2RhdGEtZHJvcHpvbmUtZmlsZS1jbG9zZV0nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR2YXIgJHRoaXMgPSAkKHRoaXMpO1xyXG5cclxuXHRcdFx0XHQkdGhpcy5jbG9zZXN0KCdbZGF0YS1kcm9wem9uZS1maWxlXScpLnJlbW92ZSgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbmFwcC5jb250YWN0c01hcCA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgY29udGFjdHNNYXBTZWxlY3RvciA9ICQoJ1tkYXRhLWNvbnRhY3RzLW1hcF0nKVswXTtcclxuXHJcblx0aWYgKGNvbnRhY3RzTWFwU2VsZWN0b3IpIHtcclxuXHRcdHZhciBwb3NpdGlvbiA9IHtsYXQ6IDU1LjczNzI5Nzk2MDY4OTMwNCwgbG5nOiAzNy41MDUyNDU5MjA2MDYwMTV9O1xyXG5cdFx0dmFyIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoY29udGFjdHNNYXBTZWxlY3Rvciwge1xyXG5cdFx0XHRjZW50ZXI6IHBvc2l0aW9uLFxyXG5cdFx0XHR6b29tOiAxNyxcclxuXHRcdFx0Zm9ybWF0OiAncG5nJyxcclxuXHRcdFx0bWFwdHlwZTogJ3JvYWRtYXAnLFxyXG5cdFx0XHRzdHlsZXM6IFtcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHQnZmVhdHVyZVR5cGUnOiAnYWRtaW5pc3RyYXRpdmUnLFxyXG5cdFx0XHRcdFx0J2VsZW1lbnRUeXBlJzogJ2dlb21ldHJ5JyxcclxuXHRcdFx0XHRcdCdzdHlsZXJzJzogW1xyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0J3Zpc2liaWxpdHknOiAnb2ZmJ1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRdXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHQnZmVhdHVyZVR5cGUnOiAnYWRtaW5pc3RyYXRpdmUnLFxyXG5cdFx0XHRcdFx0J2VsZW1lbnRUeXBlJzogJ2dlb21ldHJ5LmZpbGwnLFxyXG5cdFx0XHRcdFx0J3N0eWxlcnMnOiBbXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHQnY29sb3InOiAnI2ZmZmZmZidcclxuXHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdCd3ZWlnaHQnOiAyXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdF1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdCdmZWF0dXJlVHlwZSc6ICdwb2knLFxyXG5cdFx0XHRcdFx0J3N0eWxlcnMnOiBbXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHQndmlzaWJpbGl0eSc6ICdvZmYnXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdF1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdCdmZWF0dXJlVHlwZSc6ICdyb2FkJyxcclxuXHRcdFx0XHRcdCdlbGVtZW50VHlwZSc6ICdsYWJlbHMuaWNvbicsXHJcblx0XHRcdFx0XHQnc3R5bGVycyc6IFtcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdCd2aXNpYmlsaXR5JzogJ29mZidcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XVxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0J2ZlYXR1cmVUeXBlJzogJ3JvYWQuYXJ0ZXJpYWwnLFxyXG5cdFx0XHRcdFx0J2VsZW1lbnRUeXBlJzogJ2dlb21ldHJ5LmZpbGwnLFxyXG5cdFx0XHRcdFx0J3N0eWxlcnMnOiBbXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHQnY29sb3InOiAnI2ZmZmZmZidcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XVxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0J2ZlYXR1cmVUeXBlJzogJ3JvYWQuYXJ0ZXJpYWwnLFxyXG5cdFx0XHRcdFx0J2VsZW1lbnRUeXBlJzogJ2dlb21ldHJ5LnN0cm9rZScsXHJcblx0XHRcdFx0XHQnc3R5bGVycyc6IFtcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdCdjb2xvcic6ICcjZmZmZmZmJ1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRdXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHQnZmVhdHVyZVR5cGUnOiAncm9hZC5oaWdod2F5JyxcclxuXHRcdFx0XHRcdCdlbGVtZW50VHlwZSc6ICdnZW9tZXRyeS5maWxsJyxcclxuXHRcdFx0XHRcdCdzdHlsZXJzJzogW1xyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0J2NvbG9yJzogJyNmZmZmZmYnXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdF1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdCdmZWF0dXJlVHlwZSc6ICdyb2FkLmhpZ2h3YXkuY29udHJvbGxlZF9hY2Nlc3MnLFxyXG5cdFx0XHRcdFx0J2VsZW1lbnRUeXBlJzogJ2dlb21ldHJ5LmZpbGwnLFxyXG5cdFx0XHRcdFx0J3N0eWxlcnMnOiBbXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHQnY29sb3InOiAnI2ZmZmZmZidcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XVxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0J2ZlYXR1cmVUeXBlJzogJ3JvYWQubG9jYWwnLFxyXG5cdFx0XHRcdFx0J2VsZW1lbnRUeXBlJzogJ2dlb21ldHJ5LnN0cm9rZScsXHJcblx0XHRcdFx0XHQnc3R5bGVycyc6IFtcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdCdjb2xvcic6ICcjZmZmZmZmJ1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRdXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHQnZmVhdHVyZVR5cGUnOiAndHJhbnNpdCcsXHJcblx0XHRcdFx0XHQnc3R5bGVycyc6IFtcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdCd2aXNpYmlsaXR5JzogJ29mZidcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0bmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcblx0XHRcdHBvc2l0aW9uOiBwb3NpdGlvbixcclxuXHRcdFx0bWFwOiBtYXAsXHJcblx0XHRcdGljb246ICcvY29tbW9uL2ltYWdlcy9pLW1hcC1tYXJrZXIuc3ZnJ1xyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxuYXBwLnZhbGlkYXRlRm9ybSA9IGZ1bmN0aW9uKCkge1xyXG5cdHZhciAkaW5wdXQgPSAkKCdbZGF0YS1pbnB1dF0sIFtkYXRhLXRleHRhcmVhXScpO1xyXG5cclxuXHR2YXIgbm90RW1wdHlDbGFzcyA9ICdfbm90LWVtcHR5JyxcclxuXHRcdHZhbGlkQ2xhc3MgPSAnX3ZhbGlkJyxcclxuXHRcdGludmFsaWRDbGFzcyA9ICdfaW52YWxpZCc7XHJcblxyXG5cdCRpbnB1dC5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyICR0aGlzID0gJCh0aGlzKTtcclxuXHRcdHZhciAkZmllbGQgPSAkdGhpcy5maW5kKCdbZGF0YS1pbnB1dC1maWVsZF0nKTtcclxuXHRcdHZhciBmaWVsZFR5cGUgPSAkZmllbGQuYXR0cigndHlwZScpO1xyXG5cclxuXHRcdCRmaWVsZC5vbignY2hhbmdlIGtleXVwJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciB2YWx1ZSA9ICRmaWVsZC52YWwoKTtcclxuXHJcblx0XHRcdGlmICh2YWx1ZS5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0JGZpZWxkLmFkZENsYXNzKG5vdEVtcHR5Q2xhc3MpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGlmKGZpZWxkVHlwZSAhPT0gJ3Bob25lJyAmJiBmaWVsZFR5cGUgIT09ICd0ZWwnKSB7XHJcblx0XHRcdFx0XHQkZmllbGQucmVtb3ZlQ2xhc3Mobm90RW1wdHlDbGFzcyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZihmaWVsZFR5cGUgPT09ICdlbWFpbCcpIHtcclxuXHRcdFx0XHRpZiAoaXNFbWFpbCgkZmllbGQudmFsKCkpKSB7XHJcblx0XHRcdFx0XHQkZmllbGQuYWRkQ2xhc3ModmFsaWRDbGFzcykucmVtb3ZlQ2xhc3MoaW52YWxpZENsYXNzKTtcclxuXHJcblx0XHRcdFx0XHRyZW1vdmVJbnB1dEVycm9yKCR0aGlzKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JGZpZWxkLnJlbW92ZUNsYXNzKHZhbGlkQ2xhc3MpLmFkZENsYXNzKGludmFsaWRDbGFzcyk7XHJcblxyXG5cdFx0XHRcdFx0cmVuZGVySW5wdXRFcnJvcigkdGhpcywgJ9Cd0LXQutC+0YDRgNC10LrRgtC90L4g0LLQstC10LTQtdC90LAg0L/QvtGH0YLQsCcpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0aWYgKGZpZWxkVHlwZSA9PT0gJ3Bob25lJyB8fCBmaWVsZFR5cGUgPT09ICd0ZWwnKSB7XHJcblx0XHRcdCRmaWVsZC5hZGRDbGFzcyhub3RFbXB0eUNsYXNzKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0ZnVuY3Rpb24gaXNFbWFpbChlbWFpbCkge1xyXG5cdFx0dmFyIHJlZ2V4ID0gL14oW2EtekEtWjAtOV8uKy1dKStcXEAoKFthLXpBLVowLTktXSkrXFwuKSsoW2EtekEtWjAtOV17Miw0fSkrJC87XHJcblx0XHRyZXR1cm4gcmVnZXgudGVzdChlbWFpbCk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJJbnB1dEVycm9yICgkY29udGFpbmVyU2VsZWN0b3IsIGVycm9yTWVzc2FnZSkge1xyXG5cdFx0dmFyIGdldEVycm9yTWVzc2FnZUNvbnRhaW5lciA9ICRjb250YWluZXJTZWxlY3Rvci5maW5kKCdbZGF0YS1pbnB1dC1lcnJvcl0nKTtcclxuXHJcblx0XHRpZiAoZ2V0RXJyb3JNZXNzYWdlQ29udGFpbmVyLmxlbmd0aCA9PT0gMCkge1xyXG5cdFx0XHR2YXIgdGVtcGxhdGUgPSAnPGRpdiBjbGFzcz1cImlucHV0X19lcnJvclwiIGRhdGEtaW5wdXQtZXJyb3I+JyArXHJcblx0XHRcdFx0JzxzcGFuPicrZXJyb3JNZXNzYWdlKyc8L3NwYW4+JyArXHJcblx0XHRcdFx0JzwvZGl2Pic7XHJcblx0XHRcdCRjb250YWluZXJTZWxlY3Rvci5hcHBlbmQodGVtcGxhdGUpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcmVtb3ZlSW5wdXRFcnJvciAoJGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcblx0XHQkY29udGFpbmVyU2VsZWN0b3IuZmluZCgnW2RhdGEtaW5wdXQtZXJyb3JdJykucmVtb3ZlKCk7XHJcblx0fVxyXG59O1xyXG5cclxuYXBwLm1hc2tlZElucHV0ID0gZnVuY3Rpb24oKSB7XHJcblx0JCgnaW5wdXRbdHlwZT1cInBob25lXCJdLCBpbnB1dFt0eXBlPVwidGVsXCJdJykubWFzaygnKzcgKDk5OSkgOTk5LTk5LTk5Jywge1xyXG5cdFx0YXV0b2NsZWFyOiBmYWxzZVxyXG5cdH0pLmFkZENsYXNzKCdfbWFza2VkJyk7XHJcbn07XHJcblxyXG5hcHAuY291bnRlciA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgJGNvdW50ZXJzID0gJCgnW2RhdGEtY291bnRlcj1cImNvbW1vblwiXScpO1xyXG5cclxuXHQkY291bnRlcnMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdHZhciAkdGhpcyA9ICQodGhpcyk7XHJcblx0XHR2YXIgJHByZXYgPSAkdGhpcy5maW5kKCdbZGF0YS1jb3VudGVyLXByZXZdJyk7XHJcblx0XHR2YXIgJG5leHQgPSAkdGhpcy5maW5kKCdbZGF0YS1jb3VudGVyLW5leHRdJyk7XHJcblx0XHR2YXIgJGNvdW50ZXJTd2lwZXIgPSAkdGhpcy5maW5kKCdbZGF0YS1jb3VudGVyLXN3aXBlcl0nKTtcclxuXHRcdHZhciAkc3dpcGVyID0gJCh0aGlzKS5jbG9zZXN0KCcuc3dpcGVyLWNvbnRhaW5lcicpO1xyXG5cclxuXHRcdGlmICgkc3dpcGVyLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0dmFyIHN3aXBlciA9ICRzd2lwZXJbMF0uc3dpcGVyO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRpZiAoJGNvdW50ZXJTd2lwZXIubGVuZ3RoID4gMCkge1xyXG5cdFx0XHR2YXIgY291bnRlclN3aXBlciA9IG5ldyBTd2lwZXIoJGNvdW50ZXJTd2lwZXJbMF0sIHtcclxuXHRcdFx0XHRzbGlkZXNQZXJWaWV3OiAxLFxyXG5cdFx0XHRcdGluaXRpYWxTbGlkZTogMCxcclxuXHRcdFx0XHRoZWlnaHQ6IDMyLFxyXG5cdFx0XHRcdGRpcmVjdGlvbjogJ3ZlcnRpY2FsJyxcclxuXHRcdFx0XHRsb29wOiBmYWxzZSxcclxuXHRcdFx0XHRuYXZpZ2F0aW9uOiB7XHJcblx0XHRcdFx0XHRwcmV2RWw6ICRwcmV2WzBdLFxyXG5cdFx0XHRcdFx0bmV4dEVsOiAkbmV4dFswXVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblxyXG5cdFx0JHByZXYub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmIChzd2lwZXIpIHtcclxuXHRcdFx0XHRzd2lwZXIuc2xpZGVQcmV2KCk7XHJcblxyXG5cdFx0XHRcdGlmIChjb3VudGVyU3dpcGVyKSB7XHJcblx0XHRcdFx0XHRjb3VudGVyU3dpcGVyLnNsaWRlVG8oc3dpcGVyLmFjdGl2ZUluZGV4KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdCRuZXh0Lm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZiAoc3dpcGVyKSB7XHJcblx0XHRcdFx0c3dpcGVyLnNsaWRlTmV4dCgpO1xyXG5cclxuXHRcdFx0XHRpZiAoY291bnRlclN3aXBlcikge1xyXG5cdFx0XHRcdFx0Y291bnRlclN3aXBlci5zbGlkZVRvKHN3aXBlci5hY3RpdmVJbmRleCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9KTtcclxufTtcclxuXHJcbmFwcC5hYm91dCA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgJHdwQWJvdXRTdG9jayA9ICQoJ1tkYXRhLXdheXBvaW50PVwiYWJvdXQtc3RvY2tcIl0nKTtcclxuXHR2YXIgJHdwQWJvdXRTdGF0cyA9ICQoJ1tkYXRhLXdheXBvaW50PVwiYWJvdXQtc3RhdHNcIl0nKTtcclxuXHR2YXIgJHdwQWJvdXRJbmRpY2F0b3JzID0gJCgnW2RhdGEtd2F5cG9pbnQ9XCJhYm91dC1pbmRpY2F0b3JzXCJdJyk7XHJcblxyXG5cdCR3cEFib3V0SW5kaWNhdG9ycy53YXlwb2ludCh7XHJcblx0XHRvZmZzZXQ6ICQoJ1tkYXRhLWhlYWRlcl0nKS5vdXRlckhlaWdodCgpLFxyXG5cdFx0aGFuZGxlcjogZnVuY3Rpb24oZGlyKSB7XHJcblx0XHRcdHN3aXRjaCAoZGlyKSB7XHJcblx0XHRcdGNhc2UgJ2Rvd24nOlxyXG5cdFx0XHRcdCR3cEFib3V0U3RvY2suYWRkQ2xhc3MoJ19maXhlZC10b3AnKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAndXAnOlxyXG5cdFx0XHRcdCR3cEFib3V0U3RvY2sucmVtb3ZlQ2xhc3MoJ19maXhlZC10b3AnKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHQkd3BBYm91dFN0YXRzLndheXBvaW50KHtcclxuXHRcdG9mZnNldDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmNvbnRleHQuaW5uZXJIZWlnaHQoKSAtIHRoaXMuYWRhcHRlci5vdXRlckhlaWdodCgpIC0gMzI7XHJcblx0XHR9LFxyXG5cdFx0aGFuZGxlcjogZnVuY3Rpb24gKGRpcikge1xyXG5cdFx0XHRzd2l0Y2ggKGRpcil7XHJcblx0XHRcdGNhc2UgJ2Rvd24nOlxyXG5cdFx0XHRcdCR3cEFib3V0U3RvY2suYWRkQ2xhc3MoJ19maXhlZC1ib3R0b20nKS5yZW1vdmVDbGFzcygnX2ZpeGVkLXRvcCcpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlICd1cCc6XHJcblx0XHRcdFx0JHdwQWJvdXRTdG9jay5yZW1vdmVDbGFzcygnX2ZpeGVkLWJvdHRvbScpLmFkZENsYXNzKCdfZml4ZWQtdG9wJyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbmFwcC5zZWFyY2ggPSBmdW5jdGlvbigpIHtcclxuXHR2YXIgJHNlYXJjaCA9ICQoJ1tkYXRhLXNlYXJjaF0nKTtcclxuXHR2YXIgJHNlYXJjaFByZWRpY3QgPSAkc2VhcmNoLmZpbmQoJ1tkYXRhLXNlYXJjaC1wcmVkaWN0XScpO1xyXG5cdHZhciAkc2VhcmNoSW5wdXQgPSAkc2VhcmNoLmZpbmQoJ1tkYXRhLXNlYXJjaC1pbnB1dF0nKTtcclxuXHR2YXIgJHNlYXJjaENsZWFyID0gJHNlYXJjaC5maW5kKCdbZGF0YS1zZWFyY2gtY2xlYXJdJyk7XHJcblxyXG5cdCRzZWFyY2hJbnB1dC5vbigna2V5dXAga2V5ZG93bicsIGZ1bmN0aW9uKCl7XHJcblx0XHR2YXIgJHRoaXMgPSAkKHRoaXMpO1xyXG5cdFx0dmFyICR2YWwgPSAkdGhpcy52YWwoKTtcclxuXHRcdHZhciB0ZXN0UHJlZGljdCA9IHNob3dTZWFyY2hQcmVkaWN0KCR2YWwsICfQn9GA0L7QuNC30LLQvtC00YHRgtCy0L4nKTtcclxuXHJcblx0XHRpZiAoJHZhbC5sZW5ndGggPiAwKSB7XHJcblx0XHRcdCRzZWFyY2hDbGVhci5zdG9wKCkuc2hvdygpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0JHNlYXJjaENsZWFyLnN0b3AoKS5oaWRlKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCR2YWwubGVuZ3RoID4gMCAmJiB0ZXN0UHJlZGljdCkge1xyXG5cdFx0XHQkc2VhcmNoUHJlZGljdC50ZXh0KHRlc3RQcmVkaWN0KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdCRzZWFyY2hQcmVkaWN0LnRleHQoJycpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHQkc2VhcmNoQ2xlYXIub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblx0XHQkc2VhcmNoUHJlZGljdC50ZXh0KCcnKTtcclxuXHRcdCRzZWFyY2hJbnB1dC52YWwoJycpLmF0dHIoJ3ZhbHVlJywgJycpO1xyXG5cdFx0JHNlYXJjaENsZWFyLnN0b3AoKS5oaWRlKCk7XHJcblx0fSk7XHJcblxyXG5cdHZhciBzaG93U2VhcmNoUHJlZGljdCA9IGZ1bmN0aW9uIChxdWVyeSwgcHJlZGljdFN0cmluZykge1xyXG5cdFx0aWYgKHByZWRpY3RTdHJpbmcuaW5jbHVkZXMocXVlcnkpKSB7XHJcblx0XHRcdHJldHVybiBwcmVkaWN0U3RyaW5nO1xyXG5cdFx0fVxyXG5cdH07XHJcbn07XHJcblxyXG5hcHAuYWxlcnQgPSBmdW5jdGlvbiAoKSB7XHJcblx0dmFyICRhbGVydHMgPSAkKCdbZGF0YS1hbGVydF0nKTtcclxuXHQkYWxlcnRzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgJHRoaXMgPSAkKHRoaXMpO1xyXG5cdFx0dmFyICRjbG9zZSA9ICR0aGlzLmZpbmQoJ1tkYXRhLWFsZXJ0LWNsb3NlXScpO1xyXG5cclxuXHRcdCRjbG9zZS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0JHRoaXMuc3RvcCgpLmhpZGUoKTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuYXBwLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcblx0YXBwLnNtb290aFNjcm9sbCgpO1xyXG5cdGFwcC5oaWdoY2hhcnRzKCk7XHJcblx0YXBwLnNwbGl0dHkoKTtcclxuXHRhcHAub3BlblBvcHVwKCk7XHJcblx0YXBwLmZhZGUoKTtcclxuXHRhcHAubWVudSgpO1xyXG5cdGFwcC5jb2xsYXBzZSgpO1xyXG5cdGFwcC50YWJzKCk7XHJcblx0YXBwLmNvb2tpZUxheW91dCgpO1xyXG5cdGFwcC5jaG9zZW4oKTtcclxuXHRhcHAuc3RpY2t5U2Nyb2xsZXIoKTtcclxuXHRhcHAuZ2VvTWFwKCk7XHJcblx0YXBwLmhpc3RvcnkoKTtcclxuXHRhcHAuc3RpY2t5SGVhZGVyKCk7XHJcblx0YXBwLnN3aXBlclByZXNzR2FsbGVyeSgpO1xyXG5cdGFwcC5zd2lwZXJNb3JlTmV3c0dhbGxlcnkoKTtcclxuXHRhcHAuc3dpcGVyTWFpbkhlYWRlckltYWdlcygpO1xyXG5cdGFwcC5zd2lwZXJNYWluU3RvY2tzKCk7XHJcblx0YXBwLnN3aXBlck1haW5OZXdzKCk7XHJcblx0YXBwLnN3aXBlck1haW5Qcm9kdWN0cygpO1xyXG5cdGFwcC5zd2lwZXJNYWluQmFubmVyTW9iaWxlKCk7XHJcblx0YXBwLmdhbGxlcnkoKTtcclxuXHRhcHAuY2FyZWVySW1hZ2VzKCk7XHJcblx0YXBwLmltYWdlTGlnaHRib3goKTtcclxuXHRhcHAuZHJvcHpvbmUoKTtcclxuXHRhcHAuY29udGFjdHNNYXAoKTtcclxuXHRhcHAudmFsaWRhdGVGb3JtKCk7XHJcblx0YXBwLm1hc2tlZElucHV0KCk7XHJcblx0YXBwLnN3aXBlckFib3V0KCk7XHJcblx0YXBwLmNvdW50ZXIoKTtcclxuXHRhcHAuYWJvdXQoKTtcclxuXHRhcHAuc2VhcmNoKCk7XHJcblx0YXBwLmFsZXJ0KCk7XHJcblx0YXBwLmxhbmcoKTtcclxuXHRhcHAucmV2ZWFsQmxvY2tPblJlc2V0KCk7XHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuXHQkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcblx0XHRhcHAuaW5pdCgpO1xyXG5cdH0pO1xyXG59KTtcclxuIl19
